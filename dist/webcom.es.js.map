{"version":3,"file":"webcom.es.js","sources":["../src/Lang/Math.js","../src/Lang/String.js","../src/Lang/Html.js","../src/Lang/Util.js","../src/Lang/Dom.js","../src/Widget/Theme.js","../src/Widget/Toast.js","../src/Lang/File.js","../src/Lang/Event.js","../src/Lang/Net.js","../src/Lang/Array.js","../src/Lang/Form.js","../src/Auto/ACAsync.js","../src/Widget/Dialog.js","../src/Auto/ACDialog.js","../src/Auto/ACConfirm.js","../src/Widget/Tip.js","../src/Auto/ACTip.js","../src/I18N/Lang.js","../src/Widget/Copy.js","../src/Auto/ACCopy.js","../src/Auto/ACToast.js","../src/Lang/Base64.js","../src/Lang/Img.js","../src/Widget/LocalStorageSetting.js","../src/Widget/ImgPreview.js","../src/Auto/ACPreview.js","../src/Widget/Select.js","../src/Auto/ACSelect.js","../src/Auto/ACHighlight.js","../src/Auto/ACSelectAll.js","../src/Auto/ACMultiSelectRelate.js","../src/Widget/Uploader.js","../src/Auto/ACUploader.js","../src/Auto/ACTextCounter.js","../src/Auto/ACBatchFiller.js","../src/Auto/ACComponent.js","../src/Lang/MD5.js","../src/Lang/ReportApi.js","../src/Lang/Route.js","../src/Lang/Time.js","../src/Widget/Autofill.js","../src/Widget/Masker.js","../src/Widget/Menu.js","../src/Widget/NoviceGuide.js","../src/Widget/Sortable.js","../src/Widget/Toc.js"],"sourcesContent":["/** 黄金分割比 0.618 **/\nexport const GOLDEN_RATIO = (1 + Math.sqrt(5)) / 2 - 1;\n\n/**\n * 检测指定值是否在指定区间内\n * @param {Number} val\n * @param {Number} min\n * @param {Number} max\n * @param {Boolean} includeEqual 是否包含等于判断\n * @returns {boolean}\n */\nexport const between = (val, min, max, includeEqual = true) => {\n\treturn includeEqual ? (val >= min && val <= max) : (val > min && val < max);\n};\n\n/**\n * 随机整数\n * @param {Number} min\n * @param {Number} max\n * @return {Number}\n */\nexport const randomInt = (min, max) => {\n\treturn Math.floor(Math.random() * (max + 1 - min)) + min;\n};\n\n/**\n * 取整\n * @param {Number} num\n * @param {Number} precision 精度，默认为两位小数\n * @returns {number}\n */\nexport const round = (num, precision = 2) => {\n\tlet multiple = Math.pow(10, precision);\n\treturn Math.round(num * multiple) / multiple;\n}","import {randomInt, round} from \"./Math.js\";\n\n/**\n * 混合ES6模板字符串\n * @example extract(\"hello ${user_name}\", {user_name:\"Jack\"});\n * @param {String} es_template 模板\n * @param {Object} params 数据对象\n * @return {String}\n */\nexport const extract = (es_template, params) => {\n\tconst names = Object.keys(params);\n\tconst values = Object.values(params);\n\treturn new Function(...names, `return \\`${es_template}\\`;`)(...values);\n}\n\n/**\n * 转换字符串到HTML实体编码\n * @param {String} str\n * @return {String}\n */\nexport const toHtmlEntities = (str)=>{\n\treturn str.replace(/./gm, function(s) {\n\t\treturn (s.match(/[a-z0-9\\s]+/i)) ? s : '&#' + s.charCodeAt(0) + ';';\n\t});\n}\n\n/**\n * 字符切割，同时去除空白符号、换行符等\n * @param {String} separator\n * @param {String} str\n * @return {String[]}\n */\nexport const explodeBy = (separator, str) => {\n\tlet items = str.replace(/\\r|\\n/mg, '').split(separator);\n\titems = items.map(item => {\n\t\treturn item.trim();\n\t});\n\titems = items.filter(item => {\n\t\treturn item.length;\n\t})\n\treturn items;\n}\n\n/**\n * HTML实体转换为字符串\n * @param {String} str\n * @return {string}\n */\nexport const fromHtmlEntities = (str)=>{\n\treturn (str + '').replace(/&#\\d+;/gm, function(s) {\n\t\treturn String.fromCharCode(s.match(/\\d+/gm)[0]);\n\t})\n}\n\n/**\n * 反转义字符串\n * @param str\n * @returns {string}\n * @description:\n *       discuss at: https://locutus.io/php/stripslashes/\n *      original by: Kevin van Zonneveld (https://kvz.io)\n *      improved by: Ates Goral (https://magnetiq.com)\n *      improved by: marrtins\n *      improved by: rezna\n *         fixed by: Mick@el\n *      bugfixed by: Onno Marsman (https://twitter.com/onnomarsman)\n *      bugfixed by: Brett Zamir (https://brett-zamir.me)\n *         input by: Rick Waldron\n *         input by: Brant Messenger (https://www.brantmessenger.com/)\n * reimplemented by: Brett Zamir (https://brett-zamir.me)\n *        example 1: stripslashes('Kevin\\'s code')\n *        returns 1: \"Kevin's code\"\n *        example 2: stripslashes('Kevin\\\\\\'s code')\n *        returns 2: \"Kevin\\'s code\"\n */\nexport const stripSlashes = (str) => {\n\treturn (str + '')\n\t\t.replace(/\\\\(.?)/g, function(s, n1){\n\t\t\tswitch(n1){\n\t\t\t\tcase '\\\\':\n\t\t\t\t\treturn '\\\\'\n\t\t\t\tcase '0':\n\t\t\t\t\treturn '\\u0000'\n\t\t\t\tcase '':\n\t\t\t\t\treturn ''\n\t\t\t\tdefault:\n\t\t\t\t\treturn n1\n\t\t\t}\n\t\t})\n}\n\n/**\n * 格式化数字\n * @param {Number} num\n * @param {Number} precision\n * @return {string|Number}\n */\nexport const formatSize = (num, precision = 2) => {\n\tif(isNaN(num)){\n\t\treturn num;\n\t}\n\tlet str = '', i, mod = 1024;\n\tif(num < 0){\n\t\tstr = '-';\n\t\tnum = Math.abs(num);\n\t}\n\tlet units = 'B KB MB GB TB PB'.split(' ');\n\tfor(i = 0; num > mod; i++){\n\t\tnum /= mod;\n\t}\n\treturn str + round(num, precision) + units[i];\n}\n\n/**\n * 中英文字符串截取（中文按照2个字符长度计算）\n * @param str\n * @param len\n * @param eclipse_text\n * @returns {*}\n */\nexport const cutString = (str, len, eclipse_text) => {\n\tif(eclipse_text === undefined){\n\t\teclipse_text = '...';\n\t}\n\tlet r = /[^\\x00-\\xff]/g;\n\tif(str.replace(r, \"mm\").length <= len){\n\t\treturn str;\n\t}\n\tlet m = Math.floor(len / 2);\n\tfor(let i = m; i < str.length; i++){\n\t\tif(str.substr(0, i).replace(r, \"mm\").length >= len){\n\t\t\treturn str.substr(0, i) + eclipse_text;\n\t\t}\n\t}\n\treturn str;\n};\n\n/**\n * 正则表达式转义\n * @param str\n * @returns {string}\n */\nexport const regQuote = (str) => {\n\treturn (str + '').replace(/([\\\\\\.\\+\\*\\?\\[\\^\\]\\$\\(\\)\\{\\}\\=\\!\\<\\>\\|\\:])/g, \"\\\\$1\");\n};\n\n/**\n * @param {String} srcStr\n * @return {string}\n */\nexport const utf8Decode = (srcStr) => {\n\tlet t = \"\";\n\tlet n = 0;\n\tlet r = 0,\n\t\tc1 = 0,\n\t\tc2 = 0,\n\t\tc3 = 0;\n\twhile(n < srcStr.length){\n\t\tr = srcStr.charCodeAt(n);\n\t\tif(r < 128){\n\t\t\tt += String.fromCharCode(r);\n\t\t\tn++\n\t\t}else if(r > 191 && r < 224){\n\t\t\tc2 = srcStr.charCodeAt(n + 1);\n\t\t\tt += String.fromCharCode((r & 31) << 6 | c2 & 63);\n\t\t\tn += 2\n\t\t}else{\n\t\t\tc2 = srcStr.charCodeAt(n + 1);\n\t\t\tc3 = srcStr.charCodeAt(n + 2);\n\t\t\tt += String.fromCharCode((r & 15) << 12 | (c2 & 63) << 6 | c3 & 63);\n\t\t\tn += 3\n\t\t}\n\t}\n\treturn t\n};\n\n/**\n * 检测字符串是否为合法URL\n * @param {String} urlString\n * @returns {boolean}\n */\nexport const isValidUrl = urlString => {\n\ttry{\n\t\treturn Boolean(new URL(urlString));\n\t}catch(e){\n\t\treturn false;\n\t}\n}\n\n/**\n * 判断字符串是否符合 JSON 标准\n * @param {String} json\n * @returns {boolean}\n */\nexport const isJSON = (json) => {\n\tlet is_json = false;\n\ttry{\n\t\tJSON.parse(json);\n\t\tis_json = true;\n\t}catch(error){\n\t}\n\treturn is_json;\n}\n\n/**\n * @param {String} srcStr\n * @returns {string}\n */\nexport const utf8Encode = (srcStr) => {\n\tsrcStr = srcStr.replace(/\\r\\n/g, \"n\");\n\tlet t = \"\";\n\tfor(let n = 0; n < srcStr.length; n++){\n\t\tlet r = srcStr.charCodeAt(n);\n\t\tif(r < 128){\n\t\t\tt += String.fromCharCode(r)\n\t\t}else if(r > 127 && r < 2048){\n\t\t\tt += String.fromCharCode(r >> 6 | 192);\n\t\t\tt += String.fromCharCode(r & 63 | 128)\n\t\t}else{\n\t\t\tt += String.fromCharCode(r >> 12 | 224);\n\t\t\tt += String.fromCharCode(r >> 6 & 63 | 128);\n\t\t\tt += String.fromCharCode(r & 63 | 128)\n\t\t}\n\t}\n\treturn t;\n};\n\n/**\n * 获取u8字符串长度(一个中文字按照3个字数计算)\n * @param str\n * @returns {number}\n */\nexport const getUTF8StrLen = (str) => {\n\tlet realLength = 0;\n\tlet len = str.length;\n\tlet charCode = -1;\n\tfor(let i = 0; i < len; i++){\n\t\tcharCode = str.charCodeAt(i);\n\t\tif(charCode >= 0 && charCode <= 128){\n\t\t\trealLength += 1;\n\t\t}else{\n\t\t\trealLength += 3;\n\t\t}\n\t}\n\treturn realLength;\n};\n\nconst DEFAULT_RANDOM_STRING = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890';\n\n/**\n * 产生随机字符串\n * @param {Number} length\n * @param {String} sourceStr\n * @returns {String}\n */\nexport const randomString = (length = 6, sourceStr = DEFAULT_RANDOM_STRING) => {\n\tlet codes = '';\n\tfor(let i = 0; i < length; i++){\n\t\tlet rnd = Math.round(Math.random() * (sourceStr.length - 1));\n\t\tcodes += sourceStr.substring(rnd, rnd + 1);\n\t}\n\treturn codes;\n}\n\n/**\n * 产生随机单词\n * @param {Number} count 单词数量\n * @param {Number} letterMax 每个单词最大字符数量\n * @return {String[]} 单词列表\n */\nexport const randomWords = (count = 1, letterMax = 8) => {\n\tlet words = [];\n\tconst possible = 'bcdfghjklmnpqrstvwxyz';\n\tconst possibleVowels = 'aeiou';\n\n\twhile(count-- > 0){\n\t\tlet word = '';\n\t\tfor(let i = 0; i < letterMax; i = i + 3){\n\t\t\tword += possible[Math.floor(Math.random() * possible.length)]\n\t\t\tword += possibleVowels[Math.floor(Math.random() * possibleVowels.length)]\n\t\t\tword += possible[Math.floor(Math.random() * possible.length)]\n\t\t}\n\t\twords.push(word);\n\t}\n\treturn words;\n}\n\n/**\n * 随机文本\n * @param {Number} maxLength 最大字符数量\n * @param {Boolean} multipleLine 是否多行文本（包含换行符）\n * @return {string}\n */\nexport const randomSentence = (maxLength = 0, multipleLine = false) => {\n\tlet wordCount = Math.ceil(maxLength / 4);\n\tlet words = randomWords(wordCount);\n\tif(multipleLine){\n\t\tlet sep = '';\n\t\tlet text = '';\n\t\twords.forEach(word => {\n\t\t\ttext = text + sep + word;\n\t\t\tsep = randomInt(0, 1) > 0 ? ' ' : \"\\n\";\n\t\t});\n\t\treturn text.trim();\n\t}else{\n\t\treturn words.join(' ').substring(0, maxLength).trim();\n\t}\n}\n\n/**\n * 字符串转成首字母大写\n * @param {String} str\n * @param {Boolean} capitalize_first 是否将第一个单词首字母大写\n * @return {string}\n */\nexport const strToPascalCase = (str, capitalize_first = false) => {\n\tlet words = [];\n\tstr.replace(/[-_\\s+]/g, ' ').split(' ').forEach((word, idx) => {\n\t\twords.push((idx === 0 && !capitalize_first) ? word : capitalize(word));\n\t});\n\treturn words.join('');\n}\n\n/**\n * 字符串转换层大写\n * @param {String} str\n * @return {string}\n */\nexport const capitalize = (str) => {\n\tif(typeof str !== 'string'){\n\t\treturn ''\n\t}\n\treturn str.charAt(0).toUpperCase() + str.slice(1);\n}\n\n/**\n * 检测是否为数值\n * @param val\n * @return {boolean}\n */\nexport const isNum = (val) => {\n\treturn !isNaN(val);\n}\n\nexport const TRIM_BOTH = 0;\nexport const TRIM_LEFT = 1;\nexport const TRIM_RIGHT = 2;\n\n/**\n * 去除字符串首尾指定字符或空白\n * @param {String} str 源字符串\n * @param {String} chars 指定字符，默认为空白\n * @param {Number} dir 方向\n * @returns {*|boolean}\n */\nexport const trim = (str, chars = '', dir = TRIM_BOTH) => {\n\tif(chars.length){\n\t\tlet regLeft = new RegExp('^[' + regQuote(chars) + ']+'),\n\t\t\tregRight = new RegExp('[' + regQuote(chars) + ']+$');\n\t\treturn dir === TRIM_LEFT ? str.replace(regLeft, '') : (dir === TRIM_RIGHT ? str.replace(regRight, '') : str.replace(regLeft, '').replace(regRight, ''));\n\t}else{\n\t\treturn dir === TRIM_BOTH ? str.trim() : (dir === TRIM_LEFT ? str.trimStart() : dir === str.trimEnd());\n\t}\n}\n","import {isNum, regQuote} from \"./String.js\";\n\n/**\n * 块元素\n * @type {string[]}\n */\nexport const BLOCK_TAGS = [\n\t'body', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'hr', 'p', 'div', 'address', 'pre', 'form',\n\t'table', 'li', 'ol', 'ul', 'tr', 'td', 'caption', 'blockquote', 'center','legend',\n\t'dl', 'dt', 'dd', 'dir', 'fieldset', 'noscript', 'noframes', 'menu', 'isindex', 'samp',\n\t'nav','header', 'aside', 'dialog','section', 'footer','article'\n];\n\nexport const REMOVABLE_TAGS = [\n\t'style', 'comment', 'select', 'option', 'script', 'title', 'head', 'button',\n];\n\n/**\n * Convert html to plain text\n * @param {String} html\n * @returns {string}\n */\nexport const html2Text = (html)=>{\n\t//remove removable tags\n\tREMOVABLE_TAGS.forEach(tag=>{\n\t\thtml = html.replace(new RegExp(tag, 'ig'), '');\n\t})\n\n\t//remove text line break\n\thtml = html.replace(/[\\r|\\n]/g, '');\n\n\t//convert block tags to line break\n\thtml = html.replace(/<(\\w+)([^>]*)>/g, function(ms, tag, tail){\n\t\tif(BLOCK_TAGS.includes(tag.toLowerCase())){\n\t\t\treturn \"\\n\";\n\t\t}\n\t\treturn \"\";\n\t});\n\n\t//remove tag's postfix\n\thtml = html.replace(/<\\/(\\w+)([^>]*)>/g, function(ms, tag, tail){\n\t\treturn \"\";\n\t});\n\n\t//remove other tags, likes <img>, input, etc...\n\thtml = html.replace(/<[^>]+>/g, '');\n\n\t//convert entity by names\n\tlet entityNamesMap = [\n\t\t[/&nbsp;/ig, ' '],\n\t\t[/&lt;/ig, '<'],\n\t\t[/&gt;/ig, '>'],\n\t\t[/&quot;/ig, '\"'],\n\t\t[/&apos;/ig, '\\''],\n\t];\n\tentityNamesMap.forEach(([matchReg, replacement])=>{\n\t\thtml = html.replace(matchReg, replacement);\n\t});\n\n\t//convert entity dec code\n\thtml = html.replace(/&#(\\d+);/, function(ms, dec){\n\t\treturn String.fromCharCode(dec);\n\t});\n\n\t//replace last &amp;\n\thtml = html.replace(/&amp;/ig, '&');\n\n\t//trim head & tail space\n\thtml = html.trim();\n\n\treturn html;\n}\n\n/**\n * 数值转为CSS可用样式\n * @param {Number|String} h\n * @returns {string}\n */\nexport const dimension2Style = h => {\n\tif(isNum(h)){\n\t\treturn h + 'px';\n\t}\n\treturn h+'';\n};\n\n/**\n * CSS 选择器转义\n * @param {String} str\n * @returns {String}\n */\nexport const cssSelectorEscape = (str)=>{\n\treturn (window.CSS && CSS.escape) ? CSS.escape(str) : str.replace(/[!\"#$%&'()*+,.\\/:;<=>?@[\\\\\\]^`{|}~]/g, \"\\\\$&\");\n};\n\n/**\n * HTML实例转字符串\n * @param {string} entity\n * @returns {string}\n */\nexport const entityToString = (entity) => {\n\tlet entities = entity.split(';')\n\tentities.pop()\n\treturn entities.map(item => String.fromCharCode(\n\t\titem[2] === 'x' ? parseInt(item.slice(3), 16) : parseInt(item.slice(2)))).join('')\n}\n\nlet _helper_div;\nexport const decodeHTMLEntities = (str) => {\n\tif(!_helper_div){\n\t\t_helper_div = document.createElement('div');\n\t}\n\t// strip script/html tags\n\tstr = str.replace(/<script[^>]*>([\\S\\s]*?)<\\/script>/gmi, '');\n\tstr = str.replace(/<\\/?\\w(?:[^\"'>]|\"[^\"]*\"|'[^']*')*>/gmi, '');\n\t_helper_div.innerHTML = str;\n\tstr = _helper_div.textContent;\n\t_helper_div.textContent = '';\n\treturn str;\n}\n\n/**\n * 转义HTML\n * @param {string} str\n * @returns {string}\n */\nexport const escapeHtml = str => {\n\treturn String(str)\n\t\t.replace(/&/g, \"&amp;\")\n\t\t.replace(/</g, \"&lt;\")\n\t\t.replace(/>/g, \"&gt;\")\n\t\t.replace(/\"/g, \"&quot;\")\n\t\t.replace(/'/g, \"&#039;\")\n\t\t.replace(/\\s/g, \"&nbsp;\")\n\t\t.replace(/[\\r\\n]/g, '<br/>');\n}\n\n/**\n * 反转义HTML\n * @param {String} html\n * @returns {string}\n */\nexport const unescapeHtml = (html)=>{\n\treturn String(html)\n\t\t.replace(/&quot;/g, '\"')\n\t\t.replace(/&#39;/g, \"'\")\n\t\t.replace(/&lt;/g, '<')\n\t\t.replace(/&gt;/g, '>')\n\t\t.replace(/&nbsp;/g, ' ')\n\t\t.replace(/&amp;/g, '&')\n\t\t.replace(/<br.*>/, \"\\n\");\n};\n\n/**\n * 转义HTML到属性值\n * @param {String} s\n * @param preserveCR\n * @returns {string}\n */\nexport const escapeAttr = (s, preserveCR = '') => {\n\tpreserveCR = preserveCR ? '&#13;' : '\\n';\n\treturn ('' + s) /* Forces the conversion to string. */\n\t\t.replace(/&/g, '&amp;') /* This MUST be the 1st replacement. */\n\t\t.replace(/'/g, '&apos;') /* The 4 other predefined entities, required. */\n\t\t.replace(/\"/g, '&quot;')\n\t\t.replace(/</g, '&lt;')\n\t\t.replace(/>/g, '&gt;')\n\t\t/*\n\t\tYou may add other replacements here for HTML only\n\t\t(but it's not necessary).\n\t\tOr for XML, only if the named entities are defined in its DTD.\n\t\t*/\n\t\t.replace(/\\r\\n/g, preserveCR) /* Must be before the next replacement. */\n\t\t.replace(/[\\r\\n]/g, preserveCR);\n}\n\nexport const stringToEntity = (str, radix) => {\n\tlet arr = str.split('')\n\tradix = radix || 0\n\treturn arr.map(item =>\n\t\t`&#${(radix ? 'x' + item.charCodeAt(0).toString(16) : item.charCodeAt(0))};`).join('')\n}\n\n/**\n * 高亮文本\n * @param {String} text 文本\n * @param {String} kw 关键字\n * @param {String} replaceTpl 替换模板\n * @returns {void|string|*}\n */\nexport const highlightText = (text, kw, replaceTpl = '<span class=\"matched\">%s</span>') => {\n\tif(!kw){\n\t\treturn text;\n\t}\n\treturn text.replace(new RegExp(regQuote(kw), 'ig'), match => {\n\t\treturn replaceTpl.replace('%s', match);\n\t});\n};","import {randomString} from \"./String.js\";\nimport {getCookie, setCookie} from \"./Dom.js\";\n\nlet _guid = 0;\nexport const guid = (prefix = '') => {\n\treturn 'guid_' + (prefix || randomString(6)) + (++_guid);\n};\n\n/**\n * 获取当前函数所在script路径\n * @return {string|null}\n */\nexport const getCurrentScript = function(){\n\tlet error = new Error()\n\t\t, source\n\t\t, currentStackFrameRegex = new RegExp(getCurrentScript.name + \"\\\\s*\\\\((.*):\\\\d+:\\\\d+\\\\)\")\n\t\t, lastStackFrameRegex = new RegExp(/.+\\/(.*?):\\d+(:\\d+)*$/);\n\tif((source = currentStackFrameRegex.exec(error.stack.trim()))){\n\t\treturn source[1];\n\t}else if((source = lastStackFrameRegex.exec(error.stack.trim())) && source[1] !== \"\"){\n\t\treturn source[1];\n\t}else if(error['fileName'] !== undefined){\n\t\treturn error['fileName'];\n\t}\n\treturn null;\n}\n\n/**\n * 节流\n * 规定在一个单位时间内，只能触发一次函数。如果这个函数单位时间内触发多次函数，只有一次生效。\n * @param fn\n * @param intervalMiSec\n * @return {(function(): void)|*}\n */\nexport const throttle = (fn, intervalMiSec) => {\n\tlet context, args;\n\tlet previous = 0;\n\treturn function(){\n\t\tlet now = +new Date();\n\t\tcontext = this;\n\t\targs = arguments;\n\t\tif(now - previous > intervalMiSec){\n\t\t\tfn.apply(context, args);\n\t\t\tprevious = now;\n\t\t}\n\t}\n}\n\n/**\n * 在事件被触发n秒后再执行回调，如果在这n秒内又被触发，则重新计时。\n * @param fn\n * @param intervalMiSec\n * @return {(function(): void)|*}\n */\nexport const debounce = (fn, intervalMiSec) => {\n\tlet timeout;\n\treturn function(){\n\t\tlet context = this;\n\t\tlet args = arguments;\n\t\tclearTimeout(timeout)\n\t\ttimeout = setTimeout(function(){\n\t\t\tfn.apply(context, args)\n\t\t}, intervalMiSec);\n\t}\n}\n\nconst CURRENT_FILE = '/Lang/Util.js';\nconst ENTRY_FILE = '/index.js';\n\n/**\n * 获取当前库脚本调用地址（这里默认当前库只有两种调用形式：独立模块调用以及合并模块调用）\n * @return {string}\n */\nexport const getLibEntryScript = () => {\n\tlet script = getCurrentScript();\n\tif(!script){\n\t\tthrow \"Get script failed\";\n\t}\n\tif(script.indexOf(CURRENT_FILE) >= 0){\n\t\treturn script.replace(CURRENT_FILE, ENTRY_FILE);\n\t}\n\treturn script;\n}\n\n/**\n * 加载当前库模块\n * @return {Promise<*>}\n */\nexport const getLibModule = async () => {\n\tlet script = getLibEntryScript();\n\treturn await import(script);\n}\n\n/**\n * 获取顶部窗口模块（如果没有顶部窗口，则获取当前窗口模块）\n * @type {(function(): Promise<*>)|undefined}\n */\nexport const getLibModuleTop = (() => {\n\tif(top === window){\n\t\treturn getLibModule;\n\t}\n\tif(top.WEBCOM_GET_LIB_MODULE){\n\t\treturn top.WEBCOM_GET_LIB_MODULE;\n\t}\n\tthrow \"No WebCom library script loaded detected.\";\n})();\n\n/**\n * 清理版本，去除无用字符\n * @param {String} version\n * @return {Number[]}\n */\nconst normalizeVersion = (version) => {\n\tlet trimmed = version ? version.replace(/^\\s*(\\S*(\\s+\\S+)*)\\s*$/, \"$1\") : '',\n\t\tpieces = trimmed.split('.'),\n\t\tpartsLength,\n\t\tparts = [],\n\t\tvalue,\n\t\tpiece,\n\t\tnum,\n\t\ti;\n\tfor(i = 0; i < pieces.length; i += 1){\n\t\tpiece = pieces[i].replace(/\\D/g, '');\n\t\tnum = parseInt(piece, 10);\n\t\tif(isNaN(num)){\n\t\t\tnum = 0;\n\t\t}\n\t\tparts.push(num);\n\t}\n\tpartsLength = parts.length;\n\tfor(i = partsLength - 1; i >= 0; i -= 1){\n\t\tvalue = parts[i];\n\t\tif(value === 0){\n\t\t\tparts.length -= 1;\n\t\t}else{\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn parts;\n};\n\n/**\n * 版本比较\n * @param {String} version1\n * @param {String} version2\n * @param {Number} index\n * @return {number|number}\n */\nexport const versionCompare = (version1, version2, index) => {\n\tlet stringLength = index + 1,\n\t\tv1 = normalizeVersion(version1),\n\t\tv2 = normalizeVersion(version2);\n\tif(v1.length > stringLength){\n\t\tv1.length = stringLength;\n\t}\n\tif(v2.length > stringLength){\n\t\tv2.length = stringLength;\n\t}\n\tlet size = Math.min(v1.length, v2.length), i;\n\tfor(i = 0; i < size; i += 1){\n\t\tif(v1[i] !== v2[i]){\n\t\t\treturn v1[i] < v2[i] ? -1 : 1;\n\t\t}\n\t}\n\tif(v1.length === v2.length){\n\t\treturn 0;\n\t}\n\treturn (v1.length < v2.length) ? -1 : 1;\n}\n\n/**\n * 客户端一次性动作\n * @example\n * doOnce('newbee', ()=>{\n *     return new Promise((resolve)=>{\n *          fetch('/cgi-bin/isNewBee', rsp=>{\n *              if(rsp.is_new_bee){\n *                  resolve();\n *              }\n *          });\n *     });\n * }, 'storage').then(()=>{\n *      alert('新人第一次弹出来');\n * }, ()={\n *      console.log('已经不是新人，或者已经弹过对话框了');\n * });\n * @param {String} markKey\n * @param {Function|Null} dataFetcher(): Promise 数据获取器，或者为空（表示第一次触发）\n * @param storageType\n * @returns {Promise<unknown>}\n */\nexport const doOnce = (markKey, dataFetcher = null, storageType = 'storage') => {\n\tconst MARKUP_STR_VAL = 'TRUE';\n\tlet getMarkState = (key) => {\n\t\tswitch(storageType.toLowerCase()){\n\t\t\tcase 'cookie':\n\t\t\t\treturn getCookie(key) === MARKUP_STR_VAL;\n\t\t\tcase 'storage':\n\t\t\t\treturn window.localStorage.getItem(key) === MARKUP_STR_VAL;\n\t\t\tcase 'session':\n\t\t\t\treturn window.sessionStorage.getItem(key) === MARKUP_STR_VAL;\n\t\t\tdefault:\n\t\t\t\tthrow \"no support:\" + storageType;\n\t\t}\n\t}\n\tlet markUp = (key) => {\n\t\tswitch(storageType.toLowerCase()){\n\t\t\tcase 'cookie':\n\t\t\t\treturn setCookie(key, MARKUP_STR_VAL);\n\t\t\tcase 'storage':\n\t\t\t\treturn window.localStorage.setItem(key, MARKUP_STR_VAL);\n\t\t\tcase 'session':\n\t\t\t\treturn window.sessionStorage.setItem(key, MARKUP_STR_VAL);\n\t\t\tdefault:\n\t\t\t\tthrow \"no support:\" + storageType;\n\t\t}\n\t}\n\treturn new Promise((onHit, noHit) => {\n\t\tif(!getMarkState(markKey)){\n\t\t\tif(typeof (dataFetcher) === 'function'){\n\t\t\t\tdataFetcher().then(() => {\n\t\t\t\t\tmarkUp(markKey);\n\t\t\t\t\tonHit()\n\t\t\t\t}, () => {\n\t\t\t\t\tmarkUp(markKey);\n\t\t\t\t\tnoHit();\n\t\t\t\t});\n\t\t\t}else{\n\t\t\t\tmarkUp(markKey);\n\t\t\t\tonHit();\n\t\t\t}\n\t\t}else{\n\t\t\tnoHit();\n\t\t}\n\t});\n}\n\n/**\n * 并发控制器\n * @example 使用方法：\n * let pp = new ParallelPromise(10); //设置控制器最大并发数量为10\n * let task = (param)=>{  //并发处理任务函数必须返回 promise\n *     return new Promise(resolve=>{\n *         console.log('param:', param);\n *         setTimeout(()=>{\n *             resolve(1);\n *         }, 1000);\n *     });\n * }\n * pp.addPromiseFn(task, {id:'1'}).then(rsp=>{\n *     //task resolve 回调\n * });\n * pp.addPromiseFn(task, {id:'2'}).then(rsp=>{\n *     //task resolve 回调\n * });\n */\nexport class ParallelPromise {\n\tparallel_limit = 0; //最大并发数量\n\tcurrent_running_count = 0; //当前运行中数量\n\ttask_stack = [\n\t\t//{promiseFn, args, resolve, reject}\n\t]; //剩余任务堆栈\n\n\tconstructor(parallelLimit){\n\t\tif(parallelLimit < 1){\n\t\t\tthrow \"最大并发数量必须大于0\";\n\t\t}\n\t\tthis.parallel_limit = parallelLimit;\n\t}\n\n\tloop(){\n\t\tfor(let i = 0; i < (this.parallel_limit - this.current_running_count); i++){\n\t\t\tif(!this.task_stack.length){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.current_running_count++;\n\t\t\tlet {promiseFn, args, resolve, reject} = this.task_stack.shift();\n\t\t\tpromiseFn(...args).then(resolve, reject).finally(() => {\n\t\t\t\tthis.current_running_count--;\n\t\t\t\tthis.loop();\n\t\t\t});\n\t\t}\n\t}\n\n\taddPromiseFn(promiseFn, ...args){\n\t\tconsole.log('并发任务添加：', args);\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.task_stack.push({\n\t\t\t\tpromiseFn: promiseFn,\n\t\t\t\targs: args,\n\t\t\t\tresolve,\n\t\t\t\treject\n\t\t\t});\n\t\t\tthis.loop();\n\t\t});\n\t}\n}\n\n/**\n * 检测目标是否为 Object\n * @param {*} item\n * @returns {boolean}\n */\nexport const isObject = (item) => {\n\treturn (item && typeof item === 'object' && !Array.isArray(item));\n}\n\n/**\n * 对象深度拷贝（合并）\n * @param {Object} target\n * @param {Object} sources\n * @returns {Object}\n */\nexport const mergeDeep = (target, ...sources) => {\n\tif(!sources.length) return target;\n\tconst source = sources.shift();\n\n\tif(isObject(target) && isObject(source)){\n\t\tfor(const key in source){\n\t\t\tif(isObject(source[key])){\n\t\t\t\tif(!target[key]){\n\t\t\t\t\tObject.assign(target, {[key]: {}});\n\t\t\t\t}else{\n\t\t\t\t\ttarget[key] = Object.assign({}, target[key])\n\t\t\t\t}\n\t\t\t\tmergeDeep(target[key], source[key]);\n\t\t\t}else{\n\t\t\t\tObject.assign(target, {[key]: source[key]});\n\t\t\t}\n\t\t}\n\t}\n\treturn mergeDeep(target, ...sources);\n}\n\n/**\n * 检测对象是否为Promise对象\n * @param {*} obj\n * @returns {boolean}\n */\nexport const isPromise = (obj)=>{\n\treturn obj && typeof(obj) === 'object' && obj.then && typeof(obj.then) === 'function';\n}\n\nexport const PROMISE_STATE_PENDING = 'pending';\nexport const PROMISE_STATE_FULFILLED = 'fulfilled';\nexport const PROMISE_STATE_REJECTED = 'rejected';\n\n/**\n * 获取 promise 对象状态\n * @param promise\n * @return {Promise<string>}\n */\nexport const getPromiseState = (promise)=>{\n\tconst t = {};\n\treturn Promise.race([promise, t])\n\t\t.then(v => (v === t) ? PROMISE_STATE_PENDING : PROMISE_STATE_FULFILLED)\n\t\t.catch(() => PROMISE_STATE_REJECTED);\n}\n\nwindow.WEBCOM_GET_LIB_MODULE = getLibModule;\nwindow.WEBCOM_GET_SCRIPT_ENTRY = getLibEntryScript;\n","import {between} from \"./Math.js\";\nimport {strToPascalCase} from \"./String.js\";\nimport {dimension2Style} from \"./Html.js\";\nimport {guid} from \"./Util.js\";\n\nexport const getViewWidth = () => {\n\treturn window.innerWidth;\n};\n\nexport const getViewHeight = () => {\n\treturn window.innerHeight;\n};\n\n/**\n * @param {HTMLElement} dom\n */\nexport const hide = (dom) => {\n\tdom.style.display = 'none';\n}\n\n/**\n * 删除节点\n * @param {Node} dom\n * @return {boolean}\n */\nexport const remove = (dom)=>{\n\tif(dom && dom.parentNode){\n\t\tdom.parentNode.removeChild(dom);\n\t\treturn true;\n\t}\n\treturn false;\n}\n\n/**\n * @param {HTMLElement} dom\n * @param dom\n */\nexport const show = (dom) => {\n\tdom.style.display = '';\n}\n\n/**\n * @param {Node} dom\n * @param toShow\n */\nexport const toggle = (dom, toShow) => {\n\ttoShow ? show(dom) : hide(dom);\n}\n\n/**\n * @param {String} selector\n * @param {Node} parent\n * @return {Node}\n */\nexport const findOne = (selector, parent = document) => {\n\treturn parent.querySelector(selector);\n}\n\n/**\n * 通过选择器查找子节点（强制添加 :scope来约束必须是子节点）\n * @param {String} selector\n * @param {Node} parent\n * @return {Node[]}\n */\nexport const findAll = (selector, parent = document) => {\n\tselector = selector.trim();\n\tif(selector.indexOf(':scope') !== 0){\n\t\tselector = ':scope ' + selector;\n\t}\n\treturn Array.from(parent.querySelectorAll(selector));\n}\n\n/**\n * 获取节点相对于文档顶部定位\n * @param target\n * @return {{top: number, left: number}}\n */\nexport const getDomOffset = (target) => {\n\tlet rect = target.getBoundingClientRect();\n\treturn {\n\t\twidth: rect.width,\n\t\theight: rect.height,\n\t\ttop: rect.top,\n\t\tbottom: rect.bottom,\n\t\tleft: rect.left,\n\t\tright: rect.right,\n\t\tx: rect.x,\n\t\ty: rect.y,\n\t}\n}\n\n/**\n * 主动触发事件\n * @param {HTMLElement} el\n * @param event\n */\nexport const fireEvent = (el, event) => {\n\tif(\"createEvent\" in document){\n\t\tlet evo = document.createEvent(\"HTMLEvents\");\n\t\tevo.initEvent(event, false, true);\n\t\tel.dispatchEvent(evo);\n\t}else{\n\t\tel.fireEvent(\"on\" + event);\n\t}\n}\n\n/**\n * 判断元素是否为按钮\n * @param {HTMLElement} el\n */\nexport const isButton = (el) => {\n\treturn el.tagName === 'BUTTON' ||\n\t\t(el.tagName === 'INPUT' && ['button', 'reset', 'submit'].includes(el.getAttribute('type')));\n}\n\n/**\n * 获取最近上级节点\n * @deprecated 请使用原生closest方法\n * @param {HTMLElement} dom\n * @param {String} selector 匹配上级节点选择器\n * @return {(() => (HTMLElement | null))|ParentNode|ActiveX.IXMLDOMNode|null}\n */\nexport const matchParent = (dom, selector) => {\n\treturn dom.closest(selector);\n}\n\n/**\n * 检测child节点是否在container节点列表里面\n * @param {HTMLElement|HTMLElement[]|String} contains\n * @param {HTMLElement} child\n * @param {Boolean} includeEqual 是否包括等于关系\n * @returns {boolean}\n */\nexport const domContained = (contains, child, includeEqual = false) => {\n\tif(typeof contains === 'string'){\n\t\tcontains = findAll(contains);\n\t}else if(Array.isArray(contains)){\n\t}else if(typeof contains === 'object'){\n\t\tcontains = [contains];\n\t}\n\tfor(let i = 0; i < contains.length; i++){\n\t\tif((includeEqual ? contains[i] === child : false) ||\n\t\t\tcontains[i].compareDocumentPosition(child) & 16){\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n};\n\n/**\n * 获取指定容器下可聚焦元素列表\n * @param {Node} dom\n * @return {Node[]}\n */\nexport const getFocusableElements = (dom = document)=>{\n\tlet els = findAll('button:not([disabled]), [href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex=\"-1\"]):not([disabled]), details:not([disabled]), summary:not(:disabled)', dom);\n\treturn els.filter(el=>{\n\t\treturn !isNodeHidden(el);\n\t});\n}\n\n/**\n * 检测节点是否被隐藏了（无法聚焦），可视区域外部的节点是可以聚焦的\n * @param {Node} node\n * @return {boolean}\n */\nexport const isNodeHidden = (node) => {\n\treturn node.offsetParent === null;\n}\n\n\n/**\n * 监听节点树变更\n * @param {Node} dom\n * @param {Function} callback\n * @param {Boolean} includeElementChanged 是否包含表单元素的值变更\n */\nexport const onDomTreeChange = (dom, callback, includeElementChanged = true) => {\n\tlet tm = null;\n\tconst PRO_KEY = 'ON_DOM_TREE_CHANGE_BIND_' + guid();\n\tconst payload = () => {\n\t\ttm && clearTimeout(tm);\n\t\ttm = setTimeout(callback, 0);\n\t}\n\tconst watchEls = (els) => {\n\t\tif(!els || !els.length){\n\t\t\treturn;\n\t\t}\n\t\tels.forEach(el => {\n\t\t\tel.setAttribute(PRO_KEY, '1');\n\t\t\tel.addEventListener('change', payload);\n\t\t});\n\t}\n\tlet obs = new MutationObserver(() => {\n\t\tif(includeElementChanged){\n\t\t\tlet els = dom.querySelectorAll(`input:not([${PRO_KEY}]), textarea:not([${PRO_KEY}]), select:not([${PRO_KEY}])`);\n\t\t\twatchEls(els);\n\t\t}\n\t\tpayload();\n\t});\n\tobs.observe(dom, {attributes: true, subtree: true, childList: true});\n\tincludeElementChanged && watchEls(dom.querySelectorAll('input,textarea,select'));\n}\n\n/**\n * 监听指定节点，如果匹配的选择器结果有发生变更，则通知外部\n * @example 用该函数来做状态联动，如指定容器内是否包含 checkbox，来联动按钮是否能够点击\n * domChangedWatch(ListDom, 'input:checked', exists=>button.disabled = !exists);\n * @param {Node} container 指定容器\n * @param {String} matchedSelector 匹配子节点的选择器\n * @param {Function} notification(collection) 通知函数，产生于为 []，表示是否包含选择器子节点数组\n * @param {Boolean} executionFirst 是否在一开始先执行一次通知函数\n */\nexport const domChangedWatch = (container, matchedSelector, notification, executionFirst = true) => {\n\tonDomTreeChange(container, () => {\n\t\tnotification(findAll(matchedSelector, container));\n\t});\n\tif(executionFirst){\n\t\tnotification(findAll(matchedSelector, container));\n\t}\n}\n\n/**\n * 获取中间对齐布局\n * @param width\n * @param height\n * @param {Object} containerDimension\n * @param {Number} containerDimension.left\n * @param {Number} containerDimension.top\n * @param {Number} containerDimension.width\n * @param {Number} containerDimension.height\n * @return {Array} dimension [dimension.left, dimension.top]\n */\nexport const keepRectCenter = (width, height, containerDimension = {\n\tleft: 0,\n\ttop: 0,\n\twidth: window.innerWidth,\n\theight: window.innerHeight\n}) => {\n\treturn [\n\t\tMath.max((containerDimension.width - width) / 2 + containerDimension.left, 0),\n\t\tMath.max((containerDimension.height - height) / 2 + containerDimension.top, 0)\n\t];\n}\n\n/**\n * @param target\n * @param container\n */\nexport const keepDomInContainer = (target, container = document.body) => {\n\tkeepRectInContainer({\n\t\tleft: target.left,\n\t\ttop: target.top,\n\t\twidth: target.clientWidth,\n\t\theight: target.clientHeight,\n\t});\n}\n\n/**\n * 保持对象尽量在容器内部，优先保证上边、左边显示\n * @param {Object} objDim\n * @param {Number} objDim.left\n * @param {Number} objDim.top\n * @param {Number} objDim.width\n * @param {Number} objDim.height\n * @param {Object} ctnDim\n * @param {Number} ctnDim.left\n * @param {Number} ctnDim.top\n * @param {Number} ctnDim.width\n * @param {Number} ctnDim.height\n * {Array} dimension [dimension.left, dimension.top]\n */\nexport const keepRectInContainer = (objDim, ctnDim = {\n\tleft: 0,\n\ttop: 0,\n\twidth: window.innerWidth,\n\theight: window.innerHeight\n}) => {\n\tlet ret = {left: objDim.left, top: objDim.top};\n\n\t//oversize\n\tif(objDim.width > ctnDim.width || objDim.height > ctnDim.height){\n\t\treturn ret;\n\t}\n\n\t//右边超出\n\tif((objDim.width + objDim.left) > (ctnDim.width + ctnDim.left)){\n\t\tret.left = objDim.left - ((objDim.width + objDim.left) - (ctnDim.width + ctnDim.left));\n\t}\n\n\t//底边超出\n\tif((objDim.height + objDim.top) > (ctnDim.height + ctnDim.top)){\n\t\tret.top = objDim.top - ((objDim.height + objDim.top) - (ctnDim.height + ctnDim.top));\n\t}\n\n\t//优先保证左边露出\n\tif(objDim.left < ctnDim.left){\n\t\tret.left = ctnDim.left;\n\t}\n\n\t//优先保证上边露出\n\tif(objDim.top < ctnDim.top){\n\t\tret.top = ctnDim.top;\n\t}\n\treturn ret;\n}\n\n/**\n * 获取对象宽、高\n * 通过设置 visibility 方式进行获取\n * @param {HTMLElement} dom\n * @return {{width: number, height: number}}\n */\nexport const getDomDimension = (dom) => {\n\tlet org_visibility = dom.style.visibility;\n\tlet org_display = dom.style.display;\n\tlet width, height;\n\n\tdom.style.visibility = 'hidden';\n\tdom.style.display = 'block';\n\twidth = dom.clientWidth;\n\theight = dom.clientHeight;\n\tdom.style.visibility = org_visibility;\n\tdom.style.display = org_display;\n\treturn {width, height};\n}\n\n/**\n * 矩形相交（包括边重叠情况）\n * @param {Object} rect1\n * @param {Object} rect2\n * @returns {boolean}\n */\nexport const rectAssoc = (rect1, rect2) => {\n\tif(rect1.left <= rect2.left){\n\t\treturn (rect1.left + rect1.width) >= rect2.left && (\n\t\t\tbetween(rect2.top, rect1.top, rect1.top + rect1.height) ||\n\t\t\tbetween(rect2.top + rect2.height, rect1.top, rect1.top + rect1.height) ||\n\t\t\trect2.top >= rect1.top && rect2.height >= rect1.height\n\t\t);\n\t}else{\n\t\treturn (rect2.left + rect2.width) >= rect1.left && (\n\t\t\tbetween(rect1.top, rect2.top, rect2.top + rect2.height) ||\n\t\t\tbetween(rect1.top + rect1.height, rect2.top, rect2.top + rect2.height) ||\n\t\t\trect1.top >= rect2.top && rect1.height >= rect2.height\n\t\t);\n\t}\n};\n\n\n/**\n * isElement\n * @param {*} obj\n * @returns {boolean}\n */\nexport const isElement = (obj) => {\n\ttry{\n\t\t//Using W3 DOM2 (works for FF, Opera and Chrome)\n\t\treturn obj instanceof HTMLElement;\n\t}catch(e){\n\t\t//Browsers not supporting W3 DOM2 don't have HTMLElement and\n\t\t//an exception is thrown and we end up here. Testing some\n\t\t//properties that all elements have. (works on IE7)\n\t\treturn (typeof obj === \"object\") &&\n\t\t\t(obj.nodeType === 1) && (typeof obj.style === \"object\") &&\n\t\t\t(typeof obj.ownerDocument === \"object\");\n\t}\n};\n\nlet _c = {};\n\n/**\n * 挂载css文件\n * @param {String} file\n * @param {Boolean} forceReload 是否强制重新挂载，缺省不重复挂载\n */\nexport const loadCss = (file, forceReload = false) => {\n\tif(!forceReload && _c[file]){\n\t\treturn _c[file];\n\t}\n\t_c[file] = new Promise((resolve, reject) => {\n\t\tlet link = document.createElement('link');\n\t\tlink.rel = \"stylesheet\";\n\t\tlink.href = file;\n\t\tlink.onload = () => {\n\t\t\tresolve()\n\t\t};\n\t\tlink.onerror = () => {\n\t\t\treject()\n\t\t};\n\t\tdocument.head.append(link);\n\t});\n\treturn _c[file];\n};\n\n/**\n * 加载script脚本\n * @param {String} src 脚本地址\n * @param {Boolean} forceReload 是否强制重新加载，缺省为去重加载\n * @return {Promise}\n */\nexport const loadScript = (src, forceReload = false) => {\n\tif(!forceReload && _c[src]){\n\t\treturn _c[src];\n\t}\n\t_c[src] = new Promise((resolve, reject) => {\n\t\tlet script = document.createElement('script');\n\t\tscript.src = src;\n\t\tscript.onload = () => {\n\t\t\tresolve()\n\t\t};\n\t\tscript.onerror = () => {\n\t\t\treject()\n\t\t};\n\t\tdocument.head.append(script);\n\t});\n\treturn _c[src];\n};\n\n/**\n * insert style sheet in head\n * @param {String} styleSheetStr\n * @param {String} id\n * @return {HTMLStyleElement}\n */\nexport const insertStyleSheet = (styleSheetStr, id = '', doc = document) => {\n\tlet style = doc.createElement('style');\n\tdoc.head.appendChild(style);\n\tstyle.innerHTML = styleSheetStr;\n\tif(id){\n\t\tstyle.id = id;\n\t}\n\treturn style;\n};\n\n/**\n * 获取DOM节点视觉呈现信息\n * @param win\n * @returns {{\n *  screenLeft: number,\n *  screenTop: number,\n *  visibleWidth: number,\n *  visibleHeight: number,\n *  horizonScroll: number,\n *  documentWidth: number,\n *  documentHeight: number,\n *  }}\n */\nexport const getRegion = (win = window) => {\n\tlet info = {};\n\tlet doc = win.document;\n\tinfo.screenLeft = win.screenLeft ? win.screenLeft : win.screenX;\n\tinfo.screenTop = win.screenTop ? win.screenTop : win.screenY;\n\n\t//no ie\n\tif(win.innerWidth){\n\t\tinfo.visibleWidth = win.innerWidth;\n\t\tinfo.visibleHeight = win.innerHeight;\n\t\tinfo.horizenScroll = win.pageXOffset;\n\t\tinfo.verticalScroll = win.pageYOffset;\n\t}else{\n\t\t//IE + DOCTYPE defined || IE4, IE5, IE6+no DOCTYPE\n\t\tlet tmp = (doc.documentElement && doc.documentElement.clientWidth) ?\n\t\t\tdoc.documentElement : doc.body;\n\t\tinfo.visibleWidth = tmp.clientWidth;\n\t\tinfo.visibleHeight = tmp.clientHeight;\n\t\tinfo.horizenScroll = tmp.scrollLeft;\n\t\tinfo.verticalScroll = tmp.scrollTop;\n\t}\n\n\tlet tag = (doc.documentElement && doc.documentElement.scrollWidth) ?\n\t\tdoc.documentElement : doc.body;\n\tinfo.documentWidth = Math.max(tag.scrollWidth, info.visibleWidth);\n\tinfo.documentHeight = Math.max(tag.scrollHeight, info.visibleHeight);\n\treturn info;\n};\n\n/**\n * 检测矩形是否在指定布局内部\n * @param rect\n * @param layout\n * @returns {*}\n */\nexport const rectInLayout = (rect, layout) => {\n\treturn between(rect.top, layout.top, layout.top + layout.height) && between(rect.left, layout.left, layout.left + layout.width) //左上角\n\t\t&& between(rect.top + rect.height, layout.top, layout.top + layout.height) && between(rect.left + rect.width, layout.left, layout.left + layout.width); //右下角\n};\n\n/**\n * 设置dom样式\n * @param {HTMLElement} dom\n * @param {Object} style 样式对象\n */\nexport const setStyle = (dom, style = {}) => {\n\tfor(let key in style){\n\t\tkey = strToPascalCase(key);\n\t\tdom.style[key] = dimension2Style(style[key]);\n\t}\n}\n\n/**\n * 高亮节点关键字\n * @param {HTMLElement} node\n * @param {RegExp|String} pattern\n * @param {String} hlClass\n * @return {number}\n */\nexport const nodeHighlight = (node, pattern, hlClass) => {\n\tlet skip = 0;\n\tif(node.nodeType === 3){\n\t\tpattern = new RegExp(pattern, 'i');\n\t\tlet pos = node.data.search(pattern);\n\t\tif(pos >= 0 && node.data.length > 0){ // .* matching \"\" causes infinite loop\n\t\t\tlet match = node.data.match(pattern); // get the match(es), but we would only handle the 1st one, hence /g is not recommended\n\t\t\tlet spanNode = document.createElement('span');\n\t\t\tspanNode.className = hlClass; // set css\n\t\t\tlet middleBit = node.splitText(pos); // split to 2 nodes, node contains the pre-pos text, middleBit has the post-pos\n\t\t\tlet endBit = middleBit.splitText(match[0].length); // similarly split middleBit to 2 nodes\n\t\t\tlet middleClone = middleBit.cloneNode(true);\n\t\t\tspanNode.appendChild(middleClone);\n\t\t\t// parentNode ie. node, now has 3 nodes by 2 splitText()s, replace the middle with the highlighted spanNode:\n\t\t\tmiddleBit.parentNode.replaceChild(spanNode, middleBit);\n\t\t\tskip = 1; // skip this middleBit, but still need to check endBit\n\t\t}\n\t}else if(node.nodeType === 1 && node.childNodes && !/(script|style)/i.test(node.tagName)){\n\t\tfor(let i = 0; i < node.childNodes.length; ++i){\n\t\t\ti += nodeHighlight(node.childNodes[i], pattern, hlClass);\n\t\t}\n\t}\n\treturn skip;\n}\n\n/**\n * tab 连接\n * @param {Element[]|String} tabs tab节点列表\n * @param {Element[]|String} contents 内容节点列表\n * @param {Object} option 选项\n * @param {string} option.contentActiveClass 内容区激活类名\n * @param {string} option.tabActiveClass tab区激活类名\n * @param {string} option.triggerEvent tab激活事件类型\n */\nexport const tabConnect = (tabs, contents, option = {}) => {\n\tlet {contentActiveClass = 'active', tabActiveClass = 'active', triggerEvent = 'click'} = option;\n\tif(typeof (tabs) === 'string'){\n\t\ttabs = findAll(tabs);\n\t}\n\tif(typeof (contents) === 'string'){\n\t\tcontents = findAll(contents);\n\t}\n\ttabs.forEach((tab, idx) => {\n\t\ttab.addEventListener(triggerEvent, e => {\n\t\t\tcontents.forEach(ctn => {\n\t\t\t\tctn.classList.remove(contentActiveClass);\n\t\t\t});\n\t\t\tcontents[idx].classList.add(contentActiveClass);\n\t\t\ttabs.forEach(t => {\n\t\t\t\tt.classList.remove(tabActiveClass);\n\t\t\t});\n\t\t\ttab.classList.add(tabActiveClass);\n\t\t});\n\t});\n}\n\n/**\n * 创建HTML节点\n * @param {String} html\n * @param {HTMLElement|null} parentNode 父级节点\n * @returns {HTMLElement|HTMLElement[]}\n */\nexport const createDomByHtml = (html, parentNode = null) => {\n\tlet tpl = document.createElement('template');\n\thtml = html.trim();\n\ttpl.innerHTML = html;\n\tlet nodes = [];\n\tif(parentNode){\n\t\ttpl.content.childNodes.forEach(node => {\n\t\t\tnodes.push(parentNode.appendChild(node));\n\t\t})\n\t}else{\n\t\tnodes = tpl.content.childNodes;\n\t}\n\treturn nodes.length === 1 ? nodes[0] : nodes;\n};\n\n/**\n * 强制重绘元素\n * @param {HTMLElement} element\n * @param {Number} delay\n */\nexport function repaint(element, delay = 0){\n\tsetTimeout(() => {\n\t\ttry{\n\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\telement.hidden = true;\n\n\t\t\t// eslint-disable-next-line no-unused-expressions\n\t\t\telement.offsetHeight;\n\n\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\telement.hidden = false;\n\t\t}catch(_){\n\t\t\t// Do nothing\n\t\t}\n\t}, delay);\n}\n\n/**\n * 进入全屏模式\n * @param {HTMLElement} element\n */\nexport const enterFullScreen = (element) => {\n\tif(element.requestFullscreen){\n\t\treturn element.requestFullscreen();\n\t}\n\tif(element.webkitRequestFullScreen){\n\t\treturn element.webkitRequestFullScreen();\n\t}\n\tif(element.mozRequestFullScreen){\n\t\telement.mozRequestFullScreen();\n\t}\n\tif(element.msRequestFullScreen){\n\t\telement.msRequestFullScreen();\n\t}\n\tthrow \"Browser no allow full screen\";\n}\n\n/**\n * 退出全屏\n * @returns {Promise<void>}\n */\nexport const exitFullScreen = () => {\n\treturn document.exitFullscreen();\n}\n\n/**\n * 切换全屏\n * @param element\n * @returns {Promise<unknown>}\n */\nexport const toggleFullScreen = (element) => {\n\treturn new Promise((resolve, reject) => {\n\t\tif(!isInFullScreen()){\n\t\t\tenterFullScreen(element).then(resolve).catch(reject);\n\t\t}else{\n\t\t\texitFullScreen().then(resolve).catch(reject);\n\t\t}\n\t})\n}\n\n/**\n * 检测是否正在全屏\n * @returns {boolean}\n */\nexport const isInFullScreen = () => {\n\treturn !!document.fullscreenElement;\n}\n\nlet CURRENT_WINDOW;\n\n/**\n * @param win\n */\nexport const setContextWindow = (win) => {\n\tCURRENT_WINDOW = win;\n}\n\n/**\n * 获取当前上下文 文档，缺省为获取top\n * @return {Document}\n */\nexport const getContextDocument = () => {\n\tlet win = getContextWindow();\n\treturn win.document;\n};\n\n/**\n * 获取上下文窗口\n * @return {Window}\n */\nexport const getContextWindow = () => {\n\tif(CURRENT_WINDOW){\n\t\treturn CURRENT_WINDOW;\n\t}\n\tlet win;\n\ttry{\n\t\twin = window;\n\t\twhile(win != win.parent){\n\t\t\twin = win.parent;\n\t\t}\n\t}catch(err){\n\t\tconsole.warn('context window assign fail:', err);\n\t}\n\treturn win || window;\n}\n\n/**\n * 设置cookie\n * @param {String} name\n * @param {String} value\n * @param {Number} days\n * @param {String} path\n */\nexport const setCookie = (name, value, days, path = '/') => {\n\tvar expires = \"\";\n\tif(days){\n\t\tvar date = new Date();\n\t\tdate.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n\t\texpires = \"; expires=\" + date.toUTCString();\n\t}\n\tdocument.cookie = name + \"=\" + (value || \"\") + expires + \"; path=\" + path;\n}\n\n/**\n * 获取cookie\n * @param {String} name\n * @returns {string|null}\n */\nexport const getCookie = (name) => {\n\tvar nameEQ = name + \"=\";\n\tvar ca = document.cookie.split(';');\n\tfor(var i = 0; i < ca.length; i++){\n\t\tvar c = ca[i];\n\t\twhile(c.charAt(0) == ' ') c = c.substring(1, c.length);\n\t\tif(c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);\n\t}\n\treturn null;\n}\n\n/**\n * 删除cookie\n * @param name\n */\nexport const deleteCookie = (name) => {\n\tdocument.cookie = name + '=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;';\n}","import {insertStyleSheet} from \"../Lang/Dom.js\";\n\nconst NS = 'WebCom-';\nconst VAR_PREFIX = '--' + NS;\nconst ICON_FONT = NS + 'iconfont';\n\n//css 样式变量名定义\nconst CSS_VAR_COLOR = VAR_PREFIX + 'color';\nconst CSS_VAR_COLOR_LIGHTEN = VAR_PREFIX + 'color-lighten';\nconst CSS_VAR_DISABLE_COLOR = VAR_PREFIX + 'disable-color';\nconst CSS_VAR_BACKGROUND_COLOR = VAR_PREFIX + 'background-color';\nconst CSS_VAR_PANEL_SHADOW = VAR_PREFIX + 'panel-shadow';\nconst CSS_VAR_PANEL_BORDER = VAR_PREFIX + 'panel-border';\nconst CSS_VAR_PANEL_BORDER_COLOR = VAR_PREFIX + 'panel-border-color';\nconst CSS_VAR_PANEL_RADIUS = VAR_PREFIX + 'panel-radius';\nconst CSS_VAR_FULL_SCREEN_BACKDROP_FILTER = VAR_PREFIX + 'full-screen-backdrop-filter';\nconst CSS_VAR_FULL_SCREEN_BACKGROUND_COLOR = VAR_PREFIX + 'full-screen-background-color';\n\ninsertStyleSheet(`\n@font-face {\n\tfont-family: '${ICON_FONT}';  /* Project id 3359671 */\n\tsrc: url('//at.alicdn.com/t/c/font_3359671_6sdhf2dfnne.woff2?t=1703834753032') format('woff2'),\n       url('//at.alicdn.com/t/c/font_3359671_6sdhf2dfnne.woff?t=1703834753032') format('woff'),\n       url('//at.alicdn.com/t/c/font_3359671_6sdhf2dfnne.ttf?t=1703834753032') format('truetype');\n}\n:root {\n\t${CSS_VAR_COLOR}:#333;\n\t${CSS_VAR_COLOR_LIGHTEN}:#666;\n\t${CSS_VAR_DISABLE_COLOR}:#aaa;\n\t${CSS_VAR_BACKGROUND_COLOR}:#fff;\n\t\n\t${CSS_VAR_PANEL_SHADOW}:1px 1px 5px #bcbcbcb3;\n\t${CSS_VAR_PANEL_BORDER_COLOR}:#ccc;\n\t${CSS_VAR_PANEL_BORDER}:1px solid var(${CSS_VAR_PANEL_BORDER_COLOR});\n\t${CSS_VAR_PANEL_RADIUS}:4px;\n\t\n\t${CSS_VAR_FULL_SCREEN_BACKDROP_FILTER}:blur(4px);\n\t${CSS_VAR_FULL_SCREEN_BACKGROUND_COLOR}:#33333342;\n}`, NS+'style');\n\nexport const Theme = {\n\tNamespace: NS,\n\tCssVarPrefix: VAR_PREFIX,\n\tCssVar: {\n\t\t'COLOR': CSS_VAR_COLOR,\n\t\t'CSS_LIGHTEN': CSS_VAR_COLOR_LIGHTEN,\n\t\t'DISABLE_COLOR': CSS_VAR_DISABLE_COLOR,\n\t\t'BACKGROUND_COLOR': CSS_VAR_BACKGROUND_COLOR,\n\t\t'PANEL_SHADOW': CSS_VAR_PANEL_SHADOW,\n\t\t'PANEL_BORDER': CSS_VAR_PANEL_BORDER,\n\t\t'PANEL_BORDER_COLOR': CSS_VAR_PANEL_BORDER_COLOR,\n\t\t'PANEL_RADIUS': CSS_VAR_PANEL_RADIUS,\n\t\t'FULL_SCREEN_BACKDROP_FILTER': CSS_VAR_FULL_SCREEN_BACKDROP_FILTER,\n\t\t'FULL_SCREEN_BACKGROUND_COLOR': CSS_VAR_FULL_SCREEN_BACKGROUND_COLOR,\n\t},\n\tIconFont: ICON_FONT,\n\tTipIndex: 10, //功能提示类(指向具体元素)\n\tMaskIndex: 100, //遮罩(（全局或指定面板遮罩类）\n\tDialogIndex: 1000, //对话框等窗口类垂直索引\n\tFullScreenModeIndex: 10000, //全屏类（全屏类\n\tContextIndex: 100000, //右键菜单\n\tToastIndex: 1000000, //消息提示（顶部呈现）\n}","import {createDomByHtml, getContextWindow, hide, insertStyleSheet, remove, show} from \"./../Lang/Dom.js\"\nimport {Theme} from \"./Theme.js\";\n\nconst COM_ID = Theme.Namespace + 'toast';\n\nconst TOAST_CLS_MAIN = Theme.Namespace + 'toast';\nconst rotate_animate = Theme.Namespace + '-toast-rotate';\nconst fadeIn_animate = Theme.Namespace + '-toast-fadein';\nconst fadeOut_animate = Theme.Namespace + '-toast-fadeout';\nconst FADEIN_TIME = 200;\nconst FADEOUT_TIME = 500;\n\ninsertStyleSheet(`\n\t@keyframes ${rotate_animate} {\n\t    0% {transform:scale(1.4) rotate(0deg);}\n\t    100% {transform:scale(1.4) rotate(360deg);}\n\t}\n\t@keyframes ${fadeIn_animate} {\n\t\t0% { opacity: 0; }\n\t\t100% { opacity: 1; } \n\t}\n\t@keyframes ${fadeOut_animate} {\n\t\t0% { opacity:1;}\n\t\t100% { opacity: 0} \n\t}\n\t.${TOAST_CLS_MAIN}-wrap{position:absolute; margin:0; padding:0; top:5px; pointer-events:none; background-color:transparent; width:100%; border:none; text-align:center; z-index:${Theme.ToastIndex};}\n\t.${TOAST_CLS_MAIN} {pointer-events:auto}\n\t.${TOAST_CLS_MAIN}>span {margin-bottom:0.5rem;}\n\t.${TOAST_CLS_MAIN} .ctn{display:inline-block;border-radius:3px;padding:.5rem 1rem .5rem 2.8rem; text-align:left; line-height:1.5rem; background-color:var(${Theme.CssVar.BACKGROUND_COLOR});color:var(${Theme.CssVar.COLOR});box-shadow:var(${Theme.CssVar.PANEL_SHADOW}); animation:${fadeIn_animate} ${FADEIN_TIME}ms}\n\t.${TOAST_CLS_MAIN} .ctn:before {content:\"\";font-family:${Theme.IconFont}; position:absolute; font-size:1.4rem; margin-left:-1.8rem;}\n\t.${TOAST_CLS_MAIN}-hide .ctn {animation:${fadeOut_animate} ${FADEOUT_TIME}ms; animation-fill-mode:forwards}\n\t.${TOAST_CLS_MAIN}-info .ctn:before {content:\"\\\\e77e\";color: gray;}\n\t.${TOAST_CLS_MAIN}-warning .ctn:before {content:\"\\\\e673\"; color:orange}\n\t.${TOAST_CLS_MAIN}-success .ctn:before {content:\"\\\\e78d\"; color:#007ffc}\n\t.${TOAST_CLS_MAIN}-error .ctn:before {content: \"\\\\e6c6\"; color:red;} \n\t.${TOAST_CLS_MAIN}-loading .ctn:before {content:\"\\\\e635\";color:gray;animation: 1.5s linear infinite ${rotate_animate};animation-play-state: inherit;transform:scale(1.4);will-change: transform}\n`, COM_ID + '-style');\n\nlet toastWrap = null;\n\nconst getWrapper = () => {\n\tif(!toastWrap){\n\t\ttoastWrap = createDomByHtml(`<div class=\"${TOAST_CLS_MAIN}-wrap\" popover=\"manual\"></div>`, document.body);\n\t}\n\treturn toastWrap;\n}\n\nclass Toast {\n\tstatic TYPE_INFO = 'info';\n\tstatic TYPE_SUCCESS = 'success';\n\tstatic TYPE_WARNING = 'warning';\n\tstatic TYPE_ERROR = 'error';\n\tstatic TYPE_LOADING = 'loading';\n\n\t/**\n\t * 各种类型提示默认隐藏时间\n\t */\n\tstatic DEFAULT_TIME_MAP = {\n\t\t[Toast.TYPE_INFO]: 1500,\n\t\t[Toast.TYPE_SUCCESS]: 1500,\n\t\t[Toast.TYPE_WARNING]: 2000,\n\t\t[Toast.TYPE_ERROR]: 2500,\n\t\t[Toast.TYPE_LOADING]: 0,\n\t};\n\n\tmessage = '';\n\ttype = Toast.TYPE_INFO;\n\ttimeout = Toast.DEFAULT_TIME_MAP[this.type];\n\n\tdom = null;\n\n\t/**\n\t * @param {String} message\n\t * @param {String} type\n\t * @param {Number} timeout 超时时间，0表示不关闭\n\t */\n\tconstructor(message, type = null, timeout = null){\n\t\tthis.message = message;\n\t\tthis.type = type || Toast.TYPE_SUCCESS;\n\t\tthis.timeout = timeout === null ? Toast.DEFAULT_TIME_MAP[this.type] : timeout;\n\t}\n\n\t/**\n\t * 显示提示\n\t * @param {String} message\n\t * @param {String} type\n\t * @param {Number} timeout 超时时间，0表示不关闭\n\t * @param {Function} timeoutCallback 超时关闭回调\n\t * @returns\n\t */\n\tstatic showToast = (message, type = null, timeout = null, timeoutCallback = null) => {\n\t\tlet toast = new Toast(message, type, timeout);\n\t\ttoast.show(timeoutCallback);\n\t\treturn toast;\n\t}\n\n\t/**\n\t * 显示[提示]\n\t * @param {String} message\n\t * @param {Function} timeoutCallback 超时关闭回调\n\t * @return {Toast}\n\t */\n\tstatic showInfo = (message, timeoutCallback = null) => {\n\t\treturn this.showToast(message, Toast.TYPE_INFO, this.DEFAULT_TIME_MAP[Toast.TYPE_INFO], timeoutCallback);\n\t}\n\n\t/**\n\t * 显示[成功]\n\t * @param {String} message\n\t * @param {Function} timeoutCallback 超时关闭回调\n\t * @return {Toast}\n\t */\n\tstatic showSuccess = (message, timeoutCallback = null) => {\n\t\treturn this.showToast(message, Toast.TYPE_SUCCESS, this.DEFAULT_TIME_MAP[Toast.TYPE_SUCCESS], timeoutCallback);\n\t}\n\n\t/**\n\t * 显示[告警]\n\t * @param {String} message\n\t * @param {Function} timeoutCallback 超时关闭回调\n\t * @return {Toast}\n\t */\n\tstatic showWarning = (message, timeoutCallback = null) => {\n\t\treturn this.showToast(message, Toast.TYPE_WARNING, this.DEFAULT_TIME_MAP[Toast.TYPE_WARNING], timeoutCallback);\n\t}\n\n\t/**\n\t * 显示[错误]\n\t * @param {String} message\n\t * @param {Function} timeoutCallback 超时关闭回调\n\t * @return {Toast}\n\t */\n\tstatic showError = (message, timeoutCallback = null) => {\n\t\treturn this.showToast(message, Toast.TYPE_ERROR, this.DEFAULT_TIME_MAP[Toast.TYPE_ERROR], timeoutCallback);\n\t}\n\n\t/**\n\t * 显示[加载中]\n\t * @param {String} message\n\t * @param {Function} timeoutCallback 超时关闭回调\n\t * @return {Toast}\n\t */\n\tstatic showLoading = (message, timeoutCallback = null) => {\n\t\treturn this.showToast(message, Toast.TYPE_LOADING, this.DEFAULT_TIME_MAP[Toast.TYPE_LOADING], timeoutCallback);\n\t}\n\n\t/**\n\t * 延期显示 loading（推荐使用）\n\t * 在一些业务后台能够快速响应场景，不显示loading过程能够提升用户体验\n\t * @param {String} message\n\t * @param {Number} delayMicroseconds 延迟显示\n\t * @param {Function} timeoutCallback\n\t * @return {Toast}\n\t */\n\tstatic showLoadingLater = (message, delayMicroseconds = 200, timeoutCallback = null) => {\n\t\tlet time = Toast.DEFAULT_TIME_MAP[Toast.TYPE_LOADING];\n\t\tlet toast = new Toast(message, Toast.TYPE_LOADING, time);\n\t\ttoast.show(timeoutCallback);\n\t\thide(toast.dom);\n\t\tsetTimeout(() => {\n\t\t\ttoast.dom && show(toast.dom);\n\t\t}, delayMicroseconds);\n\t\treturn toast;\n\t}\n\n\t/**\n\t * 显示提示\n\t * @param {Function} onTimeoutClose 超时关闭回调\n\t */\n\tshow(onTimeoutClose = null){\n\t\tlet wrapper = getWrapper();\n\t\twrapper.showPopover();\n\t\tthis.dom = createDomByHtml(\n\t\t\t`<span class=\"${TOAST_CLS_MAIN} ${TOAST_CLS_MAIN}-${this.type}\">\n\t\t\t\t<span class=\"ctn\">${this.message}</span><div></div>\n\t\t\t</span>`, wrapper);\n\t\tif(this.timeout){\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.hide(true);\n\t\t\t\tonTimeoutClose && onTimeoutClose();\n\t\t\t}, this.timeout);\n\t\t}\n\t}\n\n\t/**\n\t * 隐藏提示信息\n\t * @param {Boolean} fadeOut 是否使用渐隐式淡出\n\t */\n\thide(fadeOut = false){\n\t\t//稍微容错下，避免setTimeout后没有父节点\n\t\tif(!this.dom || !document.body.contains(this.dom)){\n\t\t\treturn;\n\t\t}\n\t\tif(fadeOut){\n\t\t\tthis.dom.classList.add(TOAST_CLS_MAIN + '-hide');\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.hide(false);\n\t\t\t}, FADEOUT_TIME);\n\t\t\treturn;\n\t\t}\n\t\tremove(this.dom);\n\t\tthis.dom = null;\n\t\tlet wrapper = getWrapper();\n\t\tif(!wrapper.childNodes.length){\n\t\t\twrapper.hidePopover();\n\t\t}\n\t}\n}\n\nwindow[COM_ID] = Toast;\nlet CONTEXT_WINDOW = getContextWindow();\nlet ToastClass = CONTEXT_WINDOW[COM_ID] || Toast;\n\nexport {ToastClass as Toast};","/**\n * 解析文件扩展名（不包含点，格式如：jpg）\n * @param {string} fileName\n * @return {string}\n */\nexport const resolveFileExtension = fileName => {\n\tif(fileName.indexOf('.')<0){\n\t\treturn '';\n\t}\n\tlet segList = fileName.split('.');\n\treturn segList[segList.length-1];\n}\n\n/**\n * 获取文件名\n * @param {string} fileName\n * @return {string}\n */\nexport const resolveFileName = (fileName)=>{\n\tfileName = fileName.replace(/.*?[/|\\\\]/ig, '');\n\treturn fileName.replace(/\\.[^.]*$/g, \"\");\n};\n\n/**\n * 逐行读取文件\n * @param {File} file\n * @param {Function} linePayload 参数(string) 逐行处理函数，返回 false 表示中断读取\n * @param {Function} onFinish 完成回调函数\n * @param {Function} onError 错误回调函数\n */\nexport const readFileInLine = (file, linePayload, onFinish = null, onError = null) => {\n\tconst CHUNK_SIZE = 1024;\n\tconst reader = new FileReader();\n\n\tlet offset = 0;\n\tlet line_buff = '';\n\tconst seek = () => {\n\t\tif(offset < file.size){\n\t\t\tlet slice = file.slice(offset, offset + CHUNK_SIZE);\n\t\t\treader.readAsArrayBuffer(slice);\n\t\t\toffset += CHUNK_SIZE;\n\t\t} else {\n\t\t\tonFinish();\n\t\t}\n\t}\n\treader.onload = evt => {\n\t\tline_buff += new TextDecoder().decode(new Uint8Array(reader.result))\n\t\tif(line_buff.indexOf(\"\\n\") >= 0){\n\t\t\tlet break_down = false;\n\t\t\tlet lines = line_buff.split(\"\\n\");\n\t\t\tline_buff = lines.pop();\n\t\t\tlines.find(line => {\n\t\t\t\tif(linePayload(line) === false){\n\t\t\t\t\tbreak_down = true;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif(break_down){\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tseek();\n\t}\n\treader.onerror = (err) => {\n\t\tconsole.error(err);\n\t\tonError(err);\n\t}\n\tseek();\n}","export class BizEvent {\n\tevents = [];\n\tbreakOnFalseReturn = false;\n\n\t/**\n\t * 是否在返回false时中断事件继续执行\n\t * @param {boolean} breakOnFalseReturn\n\t */\n\tconstructor(breakOnFalseReturn = false){\n\t\tthis.breakOnFalseReturn = breakOnFalseReturn;\n\t}\n\n\t/**\n\t * 监听事件\n\t * @param {Function} payload\n\t */\n\tlisten(payload){\n\t\tthis.events.push(payload);\n\t}\n\n\t/**\n\t * 移除监听\n\t * @param {Function} payload\n\t */\n\tremove(payload){\n\t\tthis.events = this.events.filter(ev => ev !== payload);\n\t}\n\n\t/**\n\t * 清除所有监听\n\t */\n\tclean(){\n\t\tthis.events = [];\n\t}\n\n\t/**\n\t * 触发时间\n\t * @param {*} args 触发传参\n\t * @returns {boolean}\n\t */\n\tfire(...args){\n\t\tlet breakFlag = false;\n\t\tthis.events.forEach(event => {\n\t\t\tlet ret = event.apply(null, args);\n\t\t\tif(this.breakOnFalseReturn && ret === false){\n\t\t\t\tbreakFlag = true;\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t\treturn !breakFlag;\n\t}\n}\n\nconst EVENT_ACTIVE = 'active';\n\n/**\n * hover event\n * @param {HTMLElement} node\n * @param {Function} hoverIn\n * @param {Function} hoverOut\n */\nexport const onHover = (node, hoverIn, hoverOut)=>{\n\tnode.addEventListener('mouseover', hoverIn);\n\tnode.addEventListener('mouseout', hoverOut);\n}\n\n/**\n * 绑定节点交互触发时间（包括鼠标点击、键盘回车、键盘空格）\n * @param {Node} node\n * @param {CallableFunction} payload\n * @param {Boolean} cancelBubble\n * @param {Boolean} triggerAtOnce 是否立即触发一次（针对初始化场景）\n */\nexport const bindNodeActive = (node, payload, cancelBubble = false, triggerAtOnce = false) => {\n\tnode.addEventListener('click', payload, cancelBubble);\n\tnode.addEventListener('keyup', e => {\n\t\tif(e.keyCode === KEYS.Space || e.keyCode === KEYS.Enter){\n\t\t\tpayload.call(node, e);\n\t\t}\n\t}, cancelBubble);\n\tif(triggerAtOnce){\n\t\tpayload.call(node, null);\n\t}\n}\n\n/**\n * on document ready\n * @param {Function} callback\n */\nexport const onDocReady = (callback)=>{\n\tif (document.readyState === 'complete') {\n\t\tcallback();\n\t} else {\n\t\tdocument.addEventListener(\"DOMContentLoaded\", callback);\n\t}\n}\n\n/**\n * 触发HTML节点事件\n * @param {HTMLElement} node\n * @param {String} event\n */\nexport const triggerDomEvent = (node, event) => {\n\tif(\"createEvent\" in document){\n\t\tlet evt = document.createEvent(\"HTMLEvents\");\n\t\tevt.initEvent(event.toLowerCase(), false, true);\n\t\tnode.dispatchEvent(evt);\n\t}else{\n\t\tnode.fireEvent(\"on\"+event.toLowerCase());\n\t}\n};\n\n/**\n * 批量绑定事件，支持active自定义事件\n * @param {Node} node\n * @param {String|String[]} event 事件名称或事件名称列表\n * @param {Function} payload\n * @param {*} option\n * @param {Boolean} triggerAtOnce 是否立即触发一次（针对初始化场景）\n */\nexport const bindNodeEvents = (node, event, payload, option, triggerAtOnce = false) => {\n\tlet evs = Array.isArray(event) ? event : [event];\n\tevs.forEach(ev => {\n\t\tif(ev === EVENT_ACTIVE){\n\t\t\tbindNodeActive(node, payload, option);\n\t\t}else{\n\t\t\tnode.addEventListener(ev, payload, option);\n\t\t}\n\t});\n\tif(triggerAtOnce){\n\t\tpayload();\n\t}\n}\n\n/**\n * 事件代理\n * @param {HTMLElement} container\n * @param {String} selector\n * @param {String} eventName\n * @param {Function} payload(event, matchedTarget) 回调，第二个参数为匹配的对象节点\n */\nexport const eventDelegate = (container, selector, eventName, payload)=>{\n\tcontainer.addEventListener(eventName, ev=>{\n\t\tlet target = ev.target;\n\t\twhile(target){\n\t\t\tif(target.matches(selector)){\n\t\t\t\tpayload.call(target, ev, target);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(target === container){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\ttarget = target.parentNode;\n\t\t}\n\t});\n}\n\nexport const KEYS = {\n\tA: 65,\n\tB: 66,\n\tC: 67,\n\tD: 68,\n\tE: 69,\n\tF: 70,\n\tG: 71,\n\tH: 72,\n\tI: 73,\n\tJ: 74,\n\tK: 75,\n\tL: 76,\n\tM: 77,\n\tN: 78,\n\tO: 79,\n\tP: 80,\n\tQ: 81,\n\tR: 82,\n\tS: 83,\n\tT: 84,\n\tU: 85,\n\tV: 86,\n\tW: 87,\n\tX: 88,\n\tY: 89,\n\tZ: 90,\n\t0: 48,\n\t1: 49,\n\t2: 50,\n\t3: 51,\n\t4: 52,\n\t5: 53,\n\t6: 54,\n\t7: 55,\n\t8: 56,\n\t9: 57,\n\n\tBackSpace: 8,\n\tEsc: 27,\n\tRightArrow: 39,\n\tTab: 9,\n\tSpace: 32,\n\tDownArrow: 40,\n\tClear: 12,\n\tPageUp: 33,\n\tInsert: 45,\n\tEnter: 13,\n\tPageDown: 34,\n\tDelete: 46,\n\tShift: 16,\n\tEnd: 35,\n\tNumLock: 144,\n\tControl: 17,\n\tHome: 36,\n\tAlt: 18,\n\tLeftArrow: 37,\n\tCapsLock: 20,\n\tUpArrow: 38,\n\n\tF1: 112,\n\tF2: 113,\n\tF3: 114,\n\tF4: 115,\n\tF5: 116,\n\tF6: 117,\n\tF7: 118,\n\tF8: 119,\n\tF9: 120,\n\tF10: 121,\n\tF11: 122,\n\tF12: 123,\n\n\tNumPad0: 96,\n\tNumPad1: 97,\n\tNumPad2: 98,\n\tNumPad3: 99,\n\tNumPad4: 100,\n\tNumPad5: 101,\n\tNumPad6: 102,\n\tNumPad7: 103,\n\tNumPad8: 104,\n\tNumPad9: 105,\n\tNumPadMultiple: 106,\n\tNumPadPlus: 107,\n\tNumPadDash: 109,\n\tNumPadDot: 110,\n\tNumPadSlash: 111,\n\tNumPadEnter: 108\n\t///?\t191\n\t//`~\t192\n\t//\t[{\t219\n\t//:\t186\n// \\|\t220\n\t//=+\t187\n\t//<\t188\n// ]}\t221\n\n\t//-_\t189\n//.>\t190\n// '\"\t222\n};","import {resolveFileExtension, resolveFileName} from \"./File.js\";\nimport {BizEvent} from \"./Event.js\";\nimport {Toast} from \"../Widget/Toast.js\";\nimport {remove} from \"./Dom.js\";\n\nconst CODE_TIMEOUT = 508;\nconst CODE_ABORT = 509;\nconst DEFAULT_TIMEOUT = 0;\n\n/**\n * HTTP请求方法\n * @type {{TRACE: string, HEAD: string, DELETE: string, POST: string, GET: string, CONNECT: string, OPTIONS: string, PUT: string}}\n */\nexport const HTTP_METHOD = {\n\tGET: 'GET',\n\tPOST: 'POST',\n\tPUT: 'PUT',\n\tDELETE: 'DELETE',\n\tOPTIONS: 'OPTIONS',\n\tHEAD: 'HEAD',\n\tCONNECT: 'CONNECT',\n\tTRACE: 'TRACE',\n};\n\n/**\n * 请求格式\n * @type {{FORM: string, JSON: string}}\n */\nexport const REQUEST_FORMAT = {\n\tJSON: 'JSON',\n\tFORM: 'FORM',\n}\n\n/**\n * 请求格式对应的 Content-Type\n * @type {{}}\n */\nconst REQUEST_CONTENT_TYPE_MAP = {\n\t[REQUEST_FORMAT.JSON]: 'application/json',\n\t[REQUEST_FORMAT.FORM]: 'application/x-www-form-urlencoded',\n};\n\n/**\n * 请求数据格式处理\n * @type {{}}\n */\nconst REQUEST_DATA_HANDLE_MAP = {\n\t[REQUEST_FORMAT.JSON]: (data, method) => {\n\t\tif(method === HTTP_METHOD.GET){\n\t\t\treturn '';\n\t\t}\n\t\tif(data instanceof FormData){\n\t\t\tlet obj = {};\n\t\t\tdata.forEach((v,k)=>{\n\t\t\t\tobj[k] = v;\n\t\t\t});\n\t\t\treturn JSON.stringify(obj);\n\t\t}\n\t\treturn JSON.stringify(data);\n\t},\n\t[REQUEST_FORMAT.FORM]: (data, method) => {\n\t\tif(method === HTTP_METHOD.GET){\n\t\t\treturn '';\n\t\t}\n\t\treturn data instanceof FormData ? data : QueryString.stringify(data);\n\t}\n};\n\n/**\n * 响应格式\n * @type {{XML: string, JSON: string, HTML: string, TEXT: string}}\n */\nexport const RESPONSE_FORMAT = {\n\tJSON: 'JSON',\n\tXML: 'XML',\n\tHTML: 'HTML',\n\tTEXT: 'TEXT',\n}\n\n/**\n * 响应格式对应的 Accept 头\n * @type {{}}\n */\nconst RESPONSE_ACCEPT_TYPE_MAP = {\n\t[RESPONSE_FORMAT.JSON]: 'application/json',\n\t[RESPONSE_FORMAT.XML]: 'text/xml',\n\t[RESPONSE_FORMAT.HTML]: 'text/html',\n\t[RESPONSE_FORMAT.TEXT]: 'text/plain',\n};\n\n/**\n * 合并请求参数\n * @param {String} uri\n * @param {String|Object} data\n * @returns {*}\n */\nexport const mergerUriParam = (uri, data) => {\n\treturn uri + (uri.indexOf('?') >= 0 ? '&' : '?') + QueryString.stringify(data);\n}\n\nexport const setHash = data => {\n\tlocation.href = location.href.replace(/#.*$/g, '') + '#' + QueryString.stringify(data);\n}\n\nexport const getHash = () => {\n\treturn location.hash ? location.hash.substring(1) : '';\n}\n\n/**\n * JSON方式请求\n * @param {String} url\n * @param {Object|String} data 数据，当前仅支持对象或queryString\n * @param {String} method\n * @param {Object} option\n * @param {String} option.timeout 请求超时时间（ms）超过指定时间将主动断开链接，0 表示不设置超时时间。\n * @param {String} option.timeoutCallback 超时回调\n * @param {String} option.requestFormat 请求类型（FORM_DATA|JSON） 默认为 REQUEST_FORMAT.JSON 格式\n * @param {String} option.responseFormat 响应类型（JSON）默认为 RESPONSE_FORMAT.JSON 格式，暂不支持其他类型\n * @return {Promise<unknown>}\n */\nexport const requestJSON = (url, data, method = HTTP_METHOD.GET, option = {}) => {\n\treturn method === HTTP_METHOD.GET ? Net.getJSON(url, data, option) : Net.postJSON(url, data, option);\n}\n\n/**\n * 文件上传，同时发送 Accept=application/json，以方便调用方返回\n * @param {String} url 接口地址\n * @param {Object} fileMap 文件映射对象，key为变量名称，如：{name:File}\n * @param callbacks\n * @param {Function} callbacks.onSuccess 成功回调\n * @param {Function} callbacks.onProgress 进度更新回调\n * @param {Function} callbacks.onError 错误回调\n * @param {Function} callbacks.onAbort 中断回调\n * @param {Object|null} extParam 额外传递body变量\n * @return {XMLHttpRequest}\n */\nexport const uploadFile = (url, fileMap, callbacks, extParam = null) => {\n\tlet {onSuccess, onProgress, onError, onAbort} = callbacks;\n\n\t//缺省值\n\tonProgress = onProgress || function(){};\n\tonError = onError || function(err){Toast.showError(err)};\n\tonAbort = onAbort || onError;\n\n\tlet formData = new FormData();\n\tlet total = 0;\n\tfor(let name in fileMap){\n\t\tformData.append(name, fileMap[name]);\n\t\ttotal += fileMap[name].size;\n\t}\n\tif(extParam){\n\t\tfor(let k in extParam){\n\t\t\tformData.append(k, extParam[k]);\n\t\t}\n\t}\n\tlet xhr = new XMLHttpRequest();\n\txhr.withCredentials = true;\n\txhr.upload.addEventListener('progress', e => {\n\t\tonProgress(e.loaded, total);\n\t}, false);\n\txhr.addEventListener('load', () => {\n\t\tif(xhr.readyState === 4){\n\t\t\tif(xhr.status === 200){\n\t\t\t\tonProgress(total, total);\n\t\t\t\tonSuccess(xhr.responseText);\n\t\t\t}else{\n\t\t\t\tonError(xhr.responseText || xhr.statusText);\n\t\t\t}\n\t\t}\n\t});\n\txhr.addEventListener('error', e => {\n\t\tonError(e);\n\t});\n\txhr.addEventListener('abort', () => {\n\t\tonAbort('请求中断');\n\t});\n\txhr.open('POST', url);\n\txhr.setRequestHeader('Accept', RESPONSE_ACCEPT_TYPE_MAP[RESPONSE_FORMAT.JSON])\n\txhr.send(formData);\n\treturn xhr;\n}\n\n/**\n * XHR 网络请求\n */\nexport class Net {\n\tcgi = null; //请求接口\n\tdata = null; //请求数据\n\toption = {\n\t\tmethod: HTTP_METHOD.GET, //请求方法\n\t\ttimeout: DEFAULT_TIMEOUT, //超时时间(毫秒)(超时将纳入onError处理)\n\t\trequestFormat: REQUEST_FORMAT.FORM, //请求数据格式\n\t\tresponseFormat: RESPONSE_FORMAT.TEXT, //响应数据格式\n\t\theaders: {}, //请求头部信息\n\t};\n\txhr = null;\n\tonError = new BizEvent(); //(error,code)\n\tonResponse = new BizEvent(); //(body)\n\tonStateChange = new BizEvent(); //(state) http 状态码\n\tonProgress = new BizEvent(); //(percent)\n\n\t/**\n\t * 构造器\n\t * @param {String} cgi\n\t * @param {String|*} data\n\t * @param {Object} option\n\t */\n\tconstructor(cgi, data, option = {}){\n\t\tthis.cgi = cgi;\n\t\tthis.data = data;\n\t\tthis.option = {\n\t\t\t...this.option,\n\t\t\t...option\n\t\t};\n\t\t//patch GET request parameter\n\t\tif(this.option.method === HTTP_METHOD.GET && this.data){\n\t\t\tthis.cgi = mergerUriParam(this.cgi, this.data);\n\t\t}\n\t\tthis.xhr = new XMLHttpRequest();\n\t\tthis.xhr.open(this.option.method, this.cgi, true);\n\t\tthis.xhr.addEventListener(\"progress\", e => {\n\t\t\tif(e.lengthComputable){\n\t\t\t\tthis.onProgress.fire(e.loaded / e.total);\n\t\t\t}else{\n\t\t\t\tthis.onProgress.fire(null);\n\t\t\t}\n\t\t});\n\t\tthis.xhr.onreadystatechange = () => {\n\t\t\tthis.onStateChange.fire(this.xhr.status);\n\t\t}\n\t\tthis.xhr.addEventListener(\"load\", () => {\n\t\t\tlet ret;\n\t\t\tswitch(option.responseFormat){\n\t\t\t\tcase RESPONSE_FORMAT.JSON:\n\t\t\t\t\ttry {\n\t\t\t\t\t\tret = JSON.parse(this.xhr.responseText);\n\t\t\t\t\t} catch(err){\n\t\t\t\t\t\tthis.onError.fire('JSON解析失败：'+err, this.xhr.status);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase RESPONSE_FORMAT.XML:\n\t\t\t\tcase RESPONSE_FORMAT.TEXT:\n\t\t\t\tcase RESPONSE_FORMAT.HTML:\n\t\t\t\tdefault:\n\t\t\t\t\tret = this.xhr.responseText\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tthis.onResponse.fire(ret);\n\t\t});\n\t\tthis.xhr.addEventListener(\"error\", () => {\n\t\t\tthis.onError.fire(this.xhr.statusText, this.xhr.status);\n\t\t});\n\t\tthis.xhr.addEventListener(\"abort\", () => {\n\t\t\tthis.onError.fire('Request aborted.', CODE_ABORT);\n\t\t});\n\t\tthis.xhr.setRequestHeader('content-type', REQUEST_CONTENT_TYPE_MAP[this.option.requestFormat]);\n\t\tthis.xhr.setRequestHeader('Accept', RESPONSE_ACCEPT_TYPE_MAP[this.option.responseFormat]);\n\t\tfor(let key in this.option.headers){\n\t\t\tthis.xhr.setRequestHeader(key, this.option.headers[key]);\n\t\t}\n\t\tif(this.option.timeout){\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.xhr.abort();\n\t\t\t\tthis.onError.fire('Request timeout', CODE_TIMEOUT);\n\t\t\t}, this.option.timeout);\n\t\t}\n\t}\n\n\t/**\n\t * 发送请求\n\t */\n\tsend(){\n\t\tlet data = this.data ? REQUEST_DATA_HANDLE_MAP[this.option.requestFormat](this.data) : null;\n\t\tthis.xhr.send(data);\n\t}\n\n\t/**\n\t * 终止请求\n\t */\n\tabort(){\n\t\tthis.xhr.abort();\n\t}\n\n\tstatic get(cgi, data, option = {}){\n\t\toption.method = option.method || HTTP_METHOD.GET;\n\t\treturn Net.request(cgi, data, option);\n\t}\n\n\tstatic getJSON(cgi, data, option = {}){\n\t\toption.requestFormat = option.requestFormat || REQUEST_FORMAT.JSON;\n\t\toption.responseFormat = option.responseFormat || RESPONSE_FORMAT.JSON;\n\t\treturn Net.get(cgi, data, option);\n\t}\n\n\tstatic post(cgi, data, option = {}){\n\t\toption.method = option.method || HTTP_METHOD.POST;\n\t\treturn Net.request(cgi, data, option);\n\t}\n\n\tstatic postJSON(cgi, data, option = {}){\n\t\toption.requestFormat = option.requestFormat || REQUEST_FORMAT.JSON;\n\t\toption.responseFormat = option.responseFormat || RESPONSE_FORMAT.JSON;\n\t\treturn Net.post(cgi, data, option);\n\t}\n\n\tstatic request(cgi, data, option = {}){\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet req = new Net(cgi, data, option);\n\t\t\treq.onResponse.listen(ret => {\n\t\t\t\tresolve(ret);\n\t\t\t});\n\t\t\treq.onError.listen(error => {\n\t\t\t\treject(error);\n\t\t\t});\n\t\t\treq.send();\n\t\t});\n\t}\n}\n\n/**\n * 文件下载\n * 注意：在浏览器中如果非同域，自定义保存名称无效\n * @param src 文件地址\n * @param save_name 保存名称（包含扩展名，为空表示自动从src中提取）\n */\nexport const downloadFile = (src, save_name) => {\n\tif(!save_name){\n\t\tsave_name = resolveFileName(src) + '.' + resolveFileExtension(src);\n\t}\n\tlet link = document.createElement('a');\n\tlink.href = src;\n\tlink.download = save_name;\n\tdocument.body.appendChild(link);\n\tlink.click();\n\tremove(link);\n};\n\nexport const QueryString = {\n\tparse(str){\n\t\tif(str[0] === '?'){\n\t\t\tstr = str.substring(1);\n\t\t}\n\t\tlet retObj = {};\n\t\tlet qs = str.split('&');\n\t\tqs.forEach(q => {\n\t\t\tlet [k, v] = q.split('=');\n\t\t\tif(!k.length){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tretObj[decodeURIComponent(k)] = decodeURIComponent(v);\n\t\t});\n\t\treturn retObj;\n\t},\n\n\tstringify(data){\n\t\tif(typeof (data) === 'undefined' || typeof (data) !== 'object'){\n\t\t\treturn data\n\t\t}\n\t\tlet query = []\n\t\tfor(let param in data){\n\t\t\tif(data.hasOwnProperty(param)){\n\t\t\t\tif(data[param] === null){\n\t\t\t\t\tcontinue; //null数据不提交\n\t\t\t\t}\n\t\t\t\tif(typeof (data[param]) === 'object' && data[param].length){\n\t\t\t\t\tdata[param].forEach(item => {\n\t\t\t\t\t\tquery.push(encodeURI(param + '=' + item))\n\t\t\t\t\t});\n\t\t\t\t}else if(typeof (data[param]) === 'object'){\n\t\t\t\t\t//todo 不处理子级object、空数组情况\n\t\t\t\t}else{\n\t\t\t\t\tquery.push(encodeURI(param + '=' + data[param]))\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn query.join('&')\n\t}\n};\n\n/**\n * open link without referer\n * @param link\n * @returns {boolean}\n */\nexport const openLinkWithoutReferer = (link) => {\n\tlet instance = window.open(\"about:blank\");\n\tinstance.document.write(\"<meta http-equiv=\\\"refresh\\\" content=\\\"0;url=\" + link + \"\\\">\");\n\tinstance.document.close();\n\treturn false;\n};\n","/**\n * array_column\n * @param arr\n * @param col_name\n * @returns {Array}\n */\nexport const arrayColumn = (arr, col_name) => {\n\tlet data = [];\n\tfor(let i in arr){\n\t\tdata.push(arr[i][col_name]);\n\t}\n\treturn data;\n};\n\n/**\n * @param arr\n * @param val\n * @return {string|null}\n */\nexport const arrayIndex = (arr, val) => {\n\tfor(let i in arr){\n\t\tif(arr[i] === val){\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn null;\n};\n\n/**\n * @param obj1\n * @param obj2\n * @return {false|this is string[]}\n */\nexport const isEquals = (obj1, obj2) => {\n\tlet keys1 = Object.keys(obj1);\n\tlet keys2 = Object.keys(obj2);\n\t//return true when the two json has same length and all the properties has same value key by key\n\treturn keys1.length === keys2.length && Object.keys(obj1).every(key => obj1[key] === obj2[key]);\n}\n\n/**\n * 数组去重\n * @param {Array} arr\n * @returns {*}\n */\nexport const arrayDistinct = (arr) => {\n\tlet tmpMap = new Map();\n\treturn arr.filter(item => {\n\t\tif(!tmpMap.has(item)){\n\t\t\ttmpMap.set(item, true);\n\t\t\treturn true;\n\t\t}\n\t});\n}\n\n/**\n * array group\n * @param arr\n * @param by_key\n * @param limit limit one child\n * @returns {*}\n */\nexport const arrayGroup = (arr, by_key, limit) => {\n\tif(!arr || !arr.length){\n\t\treturn arr;\n\t}\n\tlet tmp_rst = {};\n\tarr.forEach(item => {\n\t\tlet k = item[by_key];\n\t\tif(!tmp_rst[k]){\n\t\t\ttmp_rst[k] = [];\n\t\t}\n\t\ttmp_rst[k].push(item);\n\t});\n\tif(!limit){\n\t\treturn tmp_rst;\n\t}\n\tlet rst = [];\n\tfor(let i in tmp_rst){\n\t\trst[i] = tmp_rst[i][0];\n\t}\n\treturn rst;\n};\n\n/**\n * 按照对象 KEY 排序\n * @param {Object} obj\n * @return {{}}\n */\nexport const sortByKey = (obj) => {\n\treturn Object.keys(obj).sort().reduce(function(result, key){\n\t\tresult[key] = obj[key];\n\t\treturn result;\n\t}, {});\n}\n\n/**\n * 数组分块\n * @param {Array} list 数据\n * @param {Number} size 每块大小\n * @return {Array[]}\n */\nexport const chunk = (list, size) => {\n\tlet len = list.length;\n\tif(size < 1 || !len){\n\t\treturn [];\n\t}\n\tif(size > len){\n\t\treturn [list];\n\t}\n\tlet res = [];\n\tlet integer = Math.floor(len / size);\n\tlet rest = len % size;\n\tfor(let i = 1; i <= integer; i++){\n\t\tres.push(list.splice(0, size));\n\t}\n\tif(rest){\n\t\tres.push(list.splice(0, rest));\n\t}\n\treturn res;\n}\n\n/**\n * @param path\n * @param value\n * @param srcObj\n * @param glue\n * @return {*}\n */\nexport const objectPushByPath = (path, value, srcObj = {}, glue = '.') => {\n\tlet segments = path.split(glue),\n\t\tcursor = srcObj,\n\t\tsegment,\n\t\ti;\n\n\tfor(i = 0; i < segments.length - 1; ++i){\n\t\tsegment = segments[i];\n\t\tcursor = cursor[segment] = cursor[segment] || {};\n\t}\n\n\treturn cursor[segments[i]] = value;\n}\n\n/**\n * @param {Object} obj\n * @param {String} path\n * @param {String} glue\n * @returns {*}\n */\nexport const objectGetByPath = (obj, path, glue = '.') => {\n\tlet ps = path.split(glue);\n\tfor(let i = 0, len = ps.length; i < len; i++){\n\t\tif(obj[ps[i]] === undefined){\n\t\t\treturn null;\n\t\t}\n\t\tobj = obj[ps[i]];\n\t}\n\treturn obj;\n}\n\n/**\n * 过滤子节点，以目录树方式返回\n * @param parent_id\n * @param all_list\n * @param option\n * @param level\n * @param group_by_parents\n * @return {*[]}\n */\nexport const arrayFilterTree = (parent_id, all_list, option = {}, level = 0, group_by_parents = []) => {\n\toption = Object.assign({\n\t\treturn_as_tree: false,             //以目录树返回，还是以平铺数组形式返回\n\t\tlevel_key: 'tree_level',      //返回数据中是否追加等级信息,如果选项为空, 则不追加等级信息\n\t\tid_key: 'id',              //主键键名\n\t\tparent_id_key: 'parent_id',       //父级键名\n\t\tchildren_key: 'children'         //返回子集key(如果是平铺方式返回,该选项无效\n\t}, option);\n\n\tlet pn_k = option.parent_id_key;\n\tlet lv_k = option.level_key;\n\tlet id_k = option.id_key;\n\tlet as_tree = option.return_as_tree;\n\tlet c_k = option.children_key;\n\n\tlet result = [];\n\tgroup_by_parents = group_by_parents.length ?  group_by_parents : arrayGroup(all_list, pn_k);\n\n\tall_list.forEach(item=>{\n\t\tif(item[pn_k] === parent_id){\n\t\t\titem[lv_k] = level;  //set level\n\t\t\tif(!option.return_as_tree){\n\t\t\t\tresult.push(item);\n\t\t\t}\n\t\t\tif(item[id_k] !== undefined && group_by_parents[item[id_k]] !== undefined && group_by_parents[item[id_k]]){\n\t\t\t\tlet subTrees = arrayFilterTree(item[id_k], all_list, option, level + 1, group_by_parents);\n\t\t\t\tif(subTrees){\n\t\t\t\t\tif(as_tree){\n\t\t\t\t\t\titem[c_k] = subTrees;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tresult = result.concat(...subTrees);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(as_tree){\n\t\t\t\tresult.push(item);\n\t\t\t}\n\t\t}\n\t})\n\treturn result;\n}","import {findAll, isButton} from \"./Dom.js\";\nimport {guid} from \"./Util.js\";\nimport {Theme} from \"../Widget/Theme.js\";\nimport {isEquals, objectPushByPath} from \"./Array.js\";\nimport {escapeAttr} from \"./Html.js\";\nimport {requestJSON} from \"./Net.js\";\n\n/**\n * 检测元素是否可以输入（包含checkbox、radio类）\n * @param {HTMLElement} el\n * @returns {boolean}\n */\nexport const inputAble = el => {\n\tif(el instanceof HTMLFormElement){\n\t\treturn !(el.disabled || //禁用\n\t\t\tel.readOnly || //只读\n\t\t\tel.tagName === 'BUTTON' || //按钮\n\t\t\t(el.tagName === 'INPUT' && ['hidden', 'button', 'submit', 'reset'].includes(el.type)) //特殊input\n\t\t);\n\t}\n\treturn false;\n}\n\n/**\n * 获取form元素值。\n * 该函数过滤元素disabled情况，但不判断name是否存在\n * 针对多重选择，提取数据格式为数组\n * @param {HTMLFormElement} el\n * @returns {String|Array|null} 元素值，发生错误时返回null\n */\nexport const getElementValue = (el) => {\n\tif(el.disabled){\n\t\treturn null;\n\t}\n\tif(el.tagName === 'INPUT' && (el.type === 'radio' || el.type === 'checkbox')){\n\t\treturn el.checked ? el.value : null;\n\t}\n\tif(el.tagName === 'SELECT' && el.multiple){\n\t\tlet vs = [];\n\t\tfindAll('option:checked', el).forEach(item => {\n\t\t\tvs.push(item.value);\n\t\t});\n\t\treturn vs;\n\t}\n\treturn el.value;\n}\n\n/**\n * 表单元素同步变更\n * 该方法会检测元素数据合法性（表单校验）\n * @param {HTMLElement} dom\n * @param {Function} getter 函数执行返回 Promise，返回null时，不填充input\n * @param {Function} setter 函数执行返回 Promise，checkbox、radio类型元素未选择时，返回null，设置失败元素将还原初始值\n */\nexport const formSync = (dom, getter, setter) => {\n\tlet els = getAvailableElements(dom);\n\tels.forEach(function(el){\n\t\tlet name = el.name;\n\t\tlet current_val = getElementValue(el);\n\t\tel.disabled = true;\n\t\tgetter(name).then(v => {\n\t\t\tel.disabled = false;\n\t\t\tif(el.type === 'radio' || el.type === 'checkbox'){\n\t\t\t\tel.checked = el.value == v;\n\t\t\t\tcurrent_val = v;\n\t\t\t}else if(v !== null){\n\t\t\t\tel.value = v;\n\t\t\t\tcurrent_val = v;\n\t\t\t}\n\t\t});\n\t\tel.addEventListener('change', e => {\n\t\t\tel.disabled = true;\n\t\t\tif(!el.checkValidity()){\n\t\t\t\tel.reportValidity();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet val = el.value;\n\t\t\tif((el.type === 'radio' || el.type === 'checkbox') && !el.checked){\n\t\t\t\tval = null;\n\t\t\t}\n\t\t\tsetter(el.name, val).then(() => {\n\t\t\t\tel.disabled = false;\n\t\t\t}, () => {\n\t\t\t\tif(el.type === 'radio' || el.type === 'checkbox'){\n\t\t\t\t\tel.checked = el.value == current_val;\n\t\t\t\t}else if(current_val !== null){\n\t\t\t\t\tel.value = current_val;\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t});\n}\n\n/**\n * 获取指定容器下所有可用表单元素\n * @param {HTMLElement} dom\n * @param {Boolean} ignore_empty_name 是否忽略没有name属性的元素，缺省为必须校验\n * @return {HTMLFormElement[]}\n */\nexport const getAvailableElements = (dom, ignore_empty_name = false) => {\n\tlet els = dom.querySelectorAll('input,textarea,select');\n\treturn Array.from(els).filter(el => {\n\t\treturn !isButton(el) && !el.disabled && (ignore_empty_name || el.name);\n\t});\n}\n\n/**\n * 表单元素校验\n * @param {HTMLElement} dom\n * @param {Boolean} name_validate 是否校验名称必填\n * @return boolean 是否校验通过\n */\nexport const formValidate = (dom, name_validate = false) => {\n\tlet els = getAvailableElements(dom, !name_validate);\n\tlet pass = true;\n\tArray.from(els).every(el => {\n\t\tif(!el.checkValidity()){\n\t\t\tel.reportValidity();\n\t\t\tpass = false;\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t});\n\treturn pass;\n}\n\n/**\n * 获取指定DOM节点下表单元素包含的表单数据，并以Body String方式组装。\n * 该函数过滤表单元素处于 disabled、缺少name等不合理情况\n * @param {HTMLElement} dom 表单节点或普通HTML容器节点\n * @param {Boolean} validate 是否校验表单\n * @returns {String} 如果校验失败，则返回null\n */\nexport const formSerializeString = (dom, validate = true) => {\n\tlet data_list = getFormDataAvailable(dom, validate);\n\tlet data_string_list = [];\n\tdata_list.forEach(item => {\n\t\tlet [name, value] = item;\n\t\tif(Array.isArray(value)){\n\t\t\tvalue.forEach(val => {\n\t\t\t\tdata_string_list.push(encodeURIComponent(name) + '=' + encodeURIComponent(String(val)));\n\t\t\t});\n\t\t}else{\n\t\t\tdata_string_list.push(encodeURIComponent(name) + '=' + encodeURIComponent(String(value)));\n\t\t}\n\t});\n\treturn data_string_list.join('&');\n}\n\n/**\n * 序列化PHP表单到JSON\n * PHP 表单元素名称允许使用中括号来表示多级数组\n * @param {HTMLElement} dom 表单节点或普通HTML容器节点\n * @param {Boolean} validate 是否校验表单\n * @return {Object}\n */\nexport const serializePhpFormToJSON = (dom, validate = true)=>{\n\tlet data_list = getFormDataAvailable(dom, validate);\n\tlet json_obj = {};\n\tlet index_tmp = {\n\t\t//key => current index\n\t};\n\tdata_list.forEach(item => {\n\t\tlet [name, value] = item;\n\t\tif(name.indexOf('[') < 0){\n\t\t\tjson_obj[name] = value;\n\t\t\treturn;\n\t\t}\n\t\tif(index_tmp[name] === undefined){\n\t\t\tindex_tmp[name] = 0;\n\t\t} else {\n\t\t\tindex_tmp[name] ++;\n\t\t}\n\t\tlet name_path = name.replace(/\\[]$/, '.'+index_tmp[name]).replace(/]/g, '').replace(/\\[/g, '.');\n\t\tobjectPushByPath(name_path, value, json_obj, '.');\n\t});\n\treturn json_obj;\n}\n\n/**\n * 修正GET提交方式的表单action错误\n * @param {HTMLFormElement} form\n */\nexport const fixGetFormAction = (form)=>{\n\tlet action = form.action;\n\tif(form.method && form.method.toLowerCase() !== 'get' || !action.length){\n\t\treturn;\n\t}\n\tlet url = new URL(action);\n\tlet ipt;\n\turl.searchParams.forEach((v,k)=>{\n\t\tipt = document.createElement('input');\n\t\tipt.type = 'hidden';\n\t\tipt.name = k;\n\t\tipt.value = v;\n\t\tform.appendChild(ipt);\n\t});\n}\n\n/**\n * 绑定表单提交到JSON\n * @param {HTMLFormElement} form\n * @param {Function} onSubmitting\n * @return {Promise}\n */\nexport const bindFormSubmitAsJSON = (form, onSubmitting = ()=>{})=>{\n\treturn new Promise((resolve, reject) => {\n\t\tlet submitting = false;\n\t\tform.addEventListener('submit', e => {\n\t\t\tif(submitting){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tsubmitting = true;\n\t\t\tlet url = form.action;\n\t\t\tlet method = form.method.toUpperCase() || \"GET\";\n\t\t\tlet data = formSerializeJSON(form);\n\t\t\tonSubmitting();\n\t\t\trequestJSON(url, data, method).then(resolve, reject).finally(() => {\n\t\t\t\tsubmitting = false;\n\t\t\t});\n\t\t\te.preventDefault();\n\t\t\treturn false;\n\t\t});\n\t});\n}\n\n/**\n * 获取表单可用数据，以数组方式返回\n * 注意：该数组包含 [name, value]，其中 name 可重复。\n * @param {HTMLElement} dom 表单节点或普通HTML容器节点\n * @param {Boolean} validate 是否校验表单\n * @return {Array[]}\n */\nexport const getFormDataAvailable = (dom, validate = true) => {\n\tif(validate && !formValidate(dom)){\n\t\treturn [];\n\t}\n\tlet els = getAvailableElements(dom);\n\tlet data_list = [];\n\tels.forEach(el=>{\n\t\tlet name = el.name;\n\t\tlet value = getElementValue(el);\n\t\tif(value !== null){\n\t\t\tdata_list.push([name, value]);\n\t\t}\n\t})\n\treturn data_list;\n}\n\n/**\n * 获取指定DOM节点下表单元素包含的表单数据，并以JSON方式组装。\n * 注意：同名表单项以JS数组方式组装，PHP方法名称中中括号将被作为变量名一部分使用\n * @param {HTMLElement} dom 表单节点或普通HTML容器节点\n * @param {Boolean} validate 是否校验表单\n * @returns {Object} JSON数据\n */\nexport const formSerializeJSON = (dom, validate = true) => {\n\tlet json_obj = {};\n\tlet data_list = getFormDataAvailable(dom, validate);\n\tlet name_counts = {};\n\tdata_list.forEach(item=>{\n\t\tlet [name] = item;\n\t\tif(name_counts[name] === undefined){\n\t\t\tname_counts[name] = 1;\n\t\t} else {\n\t\t\tname_counts[name]++\n\t\t}\n\t});\n\tdata_list.forEach(item => {\n\t\tlet [name, value] = item;\n\t\tif(name_counts[name] > 1){\n\t\t\tif(json_obj[name] === undefined){\n\t\t\t\tjson_obj[name] = [value];\n\t\t\t}else{\n\t\t\t\tjson_obj[name].push(value);\n\t\t\t}\n\t\t}else{\n\t\t\tjson_obj[name] = value;\n\t\t}\n\t});\n\treturn json_obj;\n};\n\n/**\n * 转换表单数据对象到JSON对象\n * @example convertFormDataToObject({name:\"hello\", age:\"10\", isBoy:0, ext:\"{city:'shenzhen'}\"}, {name:\"\", age:0, isBoy:true, ext:{}})，\n * 结果返回： {name:\"hello\", age:10, isBoy:false, ext:{city:shenzhen}}\n * @param {Object} formDataMap 数据对象（从表单获取到的数据都是字符串类型的）\n * @param {Object} formatSchema 格式定义对象，如： {name:\"Jack\", age:10, isBoy:true}\n * @param {Boolean} mustExistsInSchema 是否必须存在格式定义中\n * @return {Object}\n */\nexport const convertFormDataToObject = (formDataMap, formatSchema, mustExistsInSchema = true) => {\n\tlet ret = {};\n\tfor(let key in formDataMap){\n\t\tlet value = formDataMap[key];\n\t\tlet define = formatSchema[key];\n\t\tif(define === undefined){\n\t\t\tif(mustExistsInSchema){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tret[key] = value;\n\t\t\tcontinue;\n\t\t}\n\t\tswitch(typeof (define)){\n\t\t\tcase 'string':\n\t\t\t\tret[key] = value;\n\t\t\t\tbreak;\n\t\t\tcase 'boolean':\n\t\t\t\tret[key] = value === '1' || value === 'true';\n\t\t\t\tbreak;\n\t\t\tcase 'number':\n\t\t\t\tret[key] = parseInt(value, 10);\n\t\t\t\tbreak;\n\t\t\tcase 'object':\n\t\t\t\tret[key] = value ? JSON.parse(value) : {};\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow \"format schema no supported\";\n\t\t}\n\t}\n\treturn ret;\n}\n\nlet _form_data_cache_init = {};\nlet _form_data_cache_new = {};\nlet _form_us_msg = {};\nlet _form_us_sid_attr_key = Theme.Namespace+'form-unsaved-sid';\n\n/**\n * 绑定页面离开时，表单未保存警告\n * @param {HTMLFormElement} form\n * @param {String} alertMsg\n */\nexport const bindFormUnSavedUnloadAlert = (form, alertMsg = '您的表单尚未保存，是否确认离开？')=>{\n\tif(form.getAttribute(_form_us_sid_attr_key)){\n\t\treturn;\n\t}\n\tlet us_sid = guid();\n\t_form_us_msg[us_sid] = alertMsg;\n\tform.setAttribute(_form_us_sid_attr_key, us_sid);\n\twindow.addEventListener('beforeunload', (e) => {\n\t\tif(!document.body.contains(form)){\n\t\t\treturn \"\";\n\t\t}\n\t\tlet msg = validateFormChanged(form);\n\t\tconsole.log('unchanged msg', msg);\n\t\tif(msg){\n\t\t\te.preventDefault();\n\t\t\te.returnValue = msg;\n\t\t\treturn msg;\n\t\t}\n\t});\n\tlet els = getAvailableElements(form, true);\n\tels.forEach(el=>{\n\t\tel.addEventListener('input', ()=>{\n\t\t\t_form_data_cache_new[us_sid] = formSerializeJSON(form, false);\n\t\t});\n\t});\n\tresetFormChangedState(form);\n}\n\n/**\n * 校验表单内容是否变更\n * @param {HTMLFormElement} form\n * @return {boolean|String}\n */\nexport const validateFormChanged = (form) => {\n\tlet us_sid = form.getAttribute(_form_us_sid_attr_key);\n\tif(!us_sid){\n\t\tthrow \"Form no init by bindFormUnSavedAlert()\";\n\t}\n\tif(!isEquals(_form_data_cache_init[us_sid], _form_data_cache_new[us_sid])){\n\t\treturn _form_us_msg[us_sid];\n\t}\n\treturn false;\n}\n\n/**\n * 重置表单未保存提示状态\n * @param {HTMLFormElement} form\n */\nexport const resetFormChangedState = (form) => {\n\tlet us_sid = form.getAttribute(_form_us_sid_attr_key);\n\tif(!us_sid){\n\t\tthrow \"Form no init by bindFormUnSavedAlert()\";\n\t}\n\t_form_data_cache_init[us_sid] = _form_data_cache_new[us_sid] = formSerializeJSON(form, false);\n}\n\n/**\n * 转换对象为表单元素数值\n * @param {Object} objectMap\n * @param {Array} boolMapping\n * @return {Object}\n */\nexport const convertObjectToFormData = (objectMap, boolMapping = [\"1\", \"0\"]) => {\n\tlet ret = {};\n\tfor(let key in objectMap){\n\t\tlet value = objectMap[key];\n\t\tswitch(typeof (value)){\n\t\t\tcase 'string':\n\t\t\tcase 'number':\n\t\t\t\tret[key] = String(value);\n\t\t\t\tbreak;\n\t\t\tcase 'boolean':\n\t\t\t\tret[key] = value ? boolMapping[0] : boolMapping[1];\n\t\t\t\tbreak;\n\t\t\tcase 'object':\n\t\t\t\tret[key] = JSON.stringify(value);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow \"format schema no supported\";\n\t\t}\n\t}\n\treturn ret;\n}\n\n/**\n * 构建 HTML Input:hidden 标签\n * @param {Object} maps {key:value}\n * @return {string}\n */\nexport const buildHtmlHidden = (maps)=>{\n\tlet html = '';\n\tfor(let key in maps){\n\t\tlet val = maps[key] === null ? '' : maps[key];\n\t\thtml += `<input type=\"hidden\" name=\"${escapeAttr(key)}\" value=\"${escapeAttr(val)}\"/>`;\n\t}\n\treturn html;\n}","import {Toast} from \"../Widget/Toast.js\";\nimport {REQUEST_FORMAT, requestJSON} from \"../Lang/Net.js\";\nimport {formSerializeJSON, formSerializeString} from \"../Lang/Form.js\";\n\nconst SUBMITTING_FLAG = 'data-submitting';\n\n/**\n * 修正从 input[type=submit][formaction] 按钮提交的表单动作\n * @param {HTMLFormElement} form\n * @param {Event|Null} event\n * @returns {string}\n */\nconst fixFormAction = (form, event = null) => {\n\tif(event && event.submitter && event.submitter.formAction){\n\t\treturn event.submitter.formAction;\n\t}\n\treturn form.action;\n}\n\n/**\n * 异步组件\n * 参数：\n * ACAsync.FORM_DATA_PACKAGE_TYPE 设置数据打包方式，如后端是PHP，为兼容PHP数组识别语法，请使用：PACKAGE_TYPE_STRING 方式打包\n * 缺省为 PACKAGE_TYPE_JSON 方式打包\n * node[data-async-url] | a[href] | form[action] 请求url\n * node[data-async-method] | form[method] 请求方法，缺省为GET\n * node[data-async-data] | form{*} 请求数据\n */\nexport class ACAsync {\n\tstatic REQUEST_FORMAT = REQUEST_FORMAT.JSON;\n\n\t//默认成功回调处理函数\n\t//允许外部重新定义\n\tstatic COMMON_SUCCESS_RESPONSE_HANDLE = (rsp) => {\n\t\tlet next = () => {\n\t\t\tif(rsp.forward_url){\n\t\t\t\tparent.location.href = rsp.forward_url;\n\t\t\t}else{\n\t\t\t\tparent.location.reload();\n\t\t\t}\n\t\t}\n\t\tif(rsp.message){\n\t\t\tlet tm = Toast.DEFAULT_TIME_MAP[Toast.TYPE_SUCCESS];\n\t\t\tToast.showToast(rsp.message, Toast.TYPE_SUCCESS, tm);\n\t\t\tsetTimeout(next, Math.max(tm - 500, 0));\n\t\t}else{\n\t\t\tnext();\n\t\t}\n\t};\n\n\tstatic active(node, param = {}, event = null){\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif(node.getAttribute(SUBMITTING_FLAG)){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet url, data, method,\n\t\t\t\tonsuccess = ACAsync.COMMON_SUCCESS_RESPONSE_HANDLE,\n\t\t\t\tsubmitter = null;\n\n\t\t\tif(param.onsuccess){\n\t\t\t\tif(typeof (param.onsuccess) === 'string'){\n\t\t\t\t\tonsuccess = window[param.onsuccess];\n\t\t\t\t}else{\n\t\t\t\t\tonsuccess = param.onsuccess;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(node.tagName === 'FORM'){\n\t\t\t\turl = fixFormAction(node, event);\n\t\t\t\tsubmitter = event.submitter;\n\t\t\t\tdata = ACAsync.REQUEST_FORMAT === REQUEST_FORMAT.JSON ? formSerializeJSON(node) : formSerializeString(node);\n\t\t\t\tmethod = node.method.toLowerCase() === 'post' ? 'post' : 'get';\n\t\t\t}else if(node.tagName === 'A'){\n\t\t\t\turl = node.href;\n\t\t\t\tmethod = 'get';\n\t\t\t}\n\n\t\t\t//优先使用参数传参\n\t\t\turl = param.url || url;\n\t\t\tmethod = param.method || method || 'get';\n\t\t\tdata = param.data || data;\n\n\t\t\tlet loader = Toast.showLoadingLater('正在请求中，请稍候···');\n\t\t\tnode.setAttribute(SUBMITTING_FLAG, '1');\n\t\t\tsubmitter && submitter.setAttribute(SUBMITTING_FLAG, '1');\n\t\t\trequestJSON(url, data, method, {requestFormat: ACAsync.REQUEST_FORMAT}).then(rsp => {\n\t\t\t\tif(rsp.code === 0){\n\t\t\t\t\tonsuccess(rsp);\n\t\t\t\t\tresolve();\n\t\t\t\t}else{\n\t\t\t\t\tconsole.error('Request Error:', url, data, method, rsp);\n\t\t\t\t\tToast.showError(rsp.message || '系统错误');\n\t\t\t\t\treject(`系统错误(${rsp.message})`);\n\t\t\t\t}\n\t\t\t}, err => {\n\t\t\t\tToast.showError(err);\n\t\t\t\treject(err);\n\t\t\t}).finally(() => {\n\t\t\t\tnode.removeAttribute(SUBMITTING_FLAG);\n\t\t\t\tsubmitter && submitter.removeAttribute(SUBMITTING_FLAG);\n\t\t\t\tloader && loader.hide();\n\t\t\t})\n\t\t})\n\t}\n}\n","import {createDomByHtml, getContextWindow, insertStyleSheet, remove} from \"../Lang/Dom.js\";\nimport {bindNodeActive, BizEvent, KEYS} from \"../Lang/Event.js\";\nimport {Theme} from \"./Theme.js\";\nimport {guid} from \"../Lang/Util.js\";\nimport {dimension2Style, escapeAttr} from \"../Lang/Html.js\";\n\nconst COM_ID = Theme.Namespace + 'dialog';\nconst DLG_CLS_PREF = COM_ID;\nconst DLG_CLS_TI = DLG_CLS_PREF + '-ti';\nconst DLG_CLS_CTN = DLG_CLS_PREF + '-ctn';\nconst DLG_CLS_OP = DLG_CLS_PREF + '-op';\nconst DLG_CLS_TOP_CLOSE = DLG_CLS_PREF + '-close';\nexport const DLG_CLS_BTN = DLG_CLS_PREF + '-btn';\nexport const DLG_CLS_WEAK_BTN = DLG_CLS_PREF + '-weak-btn';\n\nconst IFRAME_ID_ATTR_FLAG = 'data-dialog-flag';\n\nconst STATE_ACTIVE = 'active'; //激活状态。如果是存在模态对话框，只允许唯一一个激活，如果没有模态对话框情况，允许多个同时激活\nconst STATE_DISABLED = 'disabled'; //禁用状态。存在模态框情况下，全局只允许唯一一个激活，其余均为禁用状态\nconst STATE_HIDDEN = 'hidden'; //隐藏状态。通过主动调用hide方法使得对话框隐藏\n\nconst DIALOG_TYPE_ATTR_KEY = 'data-dialog-type';\nconst TYPE_NORMAL = 'normal';\nconst TYPE_PROMPT = 'prompt';\nconst TYPE_CONFIRM = 'confirm'; //提示对话框（包含【告警】【确认】）\n\n/**\n * Content Type\n * @type {string}\n */\nconst DLG_CTN_TYPE_IFRAME = DLG_CLS_PREF + '-ctn-iframe';\nconst DLG_CTN_TYPE_HTML = DLG_CLS_PREF + '-ctn-html';\n\ninsertStyleSheet(`\n\t.${DLG_CLS_PREF} {border:none; margin:auto !important; padding:0 !important; /** 原生浏览器有1em内边距 **/ border-radius:var(${Theme.CssVar.PANEL_RADIUS}); overflow:auto; min-width:1em; box-sizing:border-box; background-color:var(${Theme.CssVar.BACKGROUND_COLOR}); color:var(${Theme.CssVar.COLOR});}\n\t.${DLG_CLS_PREF} {position:fixed;inset-block-start: 0px;inset-block-end: 0px;}\n\t.${DLG_CLS_PREF}:focus {outline:none}\n\t.${DLG_CLS_PREF}[data-transparent] {background-color:transparent !important; box-shadow:none !important}\n\t.${DLG_CLS_PREF} .${DLG_CLS_PREF}-ti {user-select:none; box-sizing:border-box; line-height:1; padding:0.75em 2.5em 0.75em 0.75em; font-weight:normal;color:var(${Theme.CssVar.CSS_LIGHTEN})}\n\t.${DLG_CLS_PREF} .${DLG_CLS_TOP_CLOSE} {position:absolute; display:flex; align-items:center; line-height:1; width:2.25em; height:2.5em; overflow:hidden; opacity:0.6; cursor:pointer; right:0; top:0;box-sizing:border-box; text-align:center;}\n\t.${DLG_CLS_PREF} .${DLG_CLS_TOP_CLOSE}:after {content:\"\\\\e61a\"; font-size:0.9em; font-family:${Theme.IconFont}; line-height:1; display:block; flex:1}\n\t.${DLG_CLS_PREF} .${DLG_CLS_TOP_CLOSE}:hover {opacity:1;}\n\t.${DLG_CLS_PREF} .${DLG_CLS_CTN} {overflow-y:auto; max-height:calc(100vh - 6em)}\n\t.${DLG_CLS_PREF} .${DLG_CLS_CTN}:focus {outline:none !important;}\n\t.${DLG_CLS_PREF} .${DLG_CLS_OP} {padding:.75em; text-align:right;}\n\t.${DLG_CLS_PREF} .${DLG_CLS_BTN}:first-child {margin-left:0;}\n\t.${DLG_CLS_PREF} .${DLG_CLS_BTN} {margin-left:0.5em;}\n\t.${DLG_CLS_PREF}.full-dialog .${DLG_CLS_CTN} {max-height:calc(100vh - 100px); overflow-y:auto}\n\t.${DLG_CLS_PREF}[data-dialog-state=\"${STATE_ACTIVE}\"] {box-shadow:1px 1px 60px 1px #44444457}\n\t.${DLG_CLS_PREF}[data-dialog-state=\"${STATE_ACTIVE}\"] .dialog-ti {color:#333}\n\t.${DLG_CLS_PREF}[data-dialog-state=\"${STATE_DISABLED}\"]:before {content:\"\"; left:0; top:0; position:absolute; width:100%; height:100%;}\n\t.${DLG_CLS_PREF}[data-dialog-state=\"${STATE_DISABLED}\"] * {opacity:0.85 !important; user-select:none;}\n\t\n\t.${DLG_CLS_PREF}[${DIALOG_TYPE_ATTR_KEY}=\"${TYPE_CONFIRM}\"] .${DLG_CLS_CTN} {padding:1.5em 1.5em 1em 1.5em; min-height:40px;}\n\t.${DLG_CLS_PREF}[${DIALOG_TYPE_ATTR_KEY}=\"${TYPE_CONFIRM}\"] .${DLG_CLS_PREF}-confirm-ti {font-size:1.2em; margin-bottom:.75em;}\n\t.${DLG_CLS_PREF}[${DIALOG_TYPE_ATTR_KEY}=\"${TYPE_PROMPT}\"] .${DLG_CLS_CTN} {padding:2em 2em 1em 2em}\n\t.${DLG_CLS_PREF}[${DIALOG_TYPE_ATTR_KEY}=\"${TYPE_PROMPT}\"] .${DLG_CLS_CTN} label {font-size:1.1em; margin-bottom:.75em; display:block;}\n\t.${DLG_CLS_PREF}[${DIALOG_TYPE_ATTR_KEY}=\"${TYPE_PROMPT}\"] .${DLG_CLS_CTN} input[type=text] {width:100%; box-sizing:border-box;}\n\t\n\t.${DLG_CLS_PREF} .${DLG_CLS_CTN}-iframe {padding:0 !important}\n\t.${DLG_CLS_PREF} .${DLG_CLS_CTN}-iframe iframe {width:100%; border:none; display:block; min-height:30px;}\n\t.${DLG_CLS_PREF}::backdrop {backdrop-filter:brightness(0.65)}\n`, COM_ID + '-style');\n\n/**\n * 绑定ESC按键事件关闭最上一层可关闭的对话框\n */\ndocument.addEventListener('keydown', e => {\n\tif(e.keyCode === KEYS.Esc){\n\t\tlet current = DialogManager.getFrontDialog();\n\t\tif(current && current.config.showTopCloseButton){\n\t\t\tDialogManager.close(current);\n\t\t\te.stopImmediatePropagation();\n\t\t}\n\t}\n});\n\n/** @var Dialog[] **/\nlet DIALOG_COLLECTION = [];\n\n/**\n * 对话框层级比较函数（层级高的排上面）\n * @param {Dialog} dialog1\n * @param {Dialog} dialog2\n * @return {number}\n */\nconst sortZIndex = (dialog1, dialog2) => {\n\treturn dialog1.zIndex - dialog2.zIndex;\n}\n\n/**\n * 获取非隐藏的模态对话框列表\n * 顺序由底到上排列\n * @param {Dialog|null} excludedDialog 排除在外的对话框\n * @return {Dialog[]}\n */\nconst getModalDialogs = (excludedDialog = null) => {\n\tlet list = DIALOG_COLLECTION.filter(d => {\n\t\treturn d.state !== STATE_HIDDEN && d.config.modal && (!excludedDialog || d !== excludedDialog);\n\t});\n\treturn list.sort(sortZIndex);\n};\n\n/**\n * 获取非隐藏的普通对话框列表\n * 顺序由底到上排列\n * @param {Dialog|null} excludedDialog 排除在外的对话框\n * @return {Dialog[]}\n */\nconst getNoModalDialogs = (excludedDialog = null) => {\n\tlet list = DIALOG_COLLECTION.filter(d => {\n\t\treturn d.state !== STATE_HIDDEN && !d.config.modal && (!excludedDialog || d !== excludedDialog);\n\t});\n\treturn list.sort(sortZIndex);\n};\n\n/**\n * 获取所有非隐藏对话框\n * 顺序由底到上排列\n * @param {Dialog|null} excludedDialog 排除在外的对话框\n * @return {*[]}\n */\nconst getAllAvailableDialogs = (excludedDialog = null) => {\n\tlet modalDialogs = getModalDialogs(excludedDialog);\n\tlet noModalDialogs = getNoModalDialogs(excludedDialog);\n\treturn noModalDialogs.concat(modalDialogs);\n}\n\n/**\n * 设置对话框状态\n * @param {Dialog} dlg\n * @param {String} toState\n */\nconst setState = (dlg, toState) => {\n\tdlg.state = toState;\n\tdlg.dom.setAttribute('data-dialog-state', toState);\n\tdlg.dom[toState === STATE_HIDDEN ? 'hide' : (dlg.config.modal ? 'showModal' : 'show')]();\n}\n\n/**\n * 设置对话框zIndex\n * @param {Dialog} dlg\n * @param {Number|String} zIndex\n */\nconst setZIndex = (dlg, zIndex) => {\n\tdlg.zIndex = dlg.dom.style.zIndex = String(zIndex);\n}\n\nconst setType = (dlg, type) => {\n\tdlg.dom.setAttribute('data-dialog-type', type);\n}\n\n/**\n * 对话框管理器\n */\nconst DialogManager = {\n\tregister(dlg){\n\t\tDIALOG_COLLECTION.push(dlg)\n\t},\n\n\t/**\n\t * 激活并显示对话框\n\t * @param {Dialog} dlg\n\t */\n\tshow(dlg){\n\t\tdlg.state = STATE_DISABLED; //避免 getModal* 获取不到当前对话框\n\n\t\tlet modalDialogs = getModalDialogs(dlg);\n\t\tlet noModalDialogs = getNoModalDialogs(dlg);\n\t\tif(dlg.config.modal){\n\t\t\tnoModalDialogs.forEach(d => {\n\t\t\t\tsetState(d, STATE_DISABLED);\n\t\t\t});\n\t\t\tmodalDialogs.forEach(d => {\n\t\t\t\tsetState(d, STATE_DISABLED);\n\t\t\t});\n\t\t\tsetZIndex(dlg, Dialog.DIALOG_INIT_Z_INDEX + noModalDialogs.length + modalDialogs.length);\n\t\t\tsetState(dlg, STATE_ACTIVE);\n\t\t}else{\n\t\t\tmodalDialogs.forEach((d, idx) => {\n\t\t\t\tsetZIndex(d, dlg.zIndex + idx + 1);\n\t\t\t});\n\t\t\tsetZIndex(dlg, Dialog.DIALOG_INIT_Z_INDEX + noModalDialogs.length);\n\t\t\tsetState(dlg, modalDialogs.length ? STATE_DISABLED : STATE_ACTIVE);\n\t\t}\n\t\tdlg.onShow.fire();\n\t},\n\n\t/**\n\t * 关闭对话框\n\t * @param {Dialog} dlg\n\t * @param {Boolean} destroy 是否摧毁\n\t */\n\tclose: (dlg, destroy = true) => {\n\t\tif(dlg.onClose.fire() === false){\n\t\t\tconsole.warn('dialog close cancel by onClose events');\n\t\t\treturn false;\n\t\t}\n\t\tlet modalDialogs = getModalDialogs(dlg);\n\t\tlet noModalDialogs = getNoModalDialogs(dlg);\n\t\tmodalDialogs.forEach((d, idx) => {\n\t\t\tsetZIndex(d, Dialog.DIALOG_INIT_Z_INDEX + noModalDialogs.length + idx);\n\t\t});\n\t\t//active last modal dialog\n\t\tif(modalDialogs.length){\n\t\t\tsetState(modalDialogs[modalDialogs.length - 1], STATE_ACTIVE);\n\t\t}\n\t\tnoModalDialogs.forEach((d, idx) => {\n\t\t\tsetZIndex(d, Dialog.DIALOG_INIT_Z_INDEX + idx);\n\t\t\tsetState(d, modalDialogs.length ? STATE_DISABLED : STATE_ACTIVE);\n\t\t});\n\t\tif(destroy){\n\t\t\tDIALOG_COLLECTION = DIALOG_COLLECTION.filter(d => d !== dlg);\n\t\t\tremove(dlg.dom);\n\t\t}else{\n\t\t\tsetState(dlg, STATE_HIDDEN);\n\t\t}\n\t\tgetAllAvailableDialogs().length || dlg.dom.classList.remove(`${DLG_CLS_PREF}-masker`);\n\t},\n\n\t/**\n\t * 隐藏对话框\n\t * @param dlg\n\t * @returns {boolean}\n\t */\n\thide(dlg){\n\t\treturn this.close(dlg, false);\n\t},\n\n\t/**\n\t * 获取当前激活的对话框\n\t * @returns {Dialog|null}\n\t */\n\tgetFrontDialog(){\n\t\tlet dialogs = getAllAvailableDialogs();\n\t\treturn dialogs[dialogs.length - 1];\n\t},\n\n\t/**\n\t * 尝试设置指定窗口前置\n\t * @param {Dialog} dlg\n\t * @return {boolean}\n\t */\n\ttrySetFront(dlg){\n\t\tlet modalDialogs = getModalDialogs();\n\t\tlet currentFrontDialog = this.getFrontDialog();\n\n\t\tif(currentFrontDialog === dlg){\n\t\t\treturn true;\n\t\t}\n\n\t\t//模态模式下，不允许通过该方法切换对话框，\n\t\t//只有在对话框 show、hide的情况下自动调整层级\n\t\tif(modalDialogs.length){\n\t\t\treturn false;\n\t\t}\n\n\t\tlet otherNoModalDialogs = getNoModalDialogs(dlg);\n\t\totherNoModalDialogs.forEach((d, idx) => {\n\t\t\tsetZIndex(d, Dialog.DIALOG_INIT_Z_INDEX + idx);\n\t\t});\n\t\tsetZIndex(dlg, Dialog.DIALOG_INIT_Z_INDEX + otherNoModalDialogs.length);\n\t},\n\n\t/**\n\t * 关闭全部对话框\n\t */\n\tcloseAll(){\n\t\tDIALOG_COLLECTION.forEach(dlg => {\n\t\t\tremove(dlg.dom);\n\t\t});\n\t\tDIALOG_COLLECTION = [];\n\t},\n\n\t/**\n\t * 根据ID查找对话框\n\t * @param id\n\t * @returns {Dialog}\n\t */\n\tfindById(id){\n\t\treturn DIALOG_COLLECTION.find(dlg => {\n\t\t\treturn dlg.id === id\n\t\t});\n\t}\n};\n\nconst resolveContentType = (content) => {\n\tif(typeof (content) === 'object' && content.src){\n\t\treturn DLG_CTN_TYPE_IFRAME;\n\t}\n\treturn DLG_CTN_TYPE_HTML;\n}\n\n/**\n * 自动调整iframe高度\n * @param iframe\n */\nconst autoResizeIframeHeight = (iframe)=>{\n\tlet obs;\n\ttry{\n\t\tlet upd = () => {\n\t\t\tlet bdy = iframe.contentWindow.document.body;\n\t\t\tif(bdy){\n\t\t\t\tiframe.style.height = dimension2Style(bdy.scrollHeight || bdy.clientHeight || bdy.offsetHeight);\n\t\t\t}\n\t\t}\n\t\tiframe.addEventListener('load', () => {\n\t\t\tobs = new MutationObserver(upd);\n\t\t\tobs.observe(iframe.contentWindow.document.body, {attributes: true, subtree: true, childList: true});\n\t\t\tupd();\n\t\t});\n\t}catch(err){\n\t\ttry{\n\t\t\tobs && obs.disconnect();\n\t\t}catch(err){\n\t\t\tconsole.error('observer disconnect fail', err)\n\t\t}\n\t\tconsole.warn('iframe content upd', err);\n\t}\n}\n\n/**\n * 构造DOM结构\n * @param {Dialog} dlg\n */\nconst domConstruct = (dlg) => {\n\tlet html = `\n\t\t<dialog class=\"${DLG_CLS_PREF}\" \n\t\t\tid=\"${dlg.id}\" \n\t\t\tdata-dialog-type=\"${TYPE_NORMAL}\"\n\t\t\t${dlg.config.transparent ? 'data-transparent':''}\n\t\t\t${dlg.state === STATE_HIDDEN ? '' : 'open'} \n\t\t\tstyle=\"${dlg.config.width ? 'width:' + dimension2Style(dlg.config.width) : ''}\">\n\t\t${dlg.config.title ? `<div class=\"${DLG_CLS_TI}\">${dlg.config.title}</div>` : ''}\n\t`;\n\thtml += `<div class=\"${DLG_CLS_CTN} ${resolveContentType(dlg.config.content)}\" \n\t\t\tstyle=\"min-height: ${dimension2Style(Dialog.CONTENT_MIN_HEIGHT)}; ${dlg.config.height ? 'height:'+dimension2Style(dlg.config.height)+';':''}\" \n\t\t\ttabindex=\"0\">${renderContent(dlg)}</div>`;\n\tif(dlg.config.buttons.length){\n\t\thtml += `<div class=\"${DLG_CLS_OP}\">`;\n\t\tdlg.config.buttons.forEach(button => {\n\t\t\t//autofocus 在部分浏览器场景可能会失效，这里采用js主动切换\n\t\t\thtml += `<input type=\"button\" class=\"${DLG_CLS_BTN} ${button.className||''}\" ${button.default ? 'autofocus' : ''} tabindex=\"0\" value=\"${escapeAttr(button.title)}\">`;\n\t\t});\n\t\thtml += '</div>';\n\t}\n\thtml += dlg.config.showTopCloseButton ? `<span class=\"${DLG_CLS_TOP_CLOSE}\" title=\"关闭\" tabindex=\"0\"></span>` : '';\n\thtml += `</dialog>`;\n\tdlg.dom = createDomByHtml(html, document.body);\n\n\t//bind iframe content\n\tif(resolveContentType(dlg.config.content) === DLG_CTN_TYPE_IFRAME){\n\t\tlet iframe = dlg.dom.querySelector('iframe');\n\t\tautoResizeIframeHeight(iframe);\n\t}\n};\n\n/**\n * 事件绑定\n * @param {Dialog} dlg\n */\nconst eventBind = (dlg) => {\n\t//bind dialog active\n\tdlg.dom.addEventListener('mousedown', () => {\n\t\tdlg.state === STATE_ACTIVE && DialogManager.trySetFront(dlg);\n\t});\n\n\t//阻止原生modal对话框，ESC关闭对话框\n\tdlg.dom.addEventListener('cancel', e=>{\n\t\te.preventDefault();\n\t});\n\n\t//bind buttons event\n\tfor(let i in dlg.config.buttons){\n\t\tlet cb = dlg.config.buttons[i].callback || dlg.close;\n\t\tlet btn = dlg.dom.querySelectorAll(`.${DLG_CLS_OP} .${DLG_CLS_BTN}`)[i];\n\t\tbtn.addEventListener('click', cb.bind(dlg), false);\n\t}\n\n\t//bind top close button event\n\tif(dlg.config.showTopCloseButton){\n\t\tlet close_btn = dlg.dom.querySelector(`.${DLG_CLS_TOP_CLOSE}`);\n\t\tbindNodeActive(close_btn, dlg.close.bind(dlg));\n\t}\n}\n\n/**\n * 渲染内容区域\n * @param {Dialog} dlg\n * @returns {string}\n */\nconst renderContent = (dlg) => {\n\tswitch(resolveContentType(dlg.config.content)){\n\t\tcase DLG_CTN_TYPE_IFRAME:\n\t\t\treturn `<iframe src=\"${dlg.config.content.src}\" ${IFRAME_ID_ATTR_FLAG}=\"${dlg.id}\"></iframe>`;\n\n\t\tcase DLG_CTN_TYPE_HTML:\n\t\t\treturn dlg.config.content;\n\n\t\tdefault:\n\t\t\tconsole.error('Content type error', dlg.config.content);\n\t\t\tthrow 'Content type error';\n\t}\n};\n\nconst CUSTOM_EVENT_BUCKS = {\n\t/** id: {event: []} **/\n};\n\nclass Dialog {\n\tstatic CONTENT_MIN_HEIGHT = 30; //最小高度\n\tstatic DEFAULT_WIDTH = 500; //默认宽度\n\tstatic DIALOG_INIT_Z_INDEX = Theme.DialogIndex;\n\n\t//对话框ID，缺省为自动生成\n\tid = null;\n\n\t/** @var {HTMLElement} dom **/\n\tdom = null;\n\n\tstate = STATE_HIDDEN;\n\tzIndex = Theme.DialogIndex;\n\n\tonClose = new BizEvent(true);\n\tonShow = new BizEvent(true);\n\n\tconfig = {\n\t\ttitle: '', //对话框标题，为 null 或者空字符串时不显示标题行\n\t\tcontent: '',\n\t\tmodal: true, //是否为模态窗口\n\t\ttransparent:false, //是否透明\n\t\twidth: Dialog.DEFAULT_WIDTH,\n\t\theight: null, //高度，缺省为自动高度\n\t\tbuttons: [/** {title:'', default:true, callback }**/], //对话框配置按钮列表\n\t\tshowTopCloseButton: true, //是否显示顶部关闭窗口\n\t};\n\n\t/**\n\t * @param {Object} config\n\t * @param {String|Null} config.id 为对话框指定ID\n\t * @param {String} config.title 对话框标题\n\t * @param {String} config.content 对话框内容，允许提交 {src:\"http://\"} 格式，渲染为iframe\n\t * @param {Boolean} config.modal 是否为模态对话框\n\t * @param {Boolean} config.transparent 是否透明\n\t * @param {Number} config.width 宽度\n\t * @param {Number} config.height 高度（指内容区高度，不包含标题栏）\n\t * @param {Array} config.buttons 按钮列表\n\t * @param {Boolean} config.buttons.default 单个按钮对象中是否作为默认按钮（默认聚焦）\n\t * @param {String} config.buttons.title 按钮标题\n\t * @param {Function} config.buttons.callback 按钮点击后回调，缺省为关闭对话框\n\t * @param {Boolean} config.showTopCloseButton 是否显示对话框右上角关闭按钮，如果显示按钮则支持ESC关闭对话框\n\t */\n\tconstructor(config = {}){\n\t\tthis.config = Object.assign(this.config, config);\n\t\tthis.id = this.id || 'dialog-' + Math.random();\n\t\tdomConstruct(this);\n\t\teventBind(this);\n\t\tDialogManager.register(this);\n\t}\n\n\tshow(){\n\t\tDialogManager.show(this);\n\t}\n\n\thide(){\n\t\tDialogManager.hide(this);\n\t}\n\n\tclose(){\n\t\tDialogManager.close(this);\n\t}\n\n\t/**\n\t * 触发自定义事件\n\t * @param {String} event\n\t * @param {*} args\n\t * @return {boolean} 是否存在自定义事件\n\t */\n\tfireCustomEvent(event, ...args){\n\t\tif(CUSTOM_EVENT_BUCKS[this.id] && CUSTOM_EVENT_BUCKS[this.id][event]){\n\t\t\tCUSTOM_EVENT_BUCKS[this.id][event].fire(...args);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * 监听自定义事件\n\t * @param {String} event\n\t * @param {Function} callback\n\t */\n\tlistenCustomEvent(event, callback){\n\t\tif(CUSTOM_EVENT_BUCKS[this.id] === undefined){\n\t\t\tCUSTOM_EVENT_BUCKS[this.id] = {};\n\t\t}\n\t\tif(CUSTOM_EVENT_BUCKS[this.id][event] === undefined){\n\t\t\tCUSTOM_EVENT_BUCKS[this.id][event] = new BizEvent();\n\t\t}\n\t\tCUSTOM_EVENT_BUCKS[this.id][event].listen(callback);\n\t}\n\n\t/**\n\t * 显示对话框\n\t * @param {String} title\n\t * @param {Object|String} content\n\t * @param {Object} config\n\t * @param {String|Null} config.id\n\t * @param {Boolean} config.modal\n\t * @param {Boolean} config.transparent\n\t * @param {Number} config.width\n\t * @param {Number} config.height\n\t * @param {Array} config.buttons\n\t * @param {Boolean} config.buttons.default\n\t * @param {String} config.buttons.title\n\t * @param {Function} config.buttons.callback\n\t * @param {Boolean} config.showTopCloseButton\n\t * @returns {Dialog}\n\t */\n\tstatic show(title, content, config){\n\t\tlet p = new Dialog({title, content, ...config});\n\t\tp.show();\n\t\treturn p;\n\t}\n\n\t/**\n\t * 确认框\n\t * @param {String} title\n\t * @param {String} content\n\t * @param {Object} opt\n\t * @returns {Promise<unknown>}\n\t */\n\tstatic confirm(title, content, opt = {}){\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet p = new Dialog({\n\t\t\t\tcontent: `<div class=\"${DLG_CLS_PREF}-confirm-ti\">${title}</div>\n\t\t\t\t\t\t<div class=\"${DLG_CLS_PREF}-confirm-ctn\">${content}</div>`,\n\t\t\t\tbuttons: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: '确定', default: true, callback: () => {\n\t\t\t\t\t\t\tp.close();\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: '取消', className: DLG_CLS_WEAK_BTN, callback: () => {\n\t\t\t\t\t\t\tp.close();\n\t\t\t\t\t\t\treject && reject()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\twidth: 420,\n\t\t\t\tmodal: true,\n\t\t\t\tshowTopCloseButton: false,\n\t\t\t\t...opt\n\t\t\t});\n\t\t\tsetType(p, TYPE_CONFIRM);\n\t\t\tp.show();\n\t\t});\n\t}\n\n\t/**\n\t * 提示框\n\t * @param {String} title\n\t * @param {String} content\n\t * @param {Object} opt\n\t * @returns {Promise<unknown>}\n\t */\n\tstatic alert(title, content, opt = {}){\n\t\treturn new Promise(resolve => {\n\t\t\tlet p = new Dialog({\n\t\t\t\tcontent:`<div class=\"${DLG_CLS_PREF}-confirm-ti\">${title}</div>\n\t\t\t\t\t\t<div class=\"${DLG_CLS_PREF}-confirm-ctn\">${content}</div>`,\n\t\t\t\tbuttons: [{\n\t\t\t\t\ttitle: '确定', default: true, callback: () => {\n\t\t\t\t\t\tp.close();\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}\n\t\t\t\t},],\n\t\t\t\twidth:420,\n\t\t\t\tmodal: true,\n\t\t\t\tshowTopCloseButton: false,\n\t\t\t\t...opt\n\t\t\t});\n\t\t\tsetType(p, TYPE_CONFIRM);\n\t\t\tp.show();\n\t\t});\n\t}\n\n\t/**\n\t * 显示 iframe 类型对话框\n\t * @param title\n\t * @param iframeSrc\n\t * @param opt\n\t * @returns {Dialog}\n\t */\n\tstatic iframe(title = null, iframeSrc, opt = {}){\n\t\treturn Dialog.show(title, {src: iframeSrc}, opt);\n\t}\n\n\t/**\n\t * 输入提示框\n\t * @param {String} title\n\t * @param {Object} option\n\t * @param {String} option.initValue\n\t * @returns {Promise<unknown>}\n\t */\n\tstatic prompt(title, option = {initValue: \"\"}){\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet input_id = guid(Theme.Namespace + '-prompt-input');\n\t\t\tlet input = null;\n\t\t\tlet p = new Dialog({\n\t\t\t\tcontent: `<label for=\"${input_id}\">${title}</label><input type=\"text\" id=\"${input_id}\" value=\"${escapeAttr(option.initValue || '')}\"/>`,\n\t\t\t\tbuttons: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: '确定', default: true, callback: () => {\n\t\t\t\t\t\t\tif(resolve(input.value) === false){\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tp.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{title: '取消',className: DLG_CLS_WEAK_BTN}\n\t\t\t\t],\n\t\t\t\twidth:400,\n\t\t\t\tmodal: true,\n\t\t\t\tshowTopCloseButton: true,\n\t\t\t\t...option\n\t\t\t});\n\t\t\tinput = p.dom.querySelector('input[type=text]');\n\t\t\tsetType(p, TYPE_PROMPT);\n\t\t\tp.onClose.listen(reject);\n\t\t\tp.onShow.listen(() => {\n\t\t\t\tinput.focus();\n\t\t\t\tinput.addEventListener('keydown', e => {\n\t\t\t\t\tif(e.keyCode === KEYS.Enter){\n\t\t\t\t\t\tif(resolve(input.value) === false){\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tp.close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t})\n\t\t\tp.show();\n\t\t});\n\t}\n}\n\n/**\n * 获取当前页面（iframe）所在的对话框\n * @returns {Promise}\n */\nexport const getCurrentFrameDialog = () => {\n\treturn new Promise((resolve, reject) => {\n\t\tif(!window.parent || !window.frameElement){\n\t\t\treject('no in iframe');\n\t\t\treturn;\n\t\t}\n\t\tif(!parent[COM_ID].DialogManager){\n\t\t\treject('No dialog manager found.');\n\t\t\treturn;\n\t\t}\n\t\tlet id = window.frameElement.getAttribute(IFRAME_ID_ATTR_FLAG);\n\t\tif(!id){\n\t\t\treject(\"ID no found in iframe element\");\n\t\t}\n\t\tlet dlg = parent[COM_ID].DialogManager.findById(id);\n\t\tif(dlg){\n\t\t\tresolve(dlg);\n\t\t}else{\n\t\t\treject('no dlg find:' + id);\n\t\t}\n\t});\n}\n\nif(!window[COM_ID]){\n\twindow[COM_ID] = {};\n}\n\nwindow[COM_ID].Dialog = Dialog;\nwindow[COM_ID].DialogManager = DialogManager;\n\nlet CONTEXT_WINDOW = getContextWindow();\nlet DialogClass = CONTEXT_WINDOW[COM_ID].Dialog || Dialog;\nlet DialogManagerClass = CONTEXT_WINDOW[COM_ID].DialogManager || DialogManager;\n\nexport {DialogClass as Dialog, DialogManagerClass as DialogManager};","import {Dialog} from \"../Widget/Dialog.js\";\nimport {cutString} from \"../Lang/String.js\";\n\n/**\n * 对话框组件\n * 参数：\n * node[data-dialog-url] iframe对话框页面地址\n * node[data-content] 对话框内容\n * a[title] | node[text] 对话框标题\n */\nexport class ACDialog {\n\tstatic active(node, param = {}){\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet title, url, content;\n\n\t\t\tif(node.tagName === 'A'){\n\t\t\t\turl = node.href || url;\n\t\t\t\ttitle = node.title || title;\n\t\t\t}\n\t\t\tif(node.innerText){\n\t\t\t\ttitle = cutString(node.innerText, 30);\n\t\t\t}\n\n\t\t\ttitle = param.title || title;\n\t\t\turl = param.url || url;\n\t\t\tcontent = param.content || content;\n\t\t\tif(url){\n\t\t\t\tcontent = {src: url};\n\t\t\t}\n\t\t\tDialog.show(title || '对话框', content, param);\n\t\t\tresolve();\n\t\t})\n\t}\n}\n","import {Dialog} from \"../Widget/Dialog.js\";\n\n/**\n * 确认对话框\n * 参数：\n * node[data-confirm-title] 标题，缺省为”确认“\n * node[data-confirm-message] 内容\n */\nexport class ACConfirm {\n\tstatic active(node, param = {}){\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet title = param.title;\n\t\t\tlet message = param.message;\n\t\t\tDialog.confirm(title || '确认', message).then(resolve, reject);\n\t\t});\n\t}\n}\n","import {\r\n\tcreateDomByHtml,\r\n\tdomContained,\r\n\tgetDomOffset,\r\n\tgetRegion,\r\n\thide,\r\n\tinsertStyleSheet,\r\n\trectInLayout,\r\n\tremove,\r\n\tshow\r\n} from \"../Lang/Dom.js\";\r\nimport {guid} from \"../Lang/Util.js\";\r\nimport {BizEvent, KEYS} from \"../Lang/Event.js\";\r\nimport {Theme} from \"./Theme.js\";\r\nimport {dimension2Style} from \"../Lang/Html.js\";\r\n\r\nconst GUID_BIND_KEY = Theme.Namespace+'-tip-guid';\r\nconst NS = Theme.Namespace + 'tip';\r\nconst DEFAULT_DIR = 11;\r\nconst TRY_DIR_MAP = [11, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10];\r\nlet TIP_COLLECTION = {};\r\n\r\ninsertStyleSheet(`\r\n\t.${NS}-container-wrap {position:absolute; filter:drop-shadow(var(${Theme.CssVar.PANEL_SHADOW})); --tip-arrow-size:10px; --tip-gap:calc(var(--tip-arrow-size) * 0.7071067811865476); --tip-mgr:calc(var(--tip-gap) - var(--tip-arrow-size) / 2); color:var(${Theme.CssVar.COLOR}); z-index:${Theme.TipIndex};}\r\n\t.${NS}-arrow {display:block; background-color:var(${Theme.CssVar.BACKGROUND_COLOR}); clip-path:polygon(0% 0%, 100% 100%, 0% 100%); width:var(--tip-arrow-size); height:var(--tip-arrow-size); position:absolute; z-index:1}\r\n\t.${NS}-close {display:block; overflow:hidden; width:15px; height:20px; position:absolute; right:7px; top:10px; text-align:center; cursor:pointer; font-size:13px; opacity:.5}\r\n\t.${NS}-close:hover {opacity:1}\r\n\t.${NS}-content {border-radius:var(${Theme.CssVar.PANEL_RADIUS}); background-color:var(${Theme.CssVar.BACKGROUND_COLOR}); padding:1em;  max-width:30em; word-break:break-all}\r\n\t\r\n\t/** top **/\r\n\t.${NS}-container-wrap[data-tip-dir=\"11\"],\r\n\t.${NS}-container-wrap[data-tip-dir=\"0\"],\r\n\t.${NS}-container-wrap[data-tip-dir=\"1\"]{padding-top:var(--tip-gap)}\r\n\t.${NS}-container-wrap[data-tip-dir=\"11\"] .${NS}-arrow,\r\n\t.${NS}-container-wrap[data-tip-dir=\"0\"] .${NS}-arrow,\r\n\t.${NS}-container-wrap[data-tip-dir=\"1\"] .${NS}-arrow{top:var(--tip-mgr); transform:rotate(135deg);}\r\n\t.${NS}-container-wrap[data-tip-dir=\"11\"] .${NS}-arrow{left:calc(25% - var(--tip-gap));}\r\n\t.${NS}-container-wrap[data-tip-dir=\"0\"] .${NS}-arrow{left:calc(50% - var(--tip-gap));background:orange;}\r\n\t.${NS}-container-wrap[data-tip-dir=\"1\"] .${NS}-arrow{left:calc(75% - var(--tip-gap));}\r\n\t\r\n\t/** left **/\r\n\t.${NS}-container-wrap[data-tip-dir=\"8\"],\r\n\t.${NS}-container-wrap[data-tip-dir=\"9\"],\r\n\t.${NS}-container-wrap[data-tip-dir=\"10\"]{padding-left:var(--tip-gap)}\r\n\t.${NS}-container-wrap[data-tip-dir=\"8\"] .${NS}-close,\r\n\t.${NS}-container-wrap[data-tip-dir=\"9\"] .${NS}-close,\r\n\t.${NS}-container-wrap[data-tip-dir=\"10\"] .${NS}-close{top:3px;}\r\n\t.${NS}-container-wrap[data-tip-dir=\"8\"] .${NS}-arrow,\r\n\t.${NS}-container-wrap[data-tip-dir=\"9\"] .${NS}-arrow,\r\n\t.${NS}-container-wrap[data-tip-dir=\"10\"] .${NS}-arrow{left:var(--tip-mgr); transform:rotate(45deg);}\r\n\t.${NS}-container-wrap[data-tip-dir=\"8\"] .${NS}-arrow{top:calc(75% - var(--tip-gap));}\r\n\t.${NS}-container-wrap[data-tip-dir=\"9\"] .${NS}-arrow{top:calc(50% - var(--tip-gap));}\r\n\t.${NS}-container-wrap[data-tip-dir=\"10\"] .${NS}-arrow{top:calc(25% - var(--tip-gap));}\r\n\t\r\n\t/** bottom **/\r\n\t.${NS}-container-wrap[data-tip-dir=\"5\"],\r\n\t.${NS}-container-wrap[data-tip-dir=\"6\"],\r\n\t.${NS}-container-wrap[data-tip-dir=\"7\"]{padding-bottom:var(--tip-gap)}\r\n\t.${NS}-container-wrap[data-tip-dir=\"5\"] .${NS}-close,\r\n\t.${NS}-container-wrap[data-tip-dir=\"6\"] .${NS}-close,\r\n\t.${NS}-container-wrap[data-tip-dir=\"7\"] .${NS}-close{top:3px;}\r\n\t.${NS}-container-wrap[data-tip-dir=\"5\"] .${NS}-arrow,\r\n\t.${NS}-container-wrap[data-tip-dir=\"6\"] .${NS}-arrow,\r\n\t.${NS}-container-wrap[data-tip-dir=\"7\"] .${NS}-arrow{bottom:var(--tip-mgr); transform:rotate(-45deg);}\r\n\t.${NS}-container-wrap[data-tip-dir=\"5\"] .${NS}-arrow{right: calc(25% - var(--tip-gap));}\r\n\t.${NS}-container-wrap[data-tip-dir=\"6\"] .${NS}-arrow{right: calc(50% - var(--tip-gap));}\r\n\t.${NS}-container-wrap[data-tip-dir=\"7\"] .${NS}-arrow{right: calc(75% - var(--tip-gap));}\r\n\t\r\n\t/** right **/\r\n\t.${NS}-container-wrap[data-tip-dir=\"2\"],\r\n\t.${NS}-container-wrap[data-tip-dir=\"3\"],\r\n\t.${NS}-container-wrap[data-tip-dir=\"4\"]{padding-right:var(--tip-gap)}\r\n\t.${NS}-container-wrap[data-tip-dir=\"2\"] .${NS}-close,\r\n\t.${NS}-container-wrap[data-tip-dir=\"3\"] .${NS}-close,\r\n\t.${NS}-container-wrap[data-tip-dir=\"4\"] .${NS}-close{right:13px;top:3px;}\r\n\t.${NS}-container-wrap[data-tip-dir=\"2\"] .${NS}-arrow,\r\n\t.${NS}-container-wrap[data-tip-dir=\"3\"] .${NS}-arrow,\r\n\t.${NS}-container-wrap[data-tip-dir=\"4\"] .${NS}-arrow{right:var(--tip-mgr);transform: rotate(-135deg);}\r\n\t.${NS}-container-wrap[data-tip-dir=\"2\"] .${NS}-arrow{top:calc(25% - var(--tip-gap))}\r\n\t.${NS}-container-wrap[data-tip-dir=\"3\"] .${NS}-arrow{top:calc(50% - var(--tip-gap));}\r\n\t.${NS}-container-wrap[data-tip-dir=\"4\"] .${NS}-arrow{top:calc(75% - var(--tip-gap))}\r\n`, Theme.Namespace + 'tip-style');\r\n\r\n/**\r\n * 绑定事件\r\n * @param {Tip} tip\r\n */\r\nlet bindEvent = (tip)=>{\r\n\tif(tip.option.showCloseButton){\r\n\t\tlet close_btn = tip.dom.querySelector(`.${NS}-close`);\r\n\t\tclose_btn.addEventListener('click', () => {tip.hide();}, false);\r\n\t\tdocument.addEventListener('keyup', (e) => {\r\n\t\t\tif(e.keyCode === KEYS.Esc){\r\n\t\t\t\ttip.hide();\r\n\t\t\t}\r\n\t\t}, false);\r\n\t}\r\n};\r\n\r\n/**\r\n * 自动计算方位\r\n * @param {Tip} tipObj\r\n * @returns {number}\r\n */\r\nlet calDir = (tipObj)=>{\r\n\tlet tipWidth = tipObj.dom.offsetWidth;\r\n\tlet tipHeight = tipObj.dom.offsetHeight;\r\n\tlet relateNodeHeight = tipObj.relateNode.offsetHeight;\r\n\tlet relateNodeWidth = tipObj.relateNode.offsetWidth;\r\n\tlet relateNodeOffset = getDomOffset(tipObj.relateNode);\r\n\r\n\tlet viewRegion = getRegion();\r\n\r\n\tfor(let i = 0; i < TRY_DIR_MAP.length; i++){\r\n\t\tlet [offsetLeft, offsetTop] = calcTipPositionByDir(TRY_DIR_MAP[i], tipWidth, tipHeight, relateNodeHeight, relateNodeWidth);\r\n\t\tlet rect = {\r\n\t\t\tleft: relateNodeOffset.left + offsetLeft,\r\n\t\t\ttop: relateNodeOffset.top + offsetTop,\r\n\t\t\twidth: tipWidth,\r\n\t\t\theight: tipHeight\r\n\t\t};\r\n\t\tlet layout_rect = {\r\n\t\t\tleft: document.body.scrollLeft,\r\n\t\t\ttop: document.body.scrollTop,\r\n\t\t\twidth: viewRegion.visibleWidth,\r\n\t\t\theight: viewRegion.visibleHeight\r\n\t\t};\r\n\t\tif(rectInLayout(rect, layout_rect)){\r\n\t\t\treturn TRY_DIR_MAP[i];\r\n\t\t}\r\n\t}\r\n\treturn DEFAULT_DIR;\r\n};\r\n\r\n/**\r\n * 根据给定方位，计算出 tip 面板相对于关联节点的左上角的偏移信息\r\n * @param {Number} dir\r\n * @param {Number} tipWidth\r\n * @param {Number} tipHeight\r\n * @param {Number} relateNodeHeight\r\n * @param {Number} relateNodeWidth\r\n * @returns {[Number, Number]} offsetLeft offsetTop\r\n */\r\nlet calcTipPositionByDir = function(dir, tipWidth, tipHeight, relateNodeHeight, relateNodeWidth){\r\n\tlet offset = {\r\n\t\t11: [-tipWidth * 0.25 + relateNodeWidth / 2, relateNodeHeight],\r\n\t\t0: [-tipWidth * 0.5 + relateNodeWidth / 2, relateNodeHeight],\r\n\t\t1: [-tipWidth * 0.75 + relateNodeWidth / 2, relateNodeHeight],\r\n\t\t2: [-tipWidth, -tipHeight * 0.25 + relateNodeHeight / 2],\r\n\t\t3: [-tipWidth, -tipHeight * 0.5 + relateNodeHeight / 2],\r\n\t\t4: [-tipWidth, -tipHeight * 0.75 + relateNodeHeight / 2],\r\n\t\t5: [-tipWidth * 0.75 + relateNodeWidth / 2, -tipHeight],\r\n\t\t6: [-tipWidth * 0.5 + relateNodeWidth / 2, -tipHeight],\r\n\t\t7: [-tipWidth * 0.25 + relateNodeWidth / 2, -tipHeight],\r\n\t\t8: [relateNodeWidth, -tipHeight * 0.75 + relateNodeHeight / 2],\r\n\t\t9: [relateNodeWidth, -tipHeight * 0.5 + relateNodeHeight / 2],\r\n\t\t10: [relateNodeWidth, -tipHeight * 0.25 + relateNodeHeight / 2]\r\n\t};\r\n\treturn offset[dir];\r\n};\r\n\r\n/**\r\n * @param {Tip} tipObj\r\n * 更新位置信息\r\n */\r\nconst updatePosition = (tipObj)=>{\r\n\tlet direction = tipObj.option.direction;\r\n\tlet tipWidth = tipObj.dom.offsetWidth;\r\n\tlet tipHeight = tipObj.dom.offsetHeight;\r\n\tlet relateNodePos = getDomOffset(tipObj.relateNode);\r\n\tlet rh = tipObj.relateNode.offsetHeight;\r\n\tlet rw = tipObj.relateNode.offsetWidth;\r\n\tif(direction === 'auto'){\r\n\t\tdirection = calDir(tipObj);\r\n\t}\r\n\ttipObj.dom.setAttribute('data-tip-dir',direction);\r\n\tlet [offsetLeft, offsetTop] = calcTipPositionByDir(direction, tipWidth, tipHeight, rh, rw);\r\n\ttipObj.dom.style.left = dimension2Style(relateNodePos.left + offsetLeft);\r\n\ttipObj.dom.style.top = dimension2Style(relateNodePos.top + offsetTop);\r\n};\r\n\r\nexport class Tip {\r\n\tid = null;\r\n\trelateNode = null;\r\n\r\n\t/** @var {HTMLElement} dom **/\r\n\tdom = null;\r\n\toption = {\r\n\t\tshowCloseButton: true,\r\n\t\twidth: 'auto',\r\n\t\tdirection: 'auto',\r\n\t};\r\n\r\n\tonShow = new BizEvent(true);\r\n\tonHide = new BizEvent(true);\r\n\tonDestroy = new BizEvent(true);\r\n\r\n\tconstructor(content, relateNode, opt = {}){\r\n\t\tthis.id = guid();\r\n\t\tthis.relateNode = relateNode;\r\n\t\tthis.option = Object.assign(this.option, opt);\r\n\r\n\t\tthis.dom = createDomByHtml(\r\n\t\t\t`<div class=\"${NS}-container-wrap\" style=\"display:none; ${this.option.width ? 'width:'+dimension2Style(this.option.width) : ''}\">\r\n\t\t\t\t<s class=\"${NS}-arrow\"></s>\r\n\t\t\t\t${this.option.showCloseButton ? `<span class=\"${NS}-close\">&#10005;</span>` : ''}\r\n\t\t\t\t<div class=\"${NS}-content\">${content}</div>\r\n\t\t\t</div>`);\r\n\t\tbindEvent(this);\r\n\t\tTIP_COLLECTION[this.id] = this;\r\n\t}\r\n\r\n\t/**\r\n\t * 设置提示内容\r\n\t * @param {String} html\r\n\t */\r\n\tsetContent(html){\r\n\t\tthis.dom.querySelector(`.${NS}-content`).innerHTML = html;\r\n\t\tupdatePosition(this);\r\n\t}\r\n\r\n\t/**\r\n\t * 去重判断，避免onShow时间多次触发\r\n\t */\r\n\tshow(){\r\n\t\tif(!document.contains(this.dom)){\r\n\t\t\tdocument.body.appendChild(this.dom);\r\n\t\t}\r\n\t\tshow(this.dom);\r\n\t\tupdatePosition(this);\r\n\t\tthis.onShow.fire(this);\r\n\t}\r\n\r\n\thide(){\r\n\t\thide(this.dom);\r\n\t\tthis.onHide.fire(this);\r\n\t}\r\n\r\n\tdestroy(){\r\n\t\tremove(this.dom);\r\n\t\tthis.onDestroy.fire();\r\n\t\tfor(let i in TIP_COLLECTION){\r\n\t\t\tif(TIP_COLLECTION[i] === this){\r\n\t\t\t\tdelete(TIP_COLLECTION[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 快速显示Tip\r\n\t * @param {String} content\r\n\t * @param {HTMLElement} relateNode\r\n\t * @param option\r\n\t * @returns {Tip}\r\n\t */\r\n\tstatic show(content, relateNode, option = {}){\r\n\t\tlet tip = new Tip(content, relateNode, option);\r\n\t\ttip.show();\r\n\t\treturn tip;\r\n\t}\r\n\r\n\t/**\r\n\t * 隐藏所有Tip\r\n\t */\r\n\tstatic hideAll(){\r\n\t\tfor(let i in TIP_COLLECTION){\r\n\t\t\tTIP_COLLECTION[i].hide();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 绑定节点\r\n\t * @param {String} content\r\n\t * @param {HTMLElement} relateNode\r\n\t * @param {Object} option\r\n\t * @return {Tip}\r\n\t */\r\n\tstatic bindNode(content, relateNode, option = {triggerType:'hover'}){\r\n\t\tlet guid = relateNode.getAttribute(GUID_BIND_KEY);\r\n\t\tlet tipObj = TIP_COLLECTION[guid];\r\n\t\tif(!tipObj){\r\n\t\t\ttipObj = new Tip(content, relateNode, option);\r\n\t\t\trelateNode.setAttribute(GUID_BIND_KEY, tipObj.id);\r\n\r\n\t\t\tlet tm = null;\r\n\t\t\tlet hide = ()=>{\r\n\t\t\t\ttm && clearTimeout(tm);\r\n\t\t\t\ttm = setTimeout(()=>{\r\n\t\t\t\t\ttipObj.hide();\r\n\t\t\t\t}, 10);\r\n\t\t\t};\r\n\t\t\tlet show = ()=>{\r\n\t\t\t\ttm && clearTimeout(tm);\r\n\t\t\t\ttipObj.show();\r\n\t\t\t}\r\n\t\t\tswitch(option.triggerType){\r\n\t\t\t\tcase 'hover':\r\n\t\t\t\t\trelateNode.addEventListener('mouseover', show);\r\n\t\t\t\t\trelateNode.addEventListener('mouseout', hide);\r\n\t\t\t\t\ttipObj.dom.addEventListener('mouseout', hide);\r\n\t\t\t\t\ttipObj.dom.addEventListener('mouseover', show);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'click':\r\n\t\t\t\t\trelateNode.addEventListener('click', ()=>{\r\n\t\t\t\t\t\tlet isShow = tipObj.dom.style.display !== 'none';\r\n\t\t\t\t\t\t!isShow ? show() : hide();\r\n\t\t\t\t\t});\r\n\t\t\t\t\tdocument.addEventListener('click', e=>{\r\n\t\t\t\t\t\tif(!domContained(relateNode, e.target, true) && !domContained(tipObj.dom, e.target, true)){\r\n\t\t\t\t\t\t\thide();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthrow \"option.triggerType no supported:\" + option.triggerType;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn tipObj;\r\n\t}\r\n\r\n\t/**\r\n\t * 通过异步获取数据方式绑定显示Tip\r\n\t * @param {HTMLElement} relateNode\r\n\t * @param {Function} dataFetcher Promise 对象，resolve返回 html 字符串\r\n\t * @param {Object} option\r\n\t */\r\n\tstatic bindAsync(relateNode, dataFetcher, option = {}){\r\n\t\tlet guid = relateNode.getAttribute(`data-${GUID_BIND_KEY}`);\r\n\t\tlet tipObj = TIP_COLLECTION[guid];\r\n\t\tif(!tipObj){\r\n\t\t\tlet loading = false;\r\n\t\t\ttipObj = Tip.bindNode('loading...', relateNode, option);\r\n\t\t\ttipObj.onShow.listen(() => {\r\n\t\t\t\tif(loading){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tloading = true;\r\n\t\t\t\tdataFetcher().then(rspHtml => {\r\n\t\t\t\t\ttipObj.setContent(rspHtml);\r\n\t\t\t\t}, error => {\r\n\t\t\t\t\ttipObj.setContent(error);\r\n\t\t\t\t}).finally(()=>{\r\n\t\t\t\t\tloading = false;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n}","import {Tip} from \"../Widget/Tip.js\";\n\n/**\n * 提示信息\n * 参数：\n * node[data-tip-content] | node[title] 提示内容，必填\n * node[data-tip-triggertype] 提示方式，缺省为 hover 触发\n */\nexport class ACTip {\n\tstatic init(node, option){\n\t\tlet {content, triggertype = 'hover'} = option;\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif(!content && node.title){\n\t\t\t\tcontent = node.title;\n\t\t\t\tnode.title = '';\n\t\t\t}\n\t\t\tif(!content){\n\t\t\t\treject('content required');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tTip.bindNode(content, node, {triggerType:triggertype});\n\t\t\tresolve();\n\t\t});\n\t}\n}","const DOMAIN_DEFAULT = 'default';\r\n\r\nexport const trans = (text, domain = DOMAIN_DEFAULT) => {\r\n\treturn text;\r\n}","import {createDomByHtml, remove} from \"../Lang/Dom.js\";\nimport {trans} from \"../I18N/Lang.js\";\nimport {Toast} from \"./Toast.js\";\nimport {Dialog} from \"./Dialog.js\";\n\n/**\n * copy text\n * @param {String} text\n * @param {Boolean} silent 是否在不兼容是进行提醒\n * @returns {boolean} 是否复制成功\n */\nexport const copy = (text, silent = false) => {\n\tlet txtNode = createDomByHtml('<textarea readonly=\"readonly\">', document.body);\n\ttxtNode.style.cssText = 'position:absolute; left:-9999px;';\n\tlet y = window.pageYOffset || document.documentElement.scrollTop;\n\ttxtNode.addEventListener('focus', function(){\n\t\twindow.scrollTo(0, y);\n\t});\n\ttxtNode.value = text;\n\ttxtNode.select();\n\ttry{\n\t\tlet succeeded = document.execCommand('copy');\n\t\t!silent && Toast.showSuccess(trans('复制成功'));\n\t\treturn succeeded;\n\t}catch(err){\n\t\tconsole.error(err);\n\t\tDialog.prompt('复制失败，请手工复制', {initValue:text});\n\t} finally{\n\t\tremove(txtNode);\n\t}\n\treturn false;\n};\n\n/**\n * Copy formatted html content\n * @param html\n * @param silent\n */\nexport const copyFormatted = (html, silent = false) => {\n\t// Create container for the HTML\n\tlet container = createDomByHtml(`\n\t\t<div style=\"position:fixed; pointer-events:none; opacity:0;\">${html}</div>\n\t`, document.body);\n\n\t// Detect all style sheets of the page\n\tlet activeSheets = Array.prototype.slice.call(document.styleSheets)\n\t\t.filter(function(sheet){\n\t\t\treturn !sheet.disabled;\n\t\t})\n\n\t// Copy to clipboard\n\twindow.getSelection().removeAllRanges();\n\n\tlet range = document.createRange();\n\trange.selectNode(container);\n\twindow.getSelection().addRange(range);\n\n\tdocument.execCommand('copy');\n\tfor(let i = 0; i < activeSheets.length; i++){\n\t\tactiveSheets[i].disabled = true;\n\t}\n\tdocument.execCommand('copy')\n\tfor(let i = 0; i < activeSheets.length; i++){\n\t\tactiveSheets[i].disabled = false;\n\t}\n\tdocument.body.removeChild(container);\n\t!silent && Toast.showSuccess(trans('复制成功'));\n}\n","import {copy, copyFormatted} from \"../Widget/Copy.js\";\n\n/**\n * 复制内容\n * 参数：\n * *[data-copy-content]\n * *[data-copy-type] type 为 html 时表示复制内容为HTML\n * 使用举例：\n * <input type=\"button\" value=\"复制链接” data-copy-content=\"http://abc.com\" data-component=\"copy\"/>\n */\nexport class ACCopy {\n\tstatic active(node, param = {}){\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif(!param.content){\n\t\t\t\tthrow \"复制内容为空\";\n\t\t\t}\n\t\t\tparam.type === 'html' ? copyFormatted(param.content) : copy(param.content);\n\t\t\tresolve();\n\t\t});\n\t}\n}","import {Toast} from \"../Widget/Toast.js\";\n\n/**\n * 对象触发时显示提示信息\n * 参数：\n * node[data-toast-message]\n * node[data-toast-type] type 为 Toast.type 类型\n */\nexport class ACToast {\n\tstatic active(node, param = {}){\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet message = param.message || '提示信息';\n\t\t\tlet type = param.type || Toast.TYPE_INFO;\n\t\t\tToast.showToast(message, type, Toast.DEFAULT_TIME_MAP[type], resolve);\n\t\t});\n\t}\n}","import {utf8Decode, utf8Encode} from \"./String.js\";\n\nconst BASE64_KEY_STR = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\n\n/**\n * base64 解码\n * @param {*} text\n * @returns\n */\nexport const base64Decode = (text) => {\n\tlet t = \"\";\n\tlet n, r, i;\n\tlet s, o, u, a;\n\tlet f = 0;\n\ttext = text.replace(/\\+\\+[++^A-Za-z0-9+/=]/g, \"\");\n\twhile(f < text.length){\n\t\ts = BASE64_KEY_STR.indexOf(text.charAt(f++));\n\t\to = BASE64_KEY_STR.indexOf(text.charAt(f++));\n\t\tu = BASE64_KEY_STR.indexOf(text.charAt(f++));\n\t\ta = BASE64_KEY_STR.indexOf(text.charAt(f++));\n\t\tn = s << 2 | o >> 4;\n\t\tr = (o & 15) << 4 | u >> 2;\n\t\ti = (u & 3) << 6 | a;\n\t\tt = t + String.fromCharCode(n);\n\t\tif(u !== 64){\n\t\t\tt = t + String.fromCharCode(r)\n\t\t}\n\t\tif(a !== 64){\n\t\t\tt = t + String.fromCharCode(i)\n\t\t}\n\t}\n\tt = utf8Decode(t);\n\treturn t\n};\n\n/**\n * URL 安全模式进行 base64 编码\n * @param {String} text\n * @return {string}\n */\nexport const base64UrlSafeEncode = (text) => {\n\treturn utf8Encode(text)\n\t\t.replace('+', '-')\n\t\t.replace('/', '_');\n};\n\n/**\n * text 转 base64\n * @param {String} text\n * @return {string}\n * @constructor\n */\nexport const Base64Encode = (text) => {\n\tlet t = \"\";\n\tlet n, r, i, s, o, u, a;\n\tlet f = 0;\n\ttext = utf8Encode(text);\n\twhile(f < text.length){\n\t\tn = text.charCodeAt(f++);\n\t\tr = text.charCodeAt(f++);\n\t\ti = text.charCodeAt(f++);\n\t\ts = n >> 2;\n\t\to = (n & 3) << 4 | r >> 4;\n\t\tu = (r & 15) << 2 | i >> 6;\n\t\ta = i & 63;\n\t\tif(isNaN(r)){\n\t\t\tu = a = 64\n\t\t}else if(isNaN(i)){\n\t\t\ta = 64\n\t\t}\n\t\tt = t + BASE64_KEY_STR.charAt(s) + BASE64_KEY_STR.charAt(o) + BASE64_KEY_STR.charAt(u) + BASE64_KEY_STR.charAt(a)\n\t}\n\treturn t\n};\n\n/**\n * 转换blob数据到base64\n * @param {Blob} blob\n * @returns {Promise<unknown>}\n */\nexport const convertBlobToBase64 = async (blob) => {\n\treturn await blobToBase64(blob);\n}\n\n/**\n * 转换blob数据到Base64\n * @param {Blob} blob\n * @returns {Promise<unknown>}\n */\nconst blobToBase64 = blob => new Promise((resolve, reject) => {\n\tconst reader = new FileReader();\n\treader.readAsDataURL(blob);\n\treader.onload = () => resolve(reader.result);\n\treader.onerror = error => reject(error);\n});\n","import {convertBlobToBase64} from \"./Base64.js\";\n\n/**\n * 通过 src 加载图片\n * @param {String} src\n * @returns {Promise<HTMLImageElement>}\n */\nexport const loadImgBySrc = (src)=>{\n\treturn new Promise((resolve, reject) => {\n\t\tlet img = new Image;\n\t\timg.onload = ()=>{\n\t\t\tresolve(img);\n\t\t};\n\t\timg.onabort = ()=>{\n\t\t\treject('Image loading abort');\n\t\t};\n\t\timg.onerror = ()=>{\n\t\t\treject('Image load failure');\n\t\t};\n\t\timg.src = src;\n\t});\n}\n\n/**\n * 从 img.srcset 属性中解析出最高分辨率图片\n * @param {String} srcset_str\n * @return {string}\n */\nexport const getHighestResFromSrcSet = (srcset_str) => {\n\treturn srcset_str\n\t\t.split(\",\")\n\t\t.reduce(\n\t\t\t(acc, item) => {\n\t\t\t\tlet [url, width] = item.trim().split(\" \");\n\t\t\t\twidth = parseInt(width);\n\t\t\t\tif(width > acc.width) return {width, url};\n\t\t\t\treturn acc;\n\t\t\t},\n\t\t\t{width: 0, url: \"\"}\n\t\t).url;\n}\n\n/**\n * 通过ImageSrc获取base64（网络请求模式）\n * @param src\n * @returns {Promise<unknown>}\n */\nexport const getBase64BySrc = (src)=>{\n\treturn new Promise((resolve, reject) => {\n\t\tlet xhr = new XMLHttpRequest();\n\t\txhr.open('GET', src, true);\n\t\txhr.responseType = 'blob';\n\t\txhr.onload = function(){\n\t\t\tif(this.status === 200){\n\t\t\t\tlet blob = this.response;\n\t\t\t\tconvertBlobToBase64(blob).then(base64 => {\n\t\t\t\t\tresolve(base64);\n\t\t\t\t}).catch(error => {\n\t\t\t\t\treject(error);\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t\txhr.onerror = function() {\n\t\t\treject('Error:'+this.statusText);\n\t\t};\n\t\txhr.onabort = function(){\n\t\t\treject('Request abort');\n\t\t}\n\t\txhr.send();\n\t});\n}\n\n/**\n * 通过 Image 获取base64数据\n * @param img\n * @returns {string|string|*|string|null}\n */\nexport const getBase64ByImg = (img) => {\n\tif(!img.src){\n\t\treturn null;\n\t}\n\tif(img.src.indexOf('data:') === 0){\n\t\treturn img.src;\n\t}\n\tlet canvas = document.createElement(\"canvas\");\n\tcanvas.width = img.width;\n\tcanvas.height = img.height;\n\tlet ctx = canvas.getContext(\"2d\");\n\tctx.drawImage(img, 0, 0, img.width, img.height);\n\treturn canvas.toDataURL(\"image/png\")\n};\n\n/**\n * 通过缩放+定位将图片放置在指定容器中间\n * @param {Number} contentWidth\n * @param {Number} contentHeight\n * @param {Number} containerWidth\n * @param {Number} containerHeight\n * @param {Number} spacing\n * @param {Boolean} zoomIn 是否在图片小于容器时放大，默认不放大\n * @returns {{top: number, left: number, width: number, height: number}|{top: number, left: number, width, height}}\n */\nexport const scaleFixCenter = ({\n   contentWidth,\n   contentHeight,\n   containerWidth,\n   containerHeight,\n   spacing = 0,\n   zoomIn = false}) => {\n\tif(contentWidth <= containerWidth && contentHeight <= containerHeight && !zoomIn){\n\t\treturn {\n\t\t\twidth: contentWidth,\n\t\t\theight: contentHeight,\n\t\t\tleft: (containerWidth - contentWidth) / 2,\n\t\t\ttop: (containerHeight - contentHeight) / 2\n\t\t};\n\t}\n\tlet ratioX = containerWidth / contentWidth;\n\tlet ratioY = containerHeight / contentHeight;\n\n\tlet ratio = Math.min(ratioX, ratioY);\n\treturn {\n\t\twidth: contentWidth * ratio - spacing * 2,\n\t\theight: contentHeight * ratio - spacing * 2,\n\t\tleft: (containerWidth - contentWidth * ratio) / 2 + spacing,\n\t\ttop: (containerHeight - contentHeight * ratio) / 2 + spacing,\n\t}\n}\n\n/**\n * 获取图像元素平均色彩\n * @param {HTMLImageElement} imgEl\n * @return {{r: number, b: number, g: number}}\n */\nexport const getAverageRGB = (imgEl) => {\n\tlet blockSize = 5, // only visit every 5 pixels\n\t\tdefaultRGB = {r: 0, g: 0, b: 0}, // for non-supporting envs\n\t\tcanvas = document.createElement('canvas'),\n\t\tcontext = canvas.getContext && canvas.getContext('2d'),\n\t\tdata, width, height,\n\t\ti = -4,\n\t\tlength,\n\t\trgb = {r: 0, g: 0, b: 0},\n\t\tcount = 0;\n\n\tif(!context){\n\t\treturn defaultRGB;\n\t}\n\n\theight = canvas.height = imgEl.naturalHeight || imgEl.offsetHeight || imgEl.height;\n\twidth = canvas.width = imgEl.naturalWidth || imgEl.offsetWidth || imgEl.width;\n\tcontext.drawImage(imgEl, 0, 0);\n\n\ttry{\n\t\tdata = context.getImageData(0, 0, width, height);\n\t}catch(e){\n\t\t/* security error, img on diff domain */\n\t\treturn defaultRGB;\n\t}\n\n\tlength = data.data.length;\n\twhile((i += blockSize * 4) < length){\n\t\t++count;\n\t\trgb.r += data.data[i];\n\t\trgb.g += data.data[i + 1];\n\t\trgb.b += data.data[i + 2];\n\t}\n\n\t// ~~ used to floor values\n\trgb.r = ~~(rgb.r / count);\n\trgb.g = ~~(rgb.g / count);\n\trgb.b = ~~(rgb.b / count);\n\treturn rgb;\n}\n","const json_decode = (v) => {\n\treturn v === null ? null : JSON.parse(v);\n}\n\nconst json_encode = (v) => {\n\treturn JSON.stringify(v);\n}\n\nlet callbacks = [];\nlet handler_callbacks = (key, newVal, oldVal)=>{\n\tcallbacks.forEach(cb=>{cb(key, newVal, oldVal)});\n};\n\nlet ls_listen_flag = false;\n\n/**\n * 基于LocalStorage的设置项存储\n * localStorage中按照 key-value 方式进行存储，value支持数据类型\n */\nexport class LocalStorageSetting {\n\tnamespace = '';\n\tsettingKeys = [];\n\tconstructor(defaultSetting, namespace = ''){\n\t\tthis.namespace = namespace;\n\t\tthis.settingKeys = Object.keys(defaultSetting);\n\t\tfor(let key in defaultSetting){\n\t\t\tlet v = this.get(key);\n\t\t\tif(v === null){\n\t\t\t\tthis.set(key, defaultSetting[key]);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * 获取配置\n\t * @param {String} key\n\t * @return {null|any}\n\t */\n\tget(key){\n\t\tlet v = localStorage.getItem(this.namespace+key);\n\t\tif(v === null){\n\t\t\treturn null;\n\t\t}\n\t\treturn json_decode(v);\n\t}\n\n\t/**\n\t * 设置配置\n\t * @param {String} key\n\t * @param {any} value\n\t */\n\tset(key, value){\n\t\thandler_callbacks(key, value, this.get(key));\n\t\tlocalStorage.setItem(this.namespace+key, json_encode(value));\n\t}\n\n\t/**\n\t * 移除指定配置\n\t * @param {String} key\n\t */\n\tremove(key){\n\t\thandler_callbacks(key, null, this.get(key));\n\t\tlocalStorage.removeItem(this.namespace+key);\n\t}\n\n\t/**\n\t * 配置更新回调（包含配置变更、配置删除）\n\t * @param {Function} callback (key, newValue, oldValue)\n\t */\n\tonUpdated(callback){\n\t\tcallbacks.push(callback);\n\t\tif(!ls_listen_flag){\n\t\t\tls_listen_flag = true;\n\t\t\twindow.addEventListener('storage', e => {\n\t\t\t\tif(!this.namespace || e.key.indexOf(this.namespace) === 0){\n\t\t\t\t\thandler_callbacks(e.key.substring(this.namespace.length), json_decode(e.newValue), json_decode(e.oldValue));\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * 遍历\n\t * @param {Function} payload (key, value)\n\t */\n\teach(payload){\n\t\tthis.settingKeys.forEach(k=>{\n\t\t\tpayload(k, this.get(k));\n\t\t});\n\t}\n\n\t/**\n\t * 移除所有\n\t */\n\tremoveAll(){\n\t\tthis.settingKeys.forEach(k=>{\n\t\t\tthis.remove(k);\n\t\t});\n\t}\n\n\t/**\n\t * 获取所有\n\t * @return {Object} {key:value}\n\t */\n\tgetAll(){\n\t\tlet obj = {};\n\t\tthis.settingKeys.forEach(k=>{\n\t\t\tobj[k] = this.get(k);\n\t\t});\n\t\treturn obj;\n\t}\n}","import {\n\tcreateDomByHtml,\n\tfindAll,\n\tfindOne,\n\tgetContextWindow,\n\thide,\n\tinsertStyleSheet,\n\tremove,\n\tsetStyle,\n\tshow\n} from \"../Lang/Dom.js\";\nimport {loadImgBySrc} from \"../Lang/Img.js\";\nimport {Theme} from \"./Theme.js\";\nimport {bindNodeActive, KEYS} from \"../Lang/Event.js\";\nimport {downloadFile} from \"../Lang/Net.js\";\nimport {Dialog} from \"./Dialog.js\";\nimport {Toast} from \"./Toast.js\";\nimport {LocalStorageSetting} from \"./LocalStorageSetting.js\";\nimport {convertFormDataToObject, convertObjectToFormData, formSync} from \"../Lang/Form.js\";\nimport {dimension2Style} from \"../Lang/Html.js\";\n\nconst COM_ID = Theme.Namespace + 'com-image-viewer'\nconst CONTEXT_WINDOW = getContextWindow();\nif(!CONTEXT_WINDOW[COM_ID]){\n\tCONTEXT_WINDOW[COM_ID] = {};\n}\n\nconst DOM_CLASS = COM_ID;\n\nconst DEFAULT_VIEW_PADDING = 20;\nconst MAX_ZOOM_IN_RATIO = 2; //最大显示比率\nconst MIN_ZOOM_OUT_SIZE = 50; //最小显示像素\n\nconst THUMB_SIZE = 56+4;\n\nconst ZOOM_IN_RATIO = 0.8; //缩小比率\nconst ZOOM_OUT_RATIO = 1.2; //放大比率\n\n// const NAV_MAX_WIDTH = 'calc(100% - 1300px)';\nconst NAV_MAX_WIDTH = 'min(calc(100vw - 200px), 600px)';\n\nconst ATTR_W_BIND_KEY = 'data-original-width';\nconst ATTR_H_BIND_KEY = 'data-original-height';\n\nconst DISABLED_ATTR_KEY = 'data-disabled';\n\nconst GRID_IMG_BG = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUAQMAAAC3R49OAAAABlBMVEXv7+////9mUzfqAAAAFElEQVQIW2NksN/ISAz+f9CBGAwAxtEddZlnB4IAAAAASUVORK5CYII=';\n\nconst BASE_INDEX = Theme.FullScreenModeIndex;\nconst OP_INDEX = BASE_INDEX + 1;\nconst OPTION_DLG_INDEX = BASE_INDEX + 2;\n\nexport const IMG_PREVIEW_MODE_SINGLE = 1;\nexport const IMG_PREVIEW_MODE_MULTIPLE = 2;\n\nexport const IMG_PREVIEW_MS_SCROLL_TYPE_NONE = 0;\nexport const IMG_PREVIEW_MS_SCROLL_TYPE_SCALE = 1;\nexport const IMG_PREVIEW_MS_SCROLL_TYPE_NAV = 2;\n\nlet PREVIEW_DOM = null;\nlet CURRENT_MODE = 0;\n\n//id, title, payload\nconst CMD_CLOSE = ['close', '关闭', () => {\n\tdestroy()\n}];\nconst CMD_NAV_TO = ['nav_to', '关闭', (target) => {\n\tnavTo(target.getAttribute('data-dir') !== '1');\n}];\nconst CMD_SWITCH_TO = ['switch_to', '关闭', (target) => {\n\tswitchTo(target.getAttribute('data-index'));\n}];\nconst CMD_THUMB_SCROLL_PREV = ['thumb_scroll_prev', '关闭', () => {\n\tthumbScroll(true)\n}];\nconst CMD_THUMB_SCROLL_NEXT = ['thumb_scroll_next', '关闭', () => {\n\tthumbScroll(false)\n}];\nconst CMD_ZOOM_OUT = ['zoom_out', '放大', () => {\n\tzoom(ZOOM_OUT_RATIO);\n\treturn false\n}];\nconst CMD_ZOOM_IN = ['zoom_in', '缩小', () => {\n\tzoom(ZOOM_IN_RATIO);\n\treturn false\n}];\nconst CMD_ZOOM_ORG = ['zoom_org', '原始比例', () => {\n\tzoom(null);\n\treturn false\n}];\nconst CMD_ROTATE_LEFT = ['rotate_left', '左旋90°', () => {\n\trotate(-90);\n\treturn false\n}];\nconst CMD_ROTATE_RIGHT = ['rotate_right', '右旋90°', () => {\n\trotate(90);\n\treturn false\n}];\nconst CMD_VIEW_ORG = ['view_org', '查看原图', () => {\n\tviewOriginal()\n}];\nconst CMD_DOWNLOAD = ['download', '下载图片', () => {\n\tdownloadFile(srcSetResolve(IMG_SRC_LIST[IMG_CURRENT_INDEX]).original)\n}];\nconst CMD_OPTION = ['option', '选项', () => {\n\tshowOptionDialog()\n}];\n\n//srcset支持格式请使用 srcSetResolve 进行解析使用，规则如下\n// ① src或[src]: 只有一种图源模式；\n// ② [src1,src2]，1为缩略图，2为大图、原图；\n// ③ [src1,src2,src3] 1为缩略图，2为大图，3为原图\nlet IMG_SRC_LIST = [/** srcset1, srcset2 **/];\nlet IMG_CURRENT_INDEX = 0;\n\nconst DEFAULT_SETTING = {\n\tmouse_scroll_type: IMG_PREVIEW_MS_SCROLL_TYPE_NAV,\n\tallow_move: true,\n\tshow_thumb_list: false,\n\tshow_toolbar: true,\n};\nlet LocalSetting = new LocalStorageSetting(DEFAULT_SETTING, Theme.Namespace + 'com-image-viewer/');\n\n/**\n * 解析图片src集合\n * @param {Array|String} srcSet\n * @return {{normal: string, original: string, thumb: string}}\n */\nconst srcSetResolve = srcSet => {\n\tsrcSet = typeof (srcSet) === 'string' ? [srcSet] : srcSet;\n\treturn {\n\t\tthumb: srcSet[0],\n\t\tnormal: srcSet[1] || srcSet[0],\n\t\toriginal: srcSet[2] || srcSet[1] || srcSet[0]\n\t};\n}\n\ninsertStyleSheet(`\n\t @keyframes ${Theme.Namespace}spin{\n\t\t100%{transform:rotate(360deg);}\n\t}\n\t.${DOM_CLASS}{width:100vw;height:100vh; max-height:100vh !important; max-width:100vw !important; overflow:hidden; padding:0; margin:0; border:none; background-color:#fff0;}\n\t.${DOM_CLASS}::backdrop {backdrop-filter:brightness(0.65) blur(10px)}\n\t.${DOM_CLASS} .civ-closer{position:fixed; opacity:0.7; z-index:${OP_INDEX}; background-color:#cccccc87; color:white; right:20px; top:20px; border-radius:3px; cursor:pointer; font-size:0; line-height:1; padding:5px;}\n\t.${DOM_CLASS} .civ-closer:before{font-family:\"${Theme.IconFont}\", serif; content:\"\\\\e61a\"; font-size:20px;}\n\t.${DOM_CLASS} .civ-closer:hover{opacity:1}\n\t.${DOM_CLASS} .civ-nav-btn{padding:10px; z-index:${OP_INDEX}; transition:all 0.1s linear; border-radius:3px; opacity:0.8; color:white; background-color:#8d8d8d6e; position:fixed; top:calc(50% - 25px); cursor:pointer;}\n\t.${DOM_CLASS} .civ-nav-btn[disabled]{color:gray; cursor:default !important;}\n\t.${DOM_CLASS} .civ-nav-btn:not([disabled]):hover{opacity:1;}\n\t.${DOM_CLASS} .civ-nav-btn:before{font-family:\"${Theme.IconFont}\"; font-size:20px;}\n\t.${DOM_CLASS} .civ-prev{left:10px}\n\t.${DOM_CLASS} .civ-prev:before{content:\"\\\\e6103\"}\n\t.${DOM_CLASS} .civ-next{right:10px}\n\t.${DOM_CLASS} .civ-next:before{content:\"\\\\e73b\";}\n\n\t.${DOM_CLASS} .civ-view-option {position:fixed;display:flex;--opt-btn-size:1.8rem;background-color: #6f6f6f26;backdrop-filter:blur(4px);padding:0.25em 0.5em;left:50%;transform:translate(-50%, 0);z-index:${OP_INDEX};gap: 0.5em;border-radius:4px;}\n\t.${DOM_CLASS} .civ-opt-btn {cursor:pointer;flex:1;user-select:none;width: var(--opt-btn-size); line-height:1; height:var(--opt-btn-size);overflow: hidden; color: white;padding: 0.2em;border-radius: 4px;transition: all 0.1s linear;opacity: 0.7;}\n\t.${DOM_CLASS} .civ-opt-btn:before {font-family:\"${Theme.IconFont}\";font-size:var(--opt-btn-size);display: block;width: 100%;height: 100%;}\n\t.${DOM_CLASS} .civ-opt-btn:hover {background-color: #ffffff3b;opacity: 1;}\n\t\n\t.${DOM_CLASS}-icon:before {content:\"\"; font-family:\"${Theme.IconFont}\"; font-style:normal;}\n\t.${DOM_CLASS}-icon-${CMD_ZOOM_OUT[0]}:before {content: \"\\\\e898\";}\n\t.${DOM_CLASS}-icon-${CMD_ZOOM_IN[0]}:before {content:\"\\\\e683\"} \n\t.${DOM_CLASS}-icon-${CMD_ZOOM_ORG[0]}:before {content:\"\\\\e64a\"} \n\t.${DOM_CLASS}-icon-${CMD_ROTATE_LEFT[0]}:before {content:\"\\\\e7be\"} \n\t.${DOM_CLASS}-icon-${CMD_ROTATE_RIGHT[0]}:before {content:\"\\\\e901\"} \n\t.${DOM_CLASS}-icon-${CMD_VIEW_ORG[0]}:before {content:\"\\\\e7de\"} \n\t.${DOM_CLASS}-icon-${CMD_DOWNLOAD[0]}:before {content:\"\\\\e839\"} \n\t.${DOM_CLASS}-icon-${CMD_OPTION[0]}:before {content:\"\\\\e9cb\";}\n\n\t.${DOM_CLASS} .civ-nav-wrap{position:fixed;opacity: 0.8;transition:all 0.1s linear;background-color: #ffffff26;bottom:10px;left:50%;transform:translate(-50%, 0);z-index:${OP_INDEX};display: flex; padding:0.5em 0.25em;max-width: ${NAV_MAX_WIDTH};min-width: 100px;border-radius: 5px;backdrop-filter: blur(4px);box-shadow: 1px 1px 30px #6666666b;}\n\t.${DOM_CLASS} .civ-nav-wrap:hover {opacity:1}\n\t.${DOM_CLASS} .civ-nav-list-wrap {overflow:hidden; scroll-behavior: smooth;}\n\t.${DOM_CLASS} .civ-nav-list-prev,\n\t.${DOM_CLASS} .civ-nav-list-next {color:white; flex: 1; min-width:25px;cursor: pointer;opacity: 0.5;line-height: 48px;transition: all 0.1s linear; display: flex; align-items: center;}\n\t.${DOM_CLASS} .civ-nav-list-prev:hover,\n\t.${DOM_CLASS} .civ-nav-list-next:hover {opacity:1}\n\t.${DOM_CLASS} .civ-nav-list-prev:before,\n\t.${DOM_CLASS} .civ-nav-list-next:before{font-family:\"${Theme.IconFont}\";font-size:18px;}\n\t.${DOM_CLASS} .civ-nav-list-prev {}\n\t.${DOM_CLASS} .civ-nav-list-next {right: -20px;}\n\t.${DOM_CLASS} .civ-nav-list-prev:before{content:\"\\\\e6103\"}\n\t.${DOM_CLASS} .civ-nav-list-next:before{content:\"\\\\e73b\";}\n\t\n\t.${DOM_CLASS} .civ-nav-list{height:${THUMB_SIZE}px; transition:margin 0.4s ease-out; display:flex}\n\t.${DOM_CLASS} .civ-nav-thumb{min-width:${THUMB_SIZE}px; height:100%; flex:1; transition:all 0.1s linear;overflow:hidden; box-sizing:border-box; cursor: pointer;}\n\t.${DOM_CLASS} .civ-nav-thumb img{border:4px solid transparent; border-radius:3px; width:${THUMB_SIZE}px; height:${THUMB_SIZE}px; object-fit:cover; opacity: 0.6; box-sizing:border-box;}\n\t.${DOM_CLASS} .civ-nav-thumb:hover img {border-color:#ffffff82;opacity:0.8;}\n\t.${DOM_CLASS} .civ-nav-thumb.active img {border-color:white;opacity: 1;}\n\n\t.${DOM_CLASS} .civ-ctn{height:100%; width:100%; position:absolute; top:0; left:0;}\n\t.${DOM_CLASS} .civ-error{margin-top:calc(50% - 60px);}\n\t.${DOM_CLASS} .civ-loading{--loading-size:50px; position:absolute; left:50%; top:50%; margin:calc(var(--loading-size) / 2) 0 0 calc(var(--loading-size) / 2)}\n\t.${DOM_CLASS} .civ-loading:before{content:\"\\\\e635\"; font-family:\"${Theme.IconFont}\" !important; animation:${Theme.Namespace}spin 3s infinite linear; font-size:var(--loading-size); color:#ffffff6e; display:block; width:var(--loading-size); height:var(--loading-size); line-height:var(--loading-size)}\n\t.${DOM_CLASS} .civ-img{height:100%; display:block; box-sizing:border-box; position:relative;}\n\t.${DOM_CLASS} .civ-img img{position:absolute; left:50%; top:50%; transition:width 0.1s, height 0.1s, transform 0.1s; transform:translate(-50%, -50%); box-shadow:1px 1px 20px #484848; background:url('${GRID_IMG_BG}')}\n\n\t.${DOM_CLASS}[data-ip-mode=\"1\"] .civ-nav-btn,\n\t.${DOM_CLASS}[data-ip-mode=\"1\"] .civ-nav-wrap{display:none;}\n\n\t.${DOM_CLASS}-option-list {padding: 1em 2em 2em;display: block;list-style: none;font-size:1rem;}\n\t.${DOM_CLASS}-option-list>li {margin-bottom: 1em;padding-left: 5em;}\n\t.${DOM_CLASS}-option-list>li:last-child {margin:0;}\n\t.${DOM_CLASS}-option-list>li>label:first-child {display:block;float: left;width: 5em;margin-left: -5em;user-select:none;}\n\t.${DOM_CLASS}-option-list>li>label:not(:first-child) {display:block;user-select:none;margin-bottom: 0.25em;}\n\n\t.${DOM_CLASS}-tools-menu {position:fixed;background: white;padding: 5px 0;min-width: 150px; border-radius: 4px;box-shadow: 1px 1px 10px #3e3e3e94;}\n\t.${DOM_CLASS}-tools-menu>li {padding: 0.45em 1em;}\n\t.${DOM_CLASS}-tools-menu>li:hover {background: #eee;cursor: pointer;user-select: none;}\n\n\t.${DOM_CLASS}[show_thumb_list=\"false\"] .civ-nav-wrap,\n\t.${DOM_CLASS}[show_toolbar=\"false\"] .civ-view-option {display:none;}\n`, Theme.Namespace + 'img-preview-style');\n\n/**\n * 销毁组件\n */\nconst destroy = () => {\n\tif(!PREVIEW_DOM){\n\t\treturn false;\n\t}\n\tremove(PREVIEW_DOM);\n\tPREVIEW_DOM = null;\n\twindow.removeEventListener('resize', onWinResize);\n\tdocument.removeEventListener('keydown', bindKeyDown);\n\treturn true;\n};\n\n/**\n * 更新导航按钮状态\n */\nconst updateNavState = () => {\n\tlet prev = PREVIEW_DOM.querySelector('.civ-prev');\n\tlet next = PREVIEW_DOM.querySelector('.civ-next');\n\tlet total = IMG_SRC_LIST.length;\n\tif(IMG_CURRENT_INDEX === 0){\n\t\tprev.setAttribute(DISABLED_ATTR_KEY, '1');\n\t}else{\n\t\tprev.removeAttribute(DISABLED_ATTR_KEY);\n\t}\n\tif(IMG_CURRENT_INDEX === (total - 1)){\n\t\tnext.setAttribute(DISABLED_ATTR_KEY, '1');\n\t}else{\n\t\tnext.removeAttribute(DISABLED_ATTR_KEY);\n\t}\n\n\tPREVIEW_DOM.querySelectorAll(`.civ-nav-list .civ-nav-thumb`).forEach(item => item.classList.remove('active'));\n\tPREVIEW_DOM.querySelector(`.civ-nav-list .civ-nav-thumb[data-index=\"${IMG_CURRENT_INDEX}\"]`).classList.add('active');\n\tthumbScrollIntoView();\n}\n\nconst listenSelector = (parentNode, selector, event, handler) => {\n\tparentNode.querySelectorAll(selector).forEach(target => {\n\t\ttarget.addEventListener(event, handler);\n\t});\n}\n\nconst activeSelector = (parentNode, selector, handler) => {\n\tlistenSelector(parentNode, selector, 'click', handler);\n\tlistenSelector(parentNode, selector, 'keyup', e => {\n\t\tif(e.keyCode === KEYS.Enter){\n\t\t\thandler(e);\n\t\t}\n\t});\n}\n\nconst scaleFixCenter = ({\n\t                        contentWidth,\n\t                        contentHeight,\n\t                        containerWidth,\n\t                        containerHeight,\n\t                        spacing = 0,\n\t                        zoomIn = false\n                        }) => {\n\tif(contentWidth <= containerWidth && contentHeight <= containerHeight && !zoomIn){\n\t\treturn {\n\t\t\twidth: contentWidth,\n\t\t\theight: contentHeight\n\t\t};\n\t}\n\tlet ratioX = containerWidth / contentWidth;\n\tlet ratioY = containerHeight / contentHeight;\n\n\tlet ratio = Math.min(ratioX, ratioY);\n\treturn {\n\t\twidth: contentWidth * ratio - spacing * 2,\n\t\theight: contentHeight * ratio - spacing * 2\n\t};\n}\n\n/**\n * 绑定图片移动\n * @param {HTMLImageElement} img\n */\nconst bindImgMove = (img) => {\n\tlet moving = false;\n\tlet lastOffset = {};\n\timg.addEventListener('mousedown', e => {\n\t\tmoving = true;\n\t\tlastOffset = {\n\t\t\tclientX: e.clientX,\n\t\t\tclientY: e.clientY,\n\t\t\tmarginLeft: parseInt(img.style.marginLeft || 0, 10),\n\t\t\tmarginTop: parseInt(img.style.marginTop || 0, 10)\n\t\t};\n\t\te.preventDefault();\n\t});\n\n\t['mouseup', 'mouseout'].forEach(ev => {\n\t\timg.addEventListener(ev, e => {\n\t\t\tmoving = false;\n\t\t})\n\t});\n\timg.addEventListener('mousemove', e => {\n\t\tif(moving && LocalSetting.get('allow_move')){\n\t\t\timg.style.marginLeft = dimension2Style(lastOffset.marginLeft + (e.clientX - lastOffset.clientX));\n\t\t\timg.style.marginTop = dimension2Style(lastOffset.marginTop + (e.clientY - lastOffset.clientY));\n\t\t}\n\t});\n}\n\n/**\n * 显示图片\n * @param {Number} img_index\n */\nconst showImgSrc = (img_index = 0) => {\n\treturn new Promise((resolve, reject) => {\n\t\tlet imgItem = srcSetResolve(IMG_SRC_LIST[img_index]);\n\t\tlet loading = PREVIEW_DOM.querySelector('.civ-loading');\n\t\tlet err = PREVIEW_DOM.querySelector('.civ-error');\n\t\tlet img_ctn = PREVIEW_DOM.querySelector('.civ-img');\n\t\timg_ctn.innerHTML = '';\n\t\tshow(loading);\n\t\thide(err);\n\t\tloadImgBySrc(imgItem.normal).then(img => {\n\t\t\tsetStyle(img, scaleFixCenter({\n\t\t\t\tcontentWidth: img.width,\n\t\t\t\tcontentHeight: img.height,\n\t\t\t\tcontainerWidth: img_ctn.offsetWidth,\n\t\t\t\tcontainerHeight: img_ctn.offsetHeight,\n\t\t\t\tspacing: DEFAULT_VIEW_PADDING\n\t\t\t}));\n\t\t\thide(loading);\n\t\t\timg_ctn.innerHTML = '';\n\t\t\timg.setAttribute(ATTR_W_BIND_KEY, img.width);\n\t\t\timg.setAttribute(ATTR_H_BIND_KEY, img.height);\n\t\t\tbindImgMove(img);\n\t\t\timg_ctn.appendChild(img);\n\t\t\tresolve(img);\n\t\t}, error => {\n\t\t\thide(loading);\n\t\t\terr.innerHTML = `图片加载失败，<a href=\"${imgItem.normal}\" target=\"_blank\">查看详情(${error})</a>`;\n\t\t\tshow(err);\n\t\t\treject(err);\n\t\t});\n\t});\n}\n\nconst constructDom = () => {\n\tlet nav_thumb_list_html = `\n\t\t<div class=\"civ-nav-wrap\">\n\t\t\t<span class=\"civ-nav-list-prev\" tabindex=\"0\" data-cmd=\"${CMD_THUMB_SCROLL_PREV[0]}\"></span>\n\t\t\t<div class=\"civ-nav-list-wrap\">\n\t\t\t\t<div class=\"civ-nav-list\">\n\t\t\t\t${IMG_SRC_LIST.reduce((preStr, item, idx) => {\n\t\t\treturn preStr + `<span class=\"civ-nav-thumb\" tabindex=\"0\" data-cmd=\"${CMD_SWITCH_TO[0]}\" data-index=\"${idx}\"><img src=\"${srcSetResolve(item).thumb}\"/></span>`;\n\t\t}, \"\")}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<span class=\"civ-nav-list-next\" tabindex=\"0\" data-cmd=\"${CMD_THUMB_SCROLL_NEXT[0]}\"></span>\n\t\t</div>`;\n\n\tlet option_html = `\n\t<span class=\"civ-view-option\">\n\t\t${TOOLBAR_OPTIONS.reduce((lastVal, cmdInfo, idx) => {\n\t\treturn lastVal + `<span class=\"civ-opt-btn ${DOM_CLASS}-icon ${DOM_CLASS}-icon-${cmdInfo[0]}\" tabindex=\"0\" data-cmd=\"${cmdInfo[0]}\" title=\"${cmdInfo[1]}\"></span>`;\n\t}, \"\")}\n\t</span>`;\n\n\tPREVIEW_DOM = createDomByHtml(`\n\t\t<dialog class=\"${DOM_CLASS}\" data-ip-mode=\"${CURRENT_MODE}\">\n\t\t\t<span tabindex=\"0\" class=\"civ-closer\" data-cmd=\"${CMD_CLOSE[0]}\" title=\"ESC to close\">close</span>\n\t\t\t<span tabindex=\"0\" class=\"civ-nav-btn civ-prev\" data-cmd=\"${CMD_NAV_TO[0]}\" data-dir=\"0\"></span>\n\t\t\t<span tabindex=\"0\" class=\"civ-nav-btn civ-next\" data-cmd=\"${CMD_NAV_TO[0]}\" data-dir=\"1\"></span>\n\t\t\t${option_html}\n\t\t\t${nav_thumb_list_html}\n\t\t\t<div class=\"civ-ctn\">\n\t\t\t\t<span class=\"civ-loading\"></span>\n\t\t\t\t<span class=\"civ-error\"></span>\n\t\t\t\t<span class=\"civ-img\"></span>\n\t\t\t</div>\n\t\t</dialog>\n\t`, document.body);\n\n\tLocalSetting.each((k, v) => {\n\t\tPREVIEW_DOM.setAttribute(k, JSON.stringify(v));\n\t});\n\tLocalSetting.onUpdated((k, v) => {\n\t\tPREVIEW_DOM && PREVIEW_DOM.setAttribute(k, JSON.stringify(v));\n\t});\n\n\t//bind close click & space click\n\tfindAll('[data-cmd]', PREVIEW_DOM).forEach(node=>{\n\t\tbindNodeActive(node, ()=>{\n\t\t\tlet cmd = node.getAttribute('data-cmd');\n\t\t\tif(node.getAttribute(DISABLED_ATTR_KEY)){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tlet cmdInfo = getCmdViaID(cmd);\n\t\t\tif(cmdInfo){\n\t\t\t\treturn cmdInfo[2](node);\n\t\t\t}\n\t\t\tthrow \"no command found.\";\n\n\t\t})\n\t})\n\n\tbindNodeActive(findOne('.civ-ctn', PREVIEW_DOM), e => {\n\t\tif(e && e.target.tagName !== 'IMG'){\n\t\t\tdestroy();\n\t\t}\n\t});\n\n\tfindOne('.civ-nav-wrap', PREVIEW_DOM).addEventListener('mousewheel', e=>{\n\t\tnavTo(e.wheelDelta > 0);\n\t\te.preventDefault();\n\t\treturn false;\n\t});\n\n\t//bind scroll zoom\n\tlistenSelector(PREVIEW_DOM, '.civ-ctn', 'mousewheel', e => {\n\t\tswitch(LocalSetting.get('mouse_scroll_type')){\n\t\t\tcase IMG_PREVIEW_MS_SCROLL_TYPE_SCALE:\n\t\t\t\tzoom(e.wheelDelta > 0 ? ZOOM_OUT_RATIO : ZOOM_IN_RATIO);\n\t\t\t\tbreak;\n\t\t\tcase IMG_PREVIEW_MS_SCROLL_TYPE_NAV:\n\t\t\t\tnavTo(e.wheelDelta > 0);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t\te.preventDefault();\n\t\treturn false;\n\t})\n\n\tPREVIEW_DOM.showModal();\n\n\t//bind resize\n\twindow.addEventListener('resize', onWinResize);\n\tPREVIEW_DOM.addEventListener('keydown', bindKeyDown); //通过preview dom 提前拦截keydown时间，避免其他组件（如Dialog调用）\n};\n\nconst bindKeyDown = (e) => {\n\tif(e.keyCode === KEYS.LeftArrow){\n\t\te.stopPropagation();\n\t\tnavTo(true);\n\t}\n\tif(e.keyCode === KEYS.RightArrow){\n\t\te.stopPropagation();\n\t\tnavTo(false);\n\t}\n\tif(e.keyCode === KEYS.Esc){\n\t\tif(destroy()){\n\t\t\te.stopPropagation();\n\t\t}\n\t}\n}\n\nlet resize_tm = null;\nconst onWinResize = () => {\n\tresize_tm && clearTimeout(resize_tm);\n\tresize_tm = setTimeout(() => {\n\t\tresetView();\n\t}, 50);\n};\n\n/**\n * 重置视图\n */\nconst resetView = () => {\n\tlet img = PREVIEW_DOM.querySelector('.civ-img img');\n\tif(!img){\n\t\treturn;\n\t}\n\tlet container = PREVIEW_DOM.querySelector('.civ-img');\n\tsetStyle(img, scaleFixCenter({\n\t\tcontentWidth: img.getAttribute(ATTR_W_BIND_KEY),\n\t\tcontentHeight: img.getAttribute(ATTR_H_BIND_KEY),\n\t\tcontainerWidth: container.offsetWidth,\n\t\tcontainerHeight: container.offsetHeight,\n\t\tspacing: DEFAULT_VIEW_PADDING\n\t}));\n\tsetStyle(img, {marginLeft: 0, marginTop: 0})\n}\n\n/**\n * 图片切换\n * @param {Boolean} toPrev 是否切换到上一张\n * @return {boolean}\n */\nconst navTo = (toPrev = false) => {\n\tlet total = IMG_SRC_LIST.length;\n\tif((toPrev && IMG_CURRENT_INDEX === 0) || (!toPrev && IMG_CURRENT_INDEX === (total - 1))){\n\t\treturn false;\n\t}\n\ttoPrev ? IMG_CURRENT_INDEX-- : IMG_CURRENT_INDEX++;\n\tshowImgSrc(IMG_CURRENT_INDEX);\n\tupdateNavState();\n}\n\nconst switchTo = (index) => {\n\tIMG_CURRENT_INDEX = index;\n\tshowImgSrc(IMG_CURRENT_INDEX);\n\tupdateNavState();\n}\n\n/**\n * 横向滚动\n * @param {Boolean} toPrev 向左true，向右false\n * @param {Number} offset 滚动幅度\n */\nconst thumbScroll = (toPrev, offset = 200) => {\n\tlet thumb_wrap = findOne('.civ-nav-list-wrap', PREVIEW_DOM);\n\tlet thumb_list = findOne('.civ-nav-list', PREVIEW_DOM);\n\tlet max_scroll_left = thumb_list.scrollWidth - thumb_wrap.offsetWidth;\n\tlet scroll_left = thumb_wrap.scrollLeft + (toPrev ? -1 : 1) * offset;\n\tthumb_wrap.scrollLeft = Math.max(Math.min(scroll_left, max_scroll_left), 0);\n}\n\n/**\n * 滚动到中间\n */\nconst thumbScrollIntoView = ()=>{\n\tlet current = findOne('.civ-nav-list .active', PREVIEW_DOM);\n\tcurrent.scrollIntoView();\n}\n\n/**\n * 缩放\n * @param {Number} ratioOffset 缩放比率(原尺寸百分比）\n */\nconst zoom = (ratioOffset) => {\n\tlet img = PREVIEW_DOM.querySelector('.civ-img img');\n\tlet origin_width = img.getAttribute(ATTR_W_BIND_KEY);\n\tlet origin_height = img.getAttribute(ATTR_H_BIND_KEY);\n\n\tif(ratioOffset === null){\n\t\tratioOffset = 1;\n\t\timg.style.left = dimension2Style(parseInt(img.style.left, 10) * ratioOffset);\n\t\timg.style.top = dimension2Style(parseInt(img.style.top, 10) * ratioOffset);\n\t\timg.style.width = dimension2Style(parseInt(origin_width, 10) * ratioOffset);\n\t\timg.style.height = dimension2Style(parseInt(origin_height, 10) * ratioOffset);\n\t\treturn;\n\t}\n\n\tlet width = parseInt(img.style.width, 10) * ratioOffset;\n\tlet height = parseInt(img.style.height, 10) * ratioOffset;\n\n\t//zoom in ratio limited\n\tif(ratioOffset > 1 && width > origin_width && ((width / origin_width) > MAX_ZOOM_IN_RATIO || (height / origin_height) > MAX_ZOOM_IN_RATIO)){\n\t\tconsole.warn('zoom in limited');\n\t\treturn;\n\t}\n\n\t//限制任何一边小于最小值\n\tif(ratioOffset < 1 && width < origin_width && (width < MIN_ZOOM_OUT_SIZE || height < MIN_ZOOM_OUT_SIZE)){\n\t\tconsole.warn('zoom out limited');\n\t\treturn;\n\t}\n\n\timg.style.left = dimension2Style(parseInt(img.style.left, 10) * ratioOffset);\n\timg.style.top = dimension2Style(parseInt(img.style.top, 10) * ratioOffset);\n\timg.style.width = dimension2Style(parseInt(img.style.width, 10) * ratioOffset);\n\timg.style.height = dimension2Style(parseInt(img.style.height, 10) * ratioOffset);\n}\n\nconst rotate = (degreeOffset) => {\n\tlet img = PREVIEW_DOM.querySelector('.civ-img img');\n\tlet rotate = parseInt(img.getAttribute('data-rotate') || 0, 10);\n\tlet newRotate = rotate + degreeOffset;\n\timg.setAttribute('data-rotate', newRotate);\n\timg.style.transform = `translate(-50%, -50%) rotate(${newRotate}deg)`;\n}\n\nconst viewOriginal = () => {\n\twindow.open(srcSetResolve(IMG_SRC_LIST[IMG_CURRENT_INDEX]).original);\n};\n\nconst showOptionDialog = () => {\n\tlet html = `\n<ul class=\"${DOM_CLASS}-option-list\">\n\t<li>\n\t\t<label>界面：</label>\n\t\t<label style=\"display:none\" title=\"该选项不启用，操作不闭环\">\n\t\t\t<input type=\"checkbox\" name=\"show_toolbar\" value=\"1\">显示顶部操作栏\n\t\t</label>\n\t\t<label>\n\t\t\t<input type=\"checkbox\" name=\"show_thumb_list\" value=\"1\">显示底部缩略图列表（多图模式）\n\t\t</label>\n\t</li>\t\n\t<li>\n\t\t<label>鼠标滚轮：</label>\n\t\t<label><input type=\"radio\" name=\"mouse_scroll_type\" value=\"${IMG_PREVIEW_MS_SCROLL_TYPE_NAV}\">切换前一张、后一张图片</label>\n\t\t<label><input type=\"radio\" name=\"mouse_scroll_type\" value=\"${IMG_PREVIEW_MS_SCROLL_TYPE_SCALE}\">缩放图片</label>\n\t\t<label><input type=\"radio\" name=\"mouse_scroll_type\" value=\"${IMG_PREVIEW_MS_SCROLL_TYPE_NONE}\">无动作</label>\n\t</li>\n\t<li>\n\t\t<label>移动：</label>\n\t\t<label><input type=\"checkbox\" name=\"allow_move\" value=\"1\">允许移动图片</label>\n\t</li>\n</ul>\n\t`\n\tlet dlg = Dialog.show('设置', html, {\n\t\tmodal: true\n\t});\n\tdlg.dom.style.zIndex = OPTION_DLG_INDEX + \"\";\n\tlet lsSetterTip = null;\n\tformSync(dlg.dom, (name) => {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet tmp = convertObjectToFormData({[name]: LocalSetting.get(name)});\n\t\t\tresolve(tmp[name]);\n\t\t});\n\t}, (name, value) => {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet obj = convertFormDataToObject({[name]: value}, DEFAULT_SETTING);\n\t\t\tLocalSetting.set(name, obj[name]);\n\t\t\tlsSetterTip && lsSetterTip.hide();\n\t\t\tlsSetterTip = Toast.showSuccess('设置已保存');\n\t\t\tresolve();\n\t\t});\n\t});\n}\n\nconst ALL_COMMANDS = [\n\tCMD_CLOSE,\n\tCMD_NAV_TO,\n\tCMD_SWITCH_TO,\n\tCMD_THUMB_SCROLL_PREV,\n\tCMD_THUMB_SCROLL_NEXT,\n\tCMD_ZOOM_OUT,\n\tCMD_ZOOM_IN,\n\tCMD_ZOOM_ORG,\n\tCMD_ROTATE_LEFT,\n\tCMD_ROTATE_RIGHT,\n\tCMD_VIEW_ORG,\n\tCMD_DOWNLOAD,\n\tCMD_OPTION,\n];\n\nconst TOOLBAR_OPTIONS = [\n\tCMD_ZOOM_OUT,\n\tCMD_ZOOM_IN,\n\tCMD_ZOOM_ORG,\n\tCMD_ROTATE_LEFT,\n\tCMD_ROTATE_RIGHT,\n\tCMD_VIEW_ORG,\n\t// CMD_DOWNLOAD,\n\tCMD_OPTION\n];\n\n/**\n * 获取命令信息\n * @param {String} id\n * @return {null|Object}\n */\nconst getCmdViaID = (id) => {\n\tfor(let k in ALL_COMMANDS){\n\t\tlet [_id] = ALL_COMMANDS[k];\n\t\tif(id === _id){\n\t\t\treturn ALL_COMMANDS[k];\n\t\t}\n\t}\n\treturn null;\n}\n\n\n/**\n * 初始化\n * @param {Object} option\n * @param {Number} option.mode 显示模式：IMG_PREVIEW_MODE_SINGLE 单图模式，IMG_PREVIEW_MODE_MULTIPLE 多图模式\n * @param {String[]} option.srcList 图片列表，单图或者多图模式都需要以数组方式传参\n * @param {Boolean} option.showToolbar 是否显示选项条（缺省使用默认配置）\n * @param {Boolean} option.showThumbList [多图模式]是否显示缩略图列表（缺省使用默认配置）\n * @param {Number|0} option.mouse_scroll_type 鼠标滚动控制类型：IMG_PREVIEW_MS_SCROLL_TYPE_NONE，IMG_PREVIEW_MS_SCROLL_TYPE_SCALE，IMG_PREVIEW_MS_SCROLL_TYPE_NAV（缺省使用默认配置）\n * @param {Number|0} option.startIndex [多图模式]开始图片索引\n * @param {Boolean} option.preloadSrcList [多图模式]是否预加载列表\n */\nconst init = ({\n\t              mode,\n\t              srcList,\n\t              mouse_scroll_type = IMG_PREVIEW_MS_SCROLL_TYPE_NAV,\n\t              startIndex = 0,\n\t              showContextMenu = null,\n\t              showToolbar = null,\n\t              showThumbList = null,\n\t              preloadSrcList = null,\n              }) => {\n\tdestroy();\n\tCURRENT_MODE = mode;\n\tIMG_SRC_LIST = srcList;\n\tIMG_CURRENT_INDEX = startIndex;\n\n\tmouse_scroll_type !== null && LocalSetting.set('mouse_scroll_type', mouse_scroll_type);\n\tshowThumbList !== null && LocalSetting.set('show_thumb_list', showThumbList);\n\tshowToolbar !== null && LocalSetting.set('show_toolbar', showToolbar);\n\n\tconstructDom();\n\tshowImgSrc(IMG_CURRENT_INDEX).finally(() => {\n\t\tif(preloadSrcList){\n\t\t\tsrcList.forEach(src => {\n\t\t\t\tnew Image().src = src\n\t\t\t});\n\t\t}\n\t});\n\tif(mode === IMG_PREVIEW_MODE_MULTIPLE){\n\t\tsetTimeout(updateNavState, 100);\n\t}\n}\n\n/**\n * 显示单张图片预览\n * @param {String} imgSrc\n * @param {Object} option\n */\nconst showImgPreview = CONTEXT_WINDOW[COM_ID]['showImgPreview'] || function(imgSrc, option = {}){\n\tinit({mode: IMG_PREVIEW_MODE_SINGLE, srcList: [imgSrc], ...option});\n}\n\n/**\n * 显示多图预览\n * @param {String[]} imgSrcList\n * @param {Number} startIndex\n * @param {Object} option\n */\nconst showImgListPreview = CONTEXT_WINDOW[COM_ID]['showImgListPreview'] || function(imgSrcList, startIndex = 0, option = {}){\n\tinit({mode: IMG_PREVIEW_MODE_MULTIPLE, srcList: imgSrcList, startIndex, ...option});\n}\n\n/**\n * 通过绑定节点显示图片预览\n * @param {String} nodeSelector 触发绑定的节点选择器，可以是img本身节点，也可以是其他代理节点\n * @param {String} triggerEvent\n * @param {String|Function} srcFetcher 获取大图src的选择器，或者函数，如果是函数传入第一个参数为触发节点\n * @param {Object} option\n */\nconst bindImgPreviewViaSelector = (nodeSelector = 'img', triggerEvent = 'click', srcFetcher = 'src', option = {}) => {\n\tlet nodes = findAll(nodeSelector);\n\tlet imgSrcList = [];\n\tif(!nodes.length){\n\t\tconsole.warn('no images found');\n\t\treturn;\n\t}\n\tnodes.forEach((node, idx) => {\n\t\tswitch(typeof (srcFetcher)){\n\t\t\tcase 'function':\n\t\t\t\timgSrcList.push(srcFetcher(node));\n\t\t\t\tbreak;\n\t\t\tcase 'string':\n\t\t\t\timgSrcList.push(node.getAttribute(srcFetcher));\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow \"No support srcFetcher types:\" + typeof (srcFetcher);\n\t\t}\n\t\tnode.addEventListener(triggerEvent, e => {\n\t\t\tif(nodes.length > 1){\n\t\t\t\tshowImgListPreview(imgSrcList, idx, option);\n\t\t\t}else{\n\t\t\t\tshowImgPreview(imgSrcList[0], option);\n\t\t\t}\n\t\t})\n\t});\n}\n\nwindow[COM_ID] = {\n\tshowImgPreview,\n\tshowImgListPreview,\n\tbindImgPreviewViaSelector,\n};\n\nlet showImgPreviewFn = CONTEXT_WINDOW[COM_ID]['showImgPreview'] || showImgPreview;\nlet showImgListPreviewFn = CONTEXT_WINDOW[COM_ID]['showImgListPreview'] || showImgListPreview;\n\nexport {\n\tshowImgPreviewFn as showImgPreview,\n\tshowImgListPreviewFn as showImgListPreview,\n\tbindImgPreviewViaSelector,\n}\n","import {getHighestResFromSrcSet} from \"../Lang/Img.js\";\nimport {showImgListPreview, showImgPreview} from \"../Widget/ImgPreview.js\";\nimport {eventDelegate} from \"../Lang/Event.js\";\nimport {findAll} from \"../Lang/Dom.js\";\n\n/**\n * 提取节点图片源\n * @param node\n * @returns {string}\n */\nconst resolveSrc = (node) => {\n\tlet src = node.dataset.src;\n\t//src获取优先级：param.src > img[data-src] > img[srcset] > img[src]\n\tif(node.tagName === 'IMG'){\n\t\tif(!src && node.srcset){\n\t\t\tsrc = getHighestResFromSrcSet(node.srcset);\n\t\t}\n\t\tsrc = src || node.src;\n\t}else if(!src && node.tagName === 'A'){\n\t\tsrc = node.href;\n\t}\n\treturn src;\n}\n\n/**\n * 图片预览\n * 调用方式① 父容器模式：[data-preview-watch=\"img\"]\n * 调用方式② 图片节点模式：img[src][data-preview-selector=\".all-img\"]\n */\nexport class ACPreview {\n\tstatic active(node, param = {}){\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet watchSelector = param.watch;\n\t\t\tif(watchSelector){\n\t\t\t\teventDelegate(node, watchSelector, 'click', (e, clickNode)=>{\n\t\t\t\t\tlet index = 0, imgSrcList = [];\n\t\t\t\t\tnode.querySelectorAll(watchSelector).forEach((n, idx) => {\n\t\t\t\t\t\tif(node === clickNode){\n\t\t\t\t\t\t\tindex = idx;\n\t\t\t\t\t\t}\n\t\t\t\t\t\timgSrcList.push(resolveSrc(clickNode));\n\t\t\t\t\t});\n\t\t\t\t\tshowImgListPreview(imgSrcList, index);\n\t\t\t\t});\n\t\t\t\tresolve();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet src = param.src || resolveSrc(node);\n\t\t\tlet selector = param.selector;\n\t\t\tif(!src){\n\t\t\t\tconsole.warn('image preview src empty', node);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(selector){\n\t\t\t\tlet index = 0, imgSrcList = [];\n\t\t\t\tfindAll(selector).forEach((n, idx) => {\n\t\t\t\t\tif(node === n){\n\t\t\t\t\t\tindex = idx;\n\t\t\t\t\t}\n\t\t\t\t\timgSrcList.push(resolveSrc(n));\n\t\t\t\t});\n\t\t\t\tshowImgListPreview(imgSrcList, index);\n\t\t\t}else{\n\t\t\t\tshowImgPreview(src);\n\t\t\t}\n\t\t\tresolve();\n\t\t});\n\t}\n}\n","import {Theme} from \"./Theme.js\";\nimport {createDomByHtml, domContained, getDomOffset, hide, insertStyleSheet, remove, show} from \"../Lang/Dom.js\";\nimport {guid} from \"../Lang/Util.js\";\nimport {bindNodeActive, BizEvent, KEYS, triggerDomEvent} from \"../Lang/Event.js\";\nimport {arrayDistinct} from \"../Lang/Array.js\";\nimport {dimension2Style, escapeAttr, escapeHtml, highlightText} from \"../Lang/Html.js\";\n\nconst COM_ID = Theme.Namespace + 'select';\nconst CLASS_PREFIX = COM_ID;\n\ninsertStyleSheet(`\n\t.${CLASS_PREFIX}-panel{\n\t\t${Theme.CssVarPrefix}sel-panel-max-width:20em;\n\t\t${Theme.CssVarPrefix}sel-list-max-height:15em;\n\t\t${Theme.CssVarPrefix}sel-item-matched-color:orange;\n\t\t${Theme.CssVarPrefix}sel-item-matched-font-weight:bold;\n\t\t${Theme.CssVarPrefix}sel-item-hover-bg:#eeeeee;\n\t\t${Theme.CssVarPrefix}sel-item-selected-bg:#abc9e140;\n\t\t\n\t\tmax-width:var(${Theme.CssVarPrefix}sel-panel-max-width);\n\t\tbackground-color:var(${Theme.CssVar.BACKGROUND_COLOR});\n\t\tborder:var(${Theme.CssVar.PANEL_BORDER});\n\t\tpadding:.2em 0;\n\t\tbox-sizing:border-box;\n\t\tbox-shadow:var(${Theme.CssVar.PANEL_SHADOW});\n\t\tborder-radius:var(${Theme.CssVar.PANEL_RADIUS});\n\t\tposition:absolute;\n\t\tz-index:1;\n\t}\n\t\n\t.${CLASS_PREFIX}-panel .${CLASS_PREFIX}-search{padding:0.5em;}\n\t.${CLASS_PREFIX}-panel input[type=search]{\n\t\twidth:100%;\n\t\tpadding:0.5em;\n\t\tborder:none;\n\t\tborder-bottom:1px solid #dddddd;\n\t\toutline:none;\n\t\tbox-shadow:none;\n\t\ttransition:border 0.1s linear;\n\t}\n\t.${CLASS_PREFIX}-panel input[type=search]:focus{\n\t\tborder-color:gray;\n\t}\n\t\n\t.${CLASS_PREFIX}-list{\n\t\tlist-style:none;\n\t\tmax-height:var(${Theme.CssVarPrefix}sel-list-max-height);\n\t\toverflow:auto;\n\t}\n\t\n\t.${CLASS_PREFIX}-list .sel-item{\n\t\tmargin:1px 0;\n\t}\n\t\n\t.${CLASS_PREFIX}-list .sel-chk{\n\t\topacity:0;\n\t\twidth:1em;\n\t\theight:1em;\n\t\tposition:absolute;\n\t\tmargin:0.05em 0 0 -1.25em;\n\t}\n\t\n\t.${CLASS_PREFIX}-list .sel-chk:before{\n\t\tcontent:\"\\\\e624\";\n\t\tfont-family:\"${Theme.IconFont}\", serif;\n\t}\n\t\n\t.${CLASS_PREFIX}-list .matched{\n\t\tcolor:var(${Theme.CssVarPrefix}sel-item-matched-color);\n\t\tfont-weight:var(${Theme.CssVarPrefix}sel-item-matched-font-weight);\n\t}\n\t\n\t.${CLASS_PREFIX}-list input{display:block;position:absolute;z-index:1;left:-2em;top:0;opacity:0;}\n\t.${CLASS_PREFIX}-list .ti-wrap{cursor:pointer;position:relative;display:block;padding:.35em .5em .35em 2em;user-select:none;transition:all 0.1s linear;}\n\t.${CLASS_PREFIX}-list ul .ti-wrap{padding-left:2.25em;display:block; padding-left:3.5em;}\n\t\n\t.${CLASS_PREFIX}-list label{\n\t\tdisplay:block;\n\t\toverflow:hidden;\n\t\tposition:relative;\n\t}\n\t.${CLASS_PREFIX}-list label:hover .ti-wrap{\n\t\tbackground:var(${Theme.CssVarPrefix}sel-item-hover-bg);\n\t\ttext-shadow:1px 1px 1px white;\n\t}\n\t\n\t.${CLASS_PREFIX}-list li[data-group-title]:before{\n\t\tcontent:attr(data-group-title) \" -\";\n\t\tcolor:gray;\n\t\tdisplay:block;\n\t\tpadding:0.25em .5em .25em 2em;\n\t}\n\t\n\t/** checked **/\n\t.${CLASS_PREFIX}-list input:checked ~ .ti-wrap{\n\t\tbackground-color:var(${Theme.CssVarPrefix}sel-item-selected-bg);\n\t}\n\t\n\t.${CLASS_PREFIX}-list input:checked ~ .ti-wrap .sel-chk{\n\t\topacity:1;\n\t}\n\t\n\t/** disabled **/\n\t.${CLASS_PREFIX}-list input:disabled ~ .ti-wrap{\n\t\topacity:0.5;\n\t\tcursor:default;\n\t\tbackground-color:transparent\n\t}\n\t.${CLASS_PREFIX}-list input:disabled ~ .ti-wrap .sel-chk{\n\t\topacity:.1;\n\t}\n`, COM_ID + '-style');\n\n/**\n * @param sel\n * @return {{values: String[], options: Option[], selectedIndexes: Number[]}}\n */\nconst resolveSelectOptions = (sel) => {\n\tlet options = [\n\t\t// {title, value, disabled, selected},\n\t\t// {title, options:[{title, value},...], disabled, selected},\n\t];\n\tlet values = [];\n\tlet selectedIndexes = [];\n\tsel.childNodes.forEach(node => {\n\t\tif(node.nodeType !== 1){\n\t\t\treturn;\n\t\t}\n\t\tif(node.tagName === 'OPTION'){\n\t\t\toptions.push(new Option({\n\t\t\t\ttitle: node.innerText,\n\t\t\t\tvalue: node.value,\n\t\t\t\tdisabled: node.disabled,\n\t\t\t\tselected: node.selected,\n\t\t\t\tindex: node.index,\n\t\t\t}));\n\t\t\tif(node.selected){\n\t\t\t\tvalues.push(node.value);\n\t\t\t\tselectedIndexes.push(node.index);\n\t\t\t}\n\t\t}else if(node.tagName === 'OPTGROUP'){\n\t\t\tlet opt_group = new Option({title: node.label});\n\t\t\tnode.childNodes.forEach(child => {\n\t\t\t\tif(child.nodeType !== 1){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\topt_group.options.push(new Option({\n\t\t\t\t\ttitle: child.innerText,\n\t\t\t\t\tvalue: child.value,\n\t\t\t\t\tdisabled: child.disabled,\n\t\t\t\t\tselected: child.selected,\n\t\t\t\t\tindex: child.index,\n\t\t\t\t}));\n\t\t\t\tif(child.selected){\n\t\t\t\t\tvalues.push(child.value);\n\t\t\t\t\tselectedIndexes.push(child.index);\n\t\t\t\t}\n\t\t\t});\n\t\t\toptions.push(opt_group);\n\t\t}\n\t});\n\treturn {options, values, selectedIndexes};\n}\n\n/**\n * 从 <datalist> 对象中解析 option 列表\n * @param {HTMLDataListElement} datalistEl\n * @param {Null|String} initValue 初始值，Null 表示没有初始值\n * @return {Option[]}\n */\nconst resolveListOption = (datalistEl, initValue = null) => {\n\tlet options = [];\n\tlet alreadySelected = false;\n\tArray.from(datalistEl.options).forEach((option, index) => {\n\t\tlet title = option.innerText;\n\t\tlet value = option.hasAttribute('value') ? option.getAttribute('value') : option.innerText;\n\t\tlet selected = !alreadySelected && initValue !== null && value === initValue;\n\t\toptions.push({title, value, disabled: false, selected, index});\n\t});\n\treturn options;\n}\n\n/**\n * 渲染单个 checkbox 或 radio\n * @param name\n * @param multiple\n * @param option\n * @return {String} input html\n */\nconst renderItemChecker = (name, multiple, option) => {\n\treturn `<input type=\"${multiple ? 'checkbox' : 'radio'}\" \n\t\ttabindex=\"-1\"\n\t\tname=\"${name}\" \n\t\tvalue=\"${escapeAttr(option.value)}\" \n\t\t${option.selected ? 'checked' : ''} \n\t\t${option.disabled ? 'disabled' : ''}/>\n\t`\n}\n\n/**\n * 创建面板 DOM\n * @param config\n * @return {HTMLElement|HTMLElement[]}\n */\nconst createPanel = (config) => {\n\tlet list_html = `<ul class=\"${CLASS_PREFIX}-list\">`;\n\tconfig.options.forEach(option => {\n\t\tif(option.options && option.options.length){\n\t\t\tlist_html += `<li data-group-title=\"${escapeAttr(option.title)}\" class=\"sel-group\"><ul>`;\n\t\t\toption.options.forEach(childOption => {\n\t\t\t\tlist_html += `<li class=\"sel-item\" tabindex=\"0\">\n\t\t\t\t\t\t\t\t\t<label title=\"${escapeAttr(childOption.title)}\" tabindex=\"0\">\n\t\t\t\t\t\t\t\t\t\t${renderItemChecker(config.name, config.multiple, childOption)} \n\t\t\t\t\t\t\t\t\t\t<span class=\"ti-wrap\">\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"sel-chk\"></span> \n\t\t\t\t\t\t\t\t\t\t\t<span class=\"ti\">${escapeHtml(childOption.title)}</span>\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t</li>`\n\t\t\t})\n\t\t\tlist_html += `</ul></li>`;\n\t\t}else{\n\t\t\tlist_html += `<li class=\"sel-item\" tabindex=\"0\">\n\t\t\t\t\t\t\t<label title=\"${escapeAttr(option.title)}\">\n\t\t\t\t\t\t\t\t${renderItemChecker(config.name, config.multiple, option)} \n\t\t\t\t\t\t\t\t<span class=\"ti-wrap\">\n\t\t\t\t\t\t\t\t\t<span class=\"sel-chk\"></span> \n\t\t\t\t\t\t\t\t\t<span class=\"ti\">${escapeHtml(option.title)}</span>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</li>`\n\t\t}\n\t});\n\tlist_html += '</ul>';\n\treturn createDomByHtml(`\n\t\t<div class=\"${CLASS_PREFIX}-panel\" style=\"display:none;\">\n\t\t\t<div class=\"${CLASS_PREFIX}-search\" style=\"${config.displaySearchInput ? '' : 'display:none'}\">\n\t\t\t\t<input type=\"search\" placeholder=\"过滤...\" aria-label=\"过滤选项\">\n\t\t\t</div>\n\t\t\t${list_html}\n\t\t</div>\n\t`, document.body);\n}\n\nconst tabNav = (liList, dir) => {\n\tlet currentIndex = -1;\n\tliList.forEach((li, idx) => {\n\t\tif(li === document.activeElement){\n\t\t\tcurrentIndex = idx;\n\t\t}\n\t});\n\tif(dir > 0){\n\t\tcurrentIndex = currentIndex < (liList.length - 1) ? (currentIndex + 1) : 0;\n\t}else{\n\t\tcurrentIndex = currentIndex <= 0 ? (liList.length - 1) : (currentIndex - 1);\n\t}\n\tliList.forEach((li, idx) => {\n\t\tif(idx === currentIndex){\n\t\t\tli.focus();\n\t\t}\n\t});\n}\n\nclass Option {\n\tconstructor(param){\n\t\tfor(let i in param){\n\t\t\tthis[i] = param[i];\n\t\t}\n\t}\n\n\t/** @type {string} */\n\ttitle = '';\n\n\t/** @type {string} */\n\tvalue = '';\n\n\t/** @type {Boolean} */\n\tdisabled = false;\n\n\t/** @type {Boolean} */\n\tselected = false;\n\n\t/** @type {Number} */\n\tindex = 0;\n\n\t/** @type {Option[]} */\n\toptions = [];\n}\n\nclass Select {\n\tconfig = {\n\t\tname: \"\",\n\t\trequired: false,\n\t\tmultiple: false,\n\t\tplaceholder: '',\n\n\t\tdisplaySearchInput: true, //是否显示搜索输入框\n\t\thideNoMatchItems: true, //隐藏未匹配的搜索结果项目\n\n\t\t/** @type {Option[]} options */\n\t\toptions: []\n\t};\n\tpanelEl = null;\n\tsearchEl = null;\n\tonChange = new BizEvent();\n\n\tconstructor(config){\n\t\tthis.config = Object.assign(this.config, config);\n\t\tthis.config.name = this.config.name || COM_ID + guid();\n\t\tthis.panelEl = createPanel(this.config);\n\t\tthis.searchEl = this.panelEl.querySelector('input[type=search]');\n\n\t\t//checkbox change\n\t\tthis.panelEl.querySelectorAll(`.${CLASS_PREFIX}-list input`).forEach(chk => {\n\t\t\tchk.addEventListener('change', () => {\n\t\t\t\tthis.onChange.fire();\n\t\t\t})\n\t\t});\n\n\t\t//search\n\t\tthis.searchEl.addEventListener('input', () => {\n\t\t\tthis.search(this.searchEl.value);\n\t\t});\n\n\t\t//nav\n\t\tthis.searchEl.addEventListener('keydown', e => {\n\t\t\tif(e.keyCode === KEYS.UpArrow){\n\t\t\t\ttabNav(liElList, false);\n\t\t\t}else if(e.keyCode === KEYS.DownArrow){\n\t\t\t\ttabNav(liElList, true);\n\t\t\t}\n\t\t})\n\n\t\t//li click, enter\n\t\tlet liElList = this.panelEl.querySelectorAll(`.${CLASS_PREFIX}-list .sel-item`);\n\t\tliElList.forEach(li => {\n\t\t\tbindNodeActive(li, e => {\n\t\t\t\tif(e.type !== 'click'){\n\t\t\t\t\tlet chk = li.querySelector('input');\n\t\t\t\t\tchk.checked ? chk.removeAttribute('checked') : chk.checked = true;\n\t\t\t\t\tthis.onChange.fire();\n\t\t\t\t}\n\t\t\t\t!this.config.multiple && this.hidePanel();\n\t\t\t});\n\t\t\tli.addEventListener('keydown', e => {\n\t\t\t\tif(e.keyCode === KEYS.UpArrow){\n\t\t\t\t\ttabNav(liElList, false);\n\t\t\t\t}else if(e.keyCode === KEYS.DownArrow){\n\t\t\t\t\ttabNav(liElList, true);\n\t\t\t\t}\n\t\t\t})\n\t\t});\n\t}\n\n\tisShown(){\n\t\treturn this.panelEl.style.display !== 'none';\n\t}\n\n\tsearch(kw){\n\t\tthis.searchEl.value = kw;\n\t\tlet liEls = this.panelEl.querySelectorAll(`.${CLASS_PREFIX}-list .sel-item`);\n\t\tlet firstMatchedItem = null;\n\t\tliEls.forEach(li => {\n\t\t\tthis.config.hideNoMatchItems && hide(li);\n\t\t\tlet title = li.querySelector('label').title;\n\t\t\tli.blur();\n\t\t\tli.querySelector('.ti').innerHTML = highlightText(title, kw);\n\t\t\tif(!kw || title.toLowerCase().indexOf(kw.trim().toLowerCase()) >= 0){\n\t\t\t\tthis.config.hideNoMatchItems && show(li);\n\t\t\t\tif(!firstMatchedItem){\n\t\t\t\t\tfirstMatchedItem = li;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tif(firstMatchedItem){\n\t\t\tfirstMatchedItem.scrollIntoView({behavior: 'smooth'});\n\t\t}\n\t}\n\n\t/**\n\t * 以index方式设置选中项\n\t * @param {Number[]} selectedIndexList\n\t */\n\tselectByIndex(selectedIndexList){\n\t\tthis.panelEl.querySelectorAll(`.${CLASS_PREFIX}-list input`).forEach((chk, idx) => {\n\t\t\tchk.checked = selectedIndexList.includes(idx);\n\t\t});\n\t}\n\n\t/**\n\t * 使用传值方式设置选中项目（该方法可能存在多个相同值的情况导致误选）\n\t * @param values\n\t */\n\tselectByValues(values){\n\t\tthis.panelEl.querySelectorAll(`.${CLASS_PREFIX}-list input`).forEach((chk, idx) => {\n\t\t\tchk.checked = values.includes(chk.value);\n\t\t});\n\t}\n\n\t/**\n\t * 获取值，这里没有区分多选还是单选，统一返回数组，返回值会去重\n\t * @return {String[]}\n\t */\n\tgetValues(){\n\t\tlet values = [];\n\t\tlet tmp = this.panelEl.querySelectorAll(`.${CLASS_PREFIX}-list input:checked`)\n\t\ttmp.forEach(chk => {\n\t\t\tvalues.push(chk.value);\n\t\t});\n\t\tvalues = arrayDistinct(values);\n\t\treturn values;\n\t}\n\n\t/**\n\t * 获取选中项索引值列表\n\t * @return {Number[]}\n\t */\n\tgetSelectedIndexes(){\n\t\tlet selectedIndexes = [];\n\t\tthis.panelEl.querySelectorAll(`.${CLASS_PREFIX}-list input`).forEach((chk, idx) => {\n\t\t\tif(chk.checked){\n\t\t\t\tselectedIndexes.push(idx);\n\t\t\t}\n\t\t});\n\t\treturn selectedIndexes;\n\t}\n\n\thidePanel(){\n\t\tif(this.panelEl){\n\t\t\tthis.panelEl.style.display = 'none';\n\t\t\tthis.search(\"\");\n\t\t}\n\t}\n\n\t/**\n\t * @param {Object|Null} pos\n\t * @param {Number} pos.top\n\t * @param {Number} pos.left\n\t */\n\tshowPanel(pos = {top: 0, left: 0}){\n\t\tthis.panelEl.style.display = '';\n\t\tif(pos){\n\t\t\tthis.panelEl.style.top = dimension2Style(pos.top);\n\t\t\tthis.panelEl.style.left = dimension2Style(pos.left);\n\t\t}\n\t\tthis.searchEl.focus();\n\t}\n\n\t/**\n\t * 绑定 select 元素使其触发行为变成Select组件\n\t * @todo 如果select required，浏览器触发的表单校验提示显示会被遮挡\n\t * @param {HTMLSelectElement} selectEl\n\t */\n\tstatic bindSelect(selectEl){\n\t\tlet {options} = resolveSelectOptions(selectEl);\n\t\tconst sel = new Select({\n\t\t\tname: selectEl.name,\n\t\t\trequired: selectEl.required,\n\t\t\tmultiple: selectEl.multiple,\n\t\t\tplaceholder: selectEl.getAttribute('placeholder'),\n\t\t\toptions\n\t\t});\n\t\tconst showSelect = () => {\n\t\t\tlet offset = getDomOffset(selectEl);\n\t\t\tsel.showPanel({top: offset.top + selectEl.offsetHeight, left: offset.left});\n\t\t}\n\t\tselectEl.addEventListener('invalid', ()=>{\n\t\t\tsel.hidePanel();\n\t\t});\n\t\tselectEl.addEventListener('input', ()=>{\n\t\t\tshowSelect();\n\t\t})\n\t\tsel.onChange.listen(() => {\n\t\t\tlet selectedIndexes = sel.getSelectedIndexes();\n\t\t\tselectEl.querySelectorAll('option').forEach((opt, idx) => {\n\t\t\t\topt.selected = selectedIndexes.includes(idx);\n\t\t\t});\n\t\t\ttriggerDomEvent(selectEl, 'change');\n\t\t});\n\t\tsel.panelEl.style.minWidth = dimension2Style(selectEl.offsetWidth);\n\n\n\t\tselectEl.addEventListener('keydown', e => {\n\t\t\tshowSelect();\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\treturn false;\n\t\t});\n\n\t\tselectEl.addEventListener('mousedown', e => {\n\t\t\tsel.isShown() ? sel.hidePanel() : showSelect();\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\treturn false;\n\t\t});\n\n\t\tselectEl.addEventListener('focus', showSelect);\n\t\tselectEl.addEventListener('change', () => {\n\t\t\tlet selectedIndexes = [];\n\t\t\tArray.from(selectEl.selectedOptions).forEach(opt => {\n\t\t\t\tselectedIndexes.push(opt.index);\n\t\t\t})\n\t\t\tsel.selectByIndex(selectedIndexes);\n\t\t});\n\n\t\tdocument.addEventListener('click', e => {\n\t\t\tif(!domContained(sel.panelEl, e.target, true) && !domContained(selectEl, e.target, true)){\n\t\t\t\tsel.hidePanel();\n\t\t\t}\n\t\t});\n\n\t\tdocument.addEventListener('keyup', e => {\n\t\t\tif(e.keyCode === KEYS.Esc){\n\t\t\t\tsel.hidePanel();\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * 绑定有关联 datalist 的输入框\n\t * @param {HTMLInputElement} inputEl\n\t * @param {Option[]} options 是否指定选项列表，默认从 input[list] 中读取\n\t */\n\tstatic bindTextInput(inputEl, options = null){\n\t\tif(!options){\n\t\t\tlet listTagId = inputEl.getAttribute('list');\n\t\t\tlet datalistEl = document.getElementById(listTagId);\n\t\t\tif(!datalistEl){\n\t\t\t\tthrow \"no datalist found: \" + inputEl.getAttribute('list');\n\t\t\t}\n\t\t\toptions = resolveListOption(datalistEl, inputEl.value);\n\t\t\tinputEl.removeAttribute('list');\n\t\t\tremove(datalistEl);\n\t\t}\n\t\tlet sel = new Select({\n\t\t\tname: inputEl.name,\n\t\t\trequired: inputEl.required,\n\t\t\tmultiple: false,\n\t\t\tdisplaySearchInput: false,\n\t\t\thideNoMatchItems: false,\n\t\t\tplaceholder: inputEl.getAttribute('placeholder'),\n\t\t\toptions\n\t\t});\n\t\tsel.onChange.listen(() => {\n\t\t\tinputEl.value = sel.getValues()[0];\n\t\t\ttriggerDomEvent(inputEl, 'change');\n\t\t});\n\t\tsel.panelEl.style.minWidth = dimension2Style(inputEl.offsetWidth);\n\n\t\tlet sh = () => {\n\t\t\tlet offset = getDomOffset(inputEl);\n\t\t\tsel.showPanel({top: offset.top + inputEl.offsetHeight, left: offset.left});\n\t\t}\n\n\t\tinputEl.addEventListener('focus', sh);\n\t\tinputEl.addEventListener('click', sh);\n\t\tinputEl.addEventListener('input', () => {\n\t\t\tsel.search(inputEl.value.trim());\n\t\t});\n\n\t\tdocument.addEventListener('click', e => {\n\t\t\tif(!domContained(sel.panelEl, e.target, true) && !domContained(inputEl, e.target, true)){\n\t\t\t\tsel.hidePanel();\n\t\t\t}\n\t\t});\n\n\t\tdocument.addEventListener('keyup', e => {\n\t\t\tif(e.keyCode === KEYS.Esc){\n\t\t\t\tsel.hidePanel();\n\t\t\t}\n\t\t});\n\t}\n}\n\nexport {Select}","import {Select} from \"../Widget/Select.js\";\n\n/**\n * 将 select 或者 input[list] 对象绑定使用 Select UI组件\n * 参数：\n * select\n * input[list]\n */\nexport class ACSelect {\n\tstatic init(node){\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif(node.tagName === 'SELECT'){\n\t\t\t\tSelect.bindSelect(node);\n\t\t\t\tresolve();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(node.tagName === 'INPUT' && node.list){\n\t\t\t\tSelect.bindTextInput(node);\n\t\t\t\tresolve();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\treject('node type no support');\n\t\t});\n\t}\n}","/**\n * 高亮内容\n * 参数：\n * *[data-highlight-keyword]\n * *[data-hl-kw]\n */\nimport {nodeHighlight} from \"../Lang/Dom.js\";\n\nexport class ACHighlight {\n\tstatic cssClass = 'highlight';\n\n\tstatic init(node, param = {}){\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet kw = (param.keyword || param.kw || '').trim();\n\t\t\tif(kw){\n\t\t\t\tnodeHighlight(node, kw, ACHighlight.cssClass);\n\t\t\t}\n\t\t\tresolve();\n\t\t});\n\t}\n}","import {findAll, findOne, onDomTreeChange} from \"../Lang/Dom.js\";\nimport {triggerDomEvent} from \"../Lang/Event.js\";\n\nconst SELECT_ALL_TEXT = '全选';\nconst UNSELECT_ALL_TEXT = '取消选择';\n\n/**\n * 全选功能按钮，逻辑为：全选|取消选择\n */\nexport class ACSelectAll {\n\tstatic init(node, param = {}){\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet checks = [];\n\t\t\tlet container = findOne(param.container || 'body');\n\t\t\tlet disableBtn = () => {\n\t\t\t\tnode.setAttribute('disabled', 'disabled');\n\t\t\t}\n\t\t\tlet enableBtn = () => {\n\t\t\t\tnode.removeAttribute('disabled');\n\t\t\t}\n\t\t\tlet updBtn = () => {\n\t\t\t\tlet checkedCount = 0;\n\t\t\t\tchecks.forEach(chk => {\n\t\t\t\t\tcheckedCount += chk.checked ? 1 : 0;\n\t\t\t\t});\n\t\t\t\tnode.innerHTML = checkedCount ? UNSELECT_ALL_TEXT : SELECT_ALL_TEXT;\n\t\t\t\tchecks.length ? enableBtn() : disableBtn();\n\t\t\t};\n\t\t\tonDomTreeChange(container, () => {\n\t\t\t\tchecks = findAll('input[type=checkbox]', container);\n\t\t\t\tchecks.forEach(chk => {\n\t\t\t\t\tif(chk.dataset.__bind_select_all){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tchk.dataset.__bind_select_all = \"1\";\n\t\t\t\t\tchk.addEventListener('change', updBtn);\n\t\t\t\t});\n\t\t\t\tupdBtn();\n\t\t\t});\n\n\t\t\tnode.addEventListener('click', e => {\n\t\t\t\tlet toCheck = node.innerHTML === SELECT_ALL_TEXT;\n\t\t\t\tchecks.forEach(chk => {\n\t\t\t\t\tchk.checked = toCheck;\n\t\t\t\t\ttriggerDomEvent(chk, 'change');\n\t\t\t\t});\n\t\t\t\tnode.innerHTML = toCheck ? UNSELECT_ALL_TEXT : SELECT_ALL_TEXT;\n\t\t\t});\n\n\t\t\tlet containerInit = () => {\n\t\t\t\tchecks = findAll('input[type=checkbox]', container);\n\t\t\t\tchecks.forEach(chk => {\n\t\t\t\t\tif(chk.dataset.__bind_select_all){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tchk.dataset.__bind_select_all = \"1\";\n\t\t\t\t\tchk.addEventListener('change', updBtn);\n\t\t\t\t});\n\t\t\t\tupdBtn();\n\t\t\t}\n\t\t\tonDomTreeChange(container, containerInit);\n\t\t\tcontainerInit();\n\t\t})\n\t}\n}\n","import {domChangedWatch, findOne} from \"../Lang/Dom.js\";\n/**\n * 多选关联，如多个checkbox必须至少存在一个选中项目，关联的按钮才允许被使用。\n * 参数：\n * *[data-multiselectrelate-container] 指定关联容器（会监听该容器dom变更）\n */\nexport class ACMultiSelectRelate {\n\tstatic init(button, param = {}){\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst container = findOne(param.container || 'body');\n\t\t\tconst disableBtn = () => {\n\t\t\t\tbutton.title = '请选择要操作的项目';\n\t\t\t\tbutton.setAttribute('disabled', 'disabled');\n\t\t\t\tbutton.classList.add('button-disabled');\n\t\t\t}\n\t\t\tconst enableBtn = () => {\n\t\t\t\tbutton.title = '';\n\t\t\t\tbutton.removeAttribute('disabled');\n\t\t\t\tbutton.classList.remove('button-disabled');\n\t\t\t}\n\t\t\tdomChangedWatch(container, 'input:checked', coll => {\n\t\t\t\tcoll.length ? enableBtn() : disableBtn()\n\t\t\t});\n\t\t})\n\t}\n}\n","import {createDomByHtml, findOne, insertStyleSheet} from \"../Lang/Dom.js\";\nimport {Theme} from \"./Theme.js\";\nimport {bindNodeActive, BizEvent, triggerDomEvent} from \"../Lang/Event.js\";\nimport {Toast} from \"./Toast.js\";\nimport {uploadFile} from \"../Lang/Net.js\";\n\nconst NS = Theme.Namespace + 'uploader';\ninsertStyleSheet(`\n\t.${NS}{display:inline-block;position:relative;background-color:#dddddd;width:80px;height:80px;overflow:hidden;}\n\t\n\t.${NS}-file{width:100%;height:100%;position:absolute;cursor:pointer;display:flex;align-items:center;}\n\t.${NS}-file:before{flex:1;font-family:WebCom-iconfont, serif;content:\"\\\\e9de\";font-size:30px;text-align:center;}\n\t.${NS}-file input[type=file]{position:absolute;width:1px;height:1px;left:0;top:0;opacity:0;}\n\t\n\t.${NS}[data-state=\"empty\"]{opacity:0.5}\n\t.${NS}[data-state=\"empty\"]:hover{opacity:1; transition:all 0.2s linear}\n\t\n\t.${NS}[data-state=\"empty\"] :is(.${NS}-handle,.${NS}-progress),\n\t.${NS}[data-state=\"pending\"] :is(.${NS}-btn-clean, .${NS}-file, .${NS}-content),\n\t.${NS}[data-state=\"error\"] :is(.${NS}-progress,.${NS}-btn-clean),\n\t.${NS}[data-state=\"normal\"] :is(.${NS}-progress,.${NS}-btn-cancel),\n\t.${NS}[data-state=\"normal\"] .${NS}-file:before{\n\t\tdisplay:none;\n\t}\n\t\n\t.${NS}-handle{width:100%;position:absolute;padding:.25em;text-align:right;box-sizing:border-box;bottom:0;}\n\t.${NS}-content{width:100%;height:100%;}\n\t.${NS}-content img{display:inline-block;width:100%;height:100%;object-fit:cover;}\n\t\n\t.${NS}-progress{width:100%;height:100%;padding:0 .5em;display:flex;flex-direction:column;box-sizing:border-box;justify-content:center;align-items:center;font-size:0.9em;color:gray;user-select:none;}\n\t.${NS}-progress progress{width:100%; transition:all 1s linear}\n\t\n\t.${NS}-btn{display:inline-block;user-select:none;cursor:pointer;color:white;text-shadow:1px 1px 1px gray;opacity:0.7;}\n\t.${NS}-btn:hover{opacity:1;}\n\t.${NS}-btn:before{content:\"\"; font-family:WebCom-iconfont, serif}\n\t.${NS}-btn-cancel:before{content:\"\\\\e61a\"}\n\t.${NS}-btn-clean:before{content:\"\\\\e61b\"}\n`);\n\nexport const UPLOADER_IMAGE_DEFAULT_CLASS = `${NS}-image`;\nexport const UPLOADER_FILE_DEFAULT_CLASS = `${NS}-file`;\n\nexport const UPLOAD_STATE_EMPTY = 'empty'; //空值情况\nexport const UPLOAD_STATE_PENDING = 'pending'; //上传中\nexport const UPLOAD_STATE_ERROR = 'error'; //上传失败\nexport const UPLOAD_STATE_NORMAL = 'normal'; //正常情况(有值)\n\nexport const FILE_TYPE_STATIC_IMAGE = ['image/png', 'image/jpeg', 'image/jpg', 'image/webp', 'image/bmp']; //常见静态图片\nexport const FILE_TYPE_IMAGE = ['image/*'];\nexport const FILE_TYPE_VIDEO = ['video/*'];\nexport const FILE_TYPE_AUDIO = ['audio/*'];\nexport const FILE_TYPE_DOCUMENT = ['.txt', '.md', '.doc', '.docx'];\nexport const FILE_TYPE_SHEET = ['.xls', '.xlsx', '.csv'];\nexport const FILE_TYPE_ZIP = ['.7z', '.zip', '.rar'];\n\n/**\n * 缺省请求处理方法\n * 接收后台返回格式为：{code, message, data:{name,value,thumb,error}} 格式\n * @param {String} url\n * @param {Object} fileMap\n * @param {Object} callbacks 回调函数合集对象\n * @param {Function} callbacks.onSuccess 成功回调\n * @param {Function} callbacks.onError 失败回调\n * @param {Function} callbacks.onAbort 中断回调\n * @param {Function} callbacks.onProgress 进度回调\n * @return {XMLHttpRequest}\n * @constructor\n */\nconst DEFAULT_REQUEST_HANDLE = (url, fileMap, callbacks) => {\n\treturn uploadFile(url, fileMap, {\n\t\tonSuccess: (rspJson) => {\n\t\t\tlet rspObj = JSON.parse(rspJson);\n\t\t\tif(rspObj.code !== 0){\n\t\t\t\treturn {error: rspObj.message};\n\t\t\t}\n\t\t\tcallbacks.onSuccess({\n\t\t\t\tvalue: rspObj.data.value,\n\t\t\t\tthumb: rspObj.data.thumb,\n\t\t\t\tname: rspObj.data.name,\n\t\t\t\terror: null\n\t\t\t});\n\t\t},\n\t\tonError: callbacks.onError,\n\t\tonAbort: callbacks.onAbort,\n\t\tonProgress: callbacks.onProgress\n\t});\n}\n\n/**\n * 合并非null值\n * @param {Object} target\n * @param {Object} source\n */\nconst mergeNoNull = (target, source) => {\n\tfor(let i in source){\n\t\tif(source[i] !== null){\n\t\t\ttarget[i] = source[i];\n\t\t}\n\t}\n}\n\n/**\n * 清空上传\n * @param {Uploader} up\n */\nconst cleanUpload = (up) => {\n\tupdateState(up, UPLOAD_STATE_EMPTY);\n}\n\n/**\n * 中断上传\n * @param {Uploader} up\n */\nconst abortUpload = up => {\n\ttry{\n\t\tup.xhr && up.xhr.abort()\n\t}catch(err){\n\t\tconsole.error(err)\n\t}\n\tupdateState(up, up.value ? UPLOAD_STATE_NORMAL : UPLOAD_STATE_EMPTY);\n}\n\n/**\n * 更新上传状态\n * @param {Uploader} up\n * @param {String} state\n * @param {*} data\n */\nconst updateState = (up, state, data = null) => {\n\tconst fileEl = findOne('input[type=file]', up.dom);\n\tconst contentCtn = findOne(`.${NS}-content`, up.dom);\n\tup.dom.setAttribute('data-state', state);\n\tup.dom.title = '';\n\tswitch(state){\n\t\tcase UPLOAD_STATE_EMPTY:\n\t\t\tfileEl.value = '';\n\t\t\tcontentCtn.innerHTML = '';\n\t\t\tup.onClean.fire();\n\t\t\tbreak;\n\n\t\tcase UPLOAD_STATE_PENDING:\n\t\t\tup.onUploading.fire();\n\t\t\tbreak;\n\n\t\tcase UPLOAD_STATE_NORMAL:\n\t\t\tfileEl.value = '';\n\t\t\tup.dom.title = up.name;\n\t\t\tcontentCtn.innerHTML = `<img alt=\"\" src=\"${up.thumb}\">`;\n\t\t\tup.onSuccess.fire({name: up.name, value: up.value, thumb: up.thumb});\n\t\t\tbreak;\n\n\t\tcase UPLOAD_STATE_ERROR:\n\t\t\tfileEl.value = '';\n\t\t\tupdateState(up, up.value ? UPLOAD_STATE_NORMAL : UPLOAD_STATE_EMPTY); //出现错误还原上一个状态\n\t\t\tconsole.error('Uploader Error:', data);\n\t\t\tup.onError.fire(data);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tthrow \"todo\";\n\t}\n}\n\n/**\n * 校验返回格式是否符合标准\n * @param response\n */\nconst responseFormatValidate = response => {\n\tlet vs = ['value', 'name', 'thumb', 'error'];\n\tif(typeof (response) !== 'object'){\n\t\tthrow `文件上传返回结果必须是对象，包含 ${vs.join('、')} 属性`;\n\t}\n\tlet objKeys = Object.keys(response);\n\tvs.forEach(v => {\n\t\tif(!objKeys.includes(v)){\n\t\t\tthrow `文件上传返回对象必须包含 ${v} 属性`;\n\t\t}\n\t});\n}\n\n/**\n * 上传组件\n */\nexport class Uploader {\n\tstate = UPLOAD_STATE_EMPTY;\n\txhr = null;\n\n\tdom = null; //组件节点\n\tvalue = null; //上传结果值\n\tthumb = ''; //上传结果缩略图URL\n\tname = ''; //上传结果名称\n\n\tonSuccess = new BizEvent();\n\tonAbort = new BizEvent();\n\tonUploading = new BizEvent();\n\tonClean = new BizEvent();\n\tonError = new BizEvent();\n\n\tstatic globalUploadUrl = null; //全局默认上传地址。如果option里面uploadUrl为空，则使用该配置\n\tstatic globalRequestHandle = DEFAULT_REQUEST_HANDLE; //默认请求方法，有需要可以指定\n\n\toption = {\n\t\tuploadUrl: null, //上传接口地址，缺省使用 globalUploadUrl\n\t\tuploadFileFieldName: 'file', //上传接口调用中文件名称对应变量名称\n\t\trequired: false, //上传组件是否必填\n\t\tallowFileTypes: [], //允许文件类型，格式为 input[type=file] 中的 accept 属性\n\t\tfileSizeLimit: 0, //允许最大上传文件大小\n\t\trequestHandle: null, //上传处理动作（方法请参考 uploadFile 函数），缺省使用 globalRequestHandle\n\t};\n\n\t/**\n\t * 通过input绑定文件上传，这个input可以是file，也可以是hidden\n\t * @param {HTMLFormElement} inputEl\n\t * @param {Object} initData\n\t * @param {Object} option\n\t * @return {Uploader}\n\t */\n\tstatic bindFileInput(inputEl, initData = {}, option = {}){\n\t\tlet name = initData.name || inputEl.name;\n\t\tlet value = initData.value || inputEl.value;\n\t\tlet accepts = inputEl.accept.split(',');\n\t\tlet virtualDom = document.createElement('span');\n\t\toption.required = inputEl.required;\n\t\tif(accepts.length){\n\t\t\toption.allowFileTypes = accepts;\n\t\t}\n\t\tinputEl.parentNode.insertBefore(virtualDom, inputEl.nextSibling);\n\t\tinputEl.required = false;\n\t\tinputEl.style.cssText = 'display:none';\n\t\tconst up = new Uploader(virtualDom, {name, value, thumb: initData.thumb}, option);\n\t\tup.onClean.listen(() => {\n\t\t\tinputEl.value = '';\n\t\t\ttriggerDomEvent(inputEl, 'change');\n\t\t});\n\t\tif(inputEl.type !== 'file'){\n\t\t\tup.onSuccess.listen(data => {\n\t\t\t\tinputEl.value = data.value;\n\t\t\t\ttriggerDomEvent(inputEl, 'change');\n\t\t\t})\n\t\t}\n\t\treturn up;\n\t}\n\n\t/**\n\t * 构造函数\n\t * @param {Node} container\n\t * @param {Object} initData 初始化数据（可为空）\n\t * @param {String} initData.value 初始化数据 - 值（可为空）\n\t * @param {String} initData.thumb 初始化数据 - 缩略图（可为空）\n\t * @param {String} initData.name 初始化数据 - 显示名称（可为空）\n\t * @param {Object} option\n\t * @param {String} option.uploadUrl\n\t * @param {Boolean} option.required\n\t * @param {Number} option.fileSizeLimit\n\t * @param {String[]} option.allowFileTypes\n\t */\n\tconstructor(container, initData = {}, option = {\n\t\tuploadUrl: null,\n\t\trequired: null,\n\t\tfileSizeLimit: null,\n\t\tallowFileTypes: null,\n\t}){\n\t\tthis.value = initData.value || '';\n\t\tthis.thumb = initData.thumb || '';\n\t\tthis.name = initData.name || '';\n\n\t\tmergeNoNull(this.option, option);\n\t\tconst uploadUrl = this.option.uploadUrl || Uploader.globalUploadUrl;\n\t\tconst requestHandle = this.option.requestHandle || Uploader.globalRequestHandle;\n\t\tif(!uploadUrl){\n\t\t\tthrow \"上传组件需要提供上传接口地址：option.uploadUrl 或者 Uploader.globalUploadUrl\";\n\t\t}\n\t\tif(!requestHandle){\n\t\t\tthrow \"上传组件需要提供上传请求函数：option.requestHandle 或者 Uploader.globalRequestHandle\"\n\t\t}\n\n\t\t//default error handle\n\t\tthis.onError.listen(err => {\n\t\t\tToast.showError(err);\n\t\t});\n\t\tlet acceptStr = this.option.allowFileTypes.join(',');\n\t\tconst html =\n\t\t\t`<div class=\"${NS}\" data-state=\"${this.state}\">\n\t\t\t<label class=\"${NS}-file\">\n\t\t\t\t<input type=\"file\" tabindex=\"0\" accept=\"${acceptStr}\" value=\"${this.value}\" ${this.option.required ? 'required' : ''}>\n\t\t\t</label>\n\t\t\t<div class=\"${NS}-progress\">\n\t\t\t\t<progress max=\"100\" value=\"0\">0%</progress>\n\t\t\t\t<span>0%</span>\n\t\t\t</div>\n\t\t\t<div class=\"${NS}-content\"></div>\n\t\t\t<div class=\"${NS}-handle\">\n\t\t\t\t<span role=\"button\" tabindex=\"0\" class=\"${NS}-btn ${NS}-btn-cancel\" title=\"取消上传\"></span>\n\t\t\t\t<span role=\"button\" tabindex=\"0\" class=\"${NS}-btn ${NS}-btn-clean\" title=\"清除\"></span>\n\t\t\t</div>\n\t\t</div>`;\n\t\tthis.dom = createDomByHtml(html, container);\n\t\tconst fileEl = findOne('input[type=file]', this.dom);\n\n\t\tbindNodeActive(findOne(`.${NS}-btn-clean`, this.dom), () => {cleanUpload(this);});\n\t\tbindNodeActive(findOne(`.${NS}-btn-cancel`, this.dom), () => {abortUpload(this);});\n\n\t\tupdateState(this, this.value ? UPLOAD_STATE_NORMAL : UPLOAD_STATE_EMPTY);\n\t\tfileEl.addEventListener('change', () => {\n\t\t\tlet file = fileEl.files[0];\n\t\t\tif(file){\n\t\t\t\tif(file.size < 1){\n\t\t\t\t\tToast.showError('所选的文件内容为空');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif(this.option.fileSizeLimit && file.size < this.option.fileSizeLimit){\n\t\t\t\t\tToast.showError('所选的文件大小超出限制');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tupdateState(this, UPLOAD_STATE_PENDING);\n\t\t\t\tthis.xhr = requestHandle(uploadUrl, {[this.option.uploadFileFieldName]: file}, {\n\t\t\t\t\tonSuccess: rspObj => {\n\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\tresponseFormatValidate(rspObj);\n\t\t\t\t\t\t\tlet {value, thumb, name} = rspObj;\n\t\t\t\t\t\t\tthis.value = value;\n\t\t\t\t\t\t\tthis.thumb = thumb;\n\t\t\t\t\t\t\tthis.name = name;\n\t\t\t\t\t\t\tupdateState(this, UPLOAD_STATE_NORMAL);\n\t\t\t\t\t\t}catch(err){\n\t\t\t\t\t\t\tupdateState(this, UPLOAD_STATE_ERROR, err);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tonProgress: (percent, total) => {\n\t\t\t\t\t\tconst progressEl = findOne('progress', this.dom);\n\t\t\t\t\t\tconst progressPnt = findOne(`.${NS}-progress span`, this.dom);\n\t\t\t\t\t\tprogressEl.value = percent;\n\t\t\t\t\t\tprogressEl.max = total;\n\t\t\t\t\t\tprogressPnt.innerHTML = Math.round(100 * percent / total) + '%';\n\t\t\t\t\t\tupdateState(this, UPLOAD_STATE_PENDING);\n\t\t\t\t\t},\n\t\t\t\t\tonError: (err) => {\n\t\t\t\t\t\tupdateState(this, UPLOAD_STATE_ERROR, err);\n\t\t\t\t\t},\n\t\t\t\t\tonAbort: () => {\n\t\t\t\t\t\tupdateState(this, UPLOAD_STATE_ERROR, '上传被中断');\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t}\n\n\t/**\n\t * 停止上传\n\t */\n\tabort(){\n\t\tabortUpload(this);\n\t}\n\n\t/**\n\t * 获取当前值\n\t * @return {null}\n\t */\n\tgetValue(){\n\t\treturn this.value;\n\t}\n\n\t/**\n\t * 获取当前值（异步）\n\t * @return {Promise<unknown>}\n\t */\n\tgetValueAsync(){\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif(this.state !== UPLOAD_STATE_PENDING){\n\t\t\t\tresolve(this.getValue());\n\t\t\t}else{\n\t\t\t\tlet success_handle = () => {\n\t\t\t\t\tresolve(this.getValue());\n\t\t\t\t\tthis.onSuccess.remove(success_handle);\n\t\t\t\t};\n\t\t\t\tlet error_handle = (msg) => {\n\t\t\t\t\treject(msg);\n\t\t\t\t\tthis.onError.remove(error_handle);\n\t\t\t\t}\n\t\t\t\tthis.onSuccess.listen(success_handle)\n\t\t\t\tthis.onError.listen(error_handle);\n\t\t\t}\n\t\t});\n\t}\n}","import {Uploader} from \"../Widget/Uploader.js\";\n\n/**\n * 上传组件\n * 参数：\n * *[data-uploader-value]\n * *[data-uploader-name]\n * *[data-uploader-thumb]\n * *[data-uploader-uploadUrl]\n * *[data-uploader-···] 更多参数请参考 Uploader.constructor()\n * 使用举例：\n * <input type=\"button\" value=\"复制链接” data-copy-content=\"http://abc.com\" data-component=\"copy\"/>\n */\nexport class ACUploader {\n\tstatic init(node, param){\n\t\treturn new Promise(resolve => {\n\t\t\tUploader.bindFileInput(node, param, param);\n\t\t\tresolve();\n\t\t});\n\t}\n}","import {Theme} from \"../Widget/Theme.js\";\nimport {createDomByHtml, insertStyleSheet} from \"../Lang/Dom.js\";\n\nconst UI_STATE_ACTIVE = 'active';\nconst UI_STATE_INACTIVE = 'inactive';\n\nconst STATE_NORMAL = 'normal';\nconst STATE_OVERLOAD = 'overload';\n\nconst MAIN_CLASS = Theme.Namespace + '-text-counter';\n\ninsertStyleSheet(`\n.${MAIN_CLASS} {pointer-events:none; margin-left:0.5em; user-select:none;}\n.${MAIN_CLASS}[data-state=\"${STATE_NORMAL}\"][data-ui-state=\"${UI_STATE_INACTIVE}\"] {opacity:0.5}\n.${MAIN_CLASS}[data-state=\"${STATE_NORMAL}\"][data-ui-state=\"${UI_STATE_ACTIVE}\"] {}\n.${MAIN_CLASS}[data-state=\"${STATE_OVERLOAD}\"][data-ui-state=\"${UI_STATE_INACTIVE}\"] {opacity:0.8; color:red}\n.${MAIN_CLASS}[data-state=\"${STATE_OVERLOAD}\"][data-ui-state=\"${UI_STATE_ACTIVE}\"] {color:red}\n`);\n\nexport class ACTextCounter {\n\tstatic init(input, param = {}){\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet maxlength = input.maxlength || param.maxlength;\n\t\t\tlet trim = param.trim;\n\t\t\tif(!maxlength){\n\t\t\t\tthrow \"input maxlength required\";\n\t\t\t}\n\t\t\tconst trigger = createDomByHtml(`<span class=\"${MAIN_CLASS}\" data-state=\"${STATE_NORMAL}\" data-ui-state=\"${UI_STATE_INACTIVE}\">0/${maxlength}</span>`);\n\t\t\tconst updState = () => {\n\t\t\t\tlet len = trim ? input.value.trim().length : input.value.length;\n\t\t\t\tlet state = len > maxlength ? STATE_OVERLOAD : STATE_NORMAL;\n\t\t\t\tconsole.log(state);\n\t\t\t\ttrigger.setAttribute('data-state', state);\n\t\t\t\ttrigger.innerHTML = len + '/' + maxlength;\n\t\t\t}\n\t\t\tinput.parentNode.insertBefore(trigger, input.nextSibling);\n\t\t\tinput.addEventListener('focus', () => {\n\t\t\t\ttrigger.setAttribute('data-ui-state', UI_STATE_ACTIVE);\n\t\t\t});\n\t\t\tinput.addEventListener('blur', () => {\n\t\t\t\ttrigger.setAttribute('data-ui-state', UI_STATE_INACTIVE);\n\t\t\t});\n\t\t\tinput.addEventListener('input', updState);\n\t\t\tupdState();\n\t\t\tresolve();\n\t\t})\n\t}\n}\n","import {Toast} from \"../Widget/Toast.js\";\nimport {findAll, findOne, insertStyleSheet} from \"../Lang/Dom.js\";\nimport {escapeAttr, escapeHtml} from \"../Lang/Html.js\";\nimport {Dialog, DLG_CLS_WEAK_BTN} from \"../Widget/Dialog.js\";\nimport {Theme} from \"../Widget/Theme.js\";\nimport {guid} from \"../Lang/Util.js\";\nimport {KEYS, triggerDomEvent} from \"../Lang/Event.js\";\n\nconst NS = Theme.Namespace + '-ac-batchfiller';\n\ninsertStyleSheet(`\n\t.${NS} {padding:2em 2em 1em 2em}\n\t.${NS} label {font-size:1.1em; margin-bottom:.75em; display:block;}\n\t.${NS} input,\n\t.${NS} textarea,\n\t.${NS} select {width:100%; box-sizing:border-box; min-height:2.25em;}\n\t.${NS} textarea {min-height:5em; resize:vertical}\n`)\n\nconst SUPPORT_INPUT_TYPES = [\n\t// 'button',\n\t// 'checkbox',\n\t'color',\n\t'date',\n\t'datetime',\n\t'datetime-local',\n\t'month',\n\t'week',\n\t'time',\n\t'email',\n\t// 'file',\n\t// 'hidden',\n\t// 'image',\n\t'number',\n\t'password',\n\t// 'radio',\n\t'range',\n\t// 'reset',\n\t'search',\n\t// 'submit',\n\t'tel',\n\t'text',\n\t'url',\n];\n\nconst cloneElementAsHtml = (el, id = '') => {\n\tlet required_attr = el.required ? 'required' : '';\n\tlet pattern_attr = el.getAttribute('pattern') ? `pattern=\"${el.getAttribute('pattern')}\"` : '';\n\tlet placeholder_attr = el.placeholder ? `placeholder=\"${escapeAttr(el.placeholder)}\"` : '';\n\tlet title_attr = el.title ? `title=\"${escapeAttr(el.title)}\"` : '';\n\tlet max_attr = el.max ? `max=${escapeAttr(el.max)}` : '';\n\tlet min_attr = el.min ? `min=${escapeAttr(el.min)}` : '';\n\tlet step_attr = el.step ? `step=${escapeAttr(el.step)}` : '';\n\tlet id_attr = id.length ? `id=\"${escapeAttr(id)}\"` : '';\n\tswitch(el.tagName){\n\t\tcase 'SELECT':\n\t\t\tlet multiple = el.hasAttribute('multiple');\n\t\t\tlet size = el.getAttribute('size');\n\t\t\tlet option_html = '';\n\t\t\tArray.from(el.options).forEach(opt => {\n\t\t\t\toption_html +=\n\t\t\t\t\t`<option value=\"${escapeAttr(opt.name) || ''}\" ${opt.disabled ? 'disabled' : ''}>\n\t\t\t\t\t\t${escapeHtml(opt.innerText)}\n\t\t\t\t\t</option>`;\n\t\t\t});\n\t\t\treturn `<select ${id_attr} ${required_attr} ${multiple ? 'multiple' : ''} ${size ? 'size=\"' + size + '\"' : ''} ${title_attr}>${option_html}</select>`;\n\t\tcase 'INPUT':\n\t\t\tif(SUPPORT_INPUT_TYPES.includes(el.type.toLowerCase())){\n\t\t\t\treturn `<input ${id_attr} type=\"${el.type}\" ${max_attr} ${min_attr} ${step_attr} ${required_attr} ${pattern_attr} ${placeholder_attr} ${title_attr} ${el.maxLength > 0 ? 'maxlength=\"' + el.maxLength + '\"' : ''}>`;\n\t\t\t}\n\t\t\tthrow \"no support type\" + el.type;\n\t\tcase 'TEXTAREA':\n\t\t\treturn `<textarea ${id_attr} ${pattern_attr} ${required_attr} ${placeholder_attr} ${title_attr} ${el.maxLength > 0 ? 'maxlength=\"' + el.maxLength + '\"' : ''}></textarea>`;\n\t\tdefault:\n\t\t\tthrow \"no support type\" + el.type;\n\t}\n}\n\nexport class ACBatchFiller {\n\tstatic active(node, param = {}){\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet relative_elements = findAll(param.selector);\n\t\t\tif(!relative_elements.length){\n\t\t\t\tToast.showInfo(\"没有可以填写的输入框\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet id = guid(NS);\n\t\t\tlet shadow_el_html = cloneElementAsHtml(relative_elements[0], id);\n\t\t\tlet el, dlg;\n\t\t\tlet label_html = param.title || '批量设置';\n\t\t\tlet doFill = () => {\n\t\t\t\trelative_elements.forEach(element => {\n\t\t\t\t\tswitch(el.tagName){\n\t\t\t\t\t\tcase 'TEXTAREA':\n\t\t\t\t\t\tcase 'INPUT':\n\t\t\t\t\t\t\telement.value = el.value;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'SELECT':\n\t\t\t\t\t\t\tif(el.multiple){\n\t\t\t\t\t\t\t\tlet indexes = [];\n\t\t\t\t\t\t\t\tArray.from(el.selectedOptions).forEach(opt => {\n\t\t\t\t\t\t\t\t\tindexes.push(opt.index);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tfor(let i = 0; i < element.options.length; i++){\n\t\t\t\t\t\t\t\t\telement.options[i].selected = indexes.includes(i);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\telement.selectedIndex = el.selectedIndex;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tthrow \"no support tag:\" + el.tagName;\n\t\t\t\t\t}\n\t\t\t\t\ttriggerDomEvent(element, 'change');\n\t\t\t\t});\n\t\t\t\tdlg.close();\n\t\t\t};\n\t\t\tdlg = Dialog.show('',\n\t\t\t\t`<div class=\"${NS}\">\n\t<label for=\"${id}\">${label_html}</label>\n\t<div>${shadow_el_html}</div>\n</div>`, {\n\t\t\t\t\twidth: 350,\n\t\t\t\t\tbuttons: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdefault: true,\n\t\t\t\t\t\t\ttitle: '确定', callback: () => {\n\t\t\t\t\t\t\t\tdoFill();\n\t\t\t\t\t\t\t\tdlg.close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{title: '关闭', className:DLG_CLS_WEAK_BTN}\n\t\t\t\t\t]\n\t\t\t\t});\n\t\t\tel = findOne('input,textarea,select', dlg.dom);\n\t\t\tel.focus();\n\t\t\tif(el.tagName === 'INPUT'){\n\t\t\t\tel.addEventListener('keydown', e => {\n\t\t\t\t\tif(e.keyCode === KEYS.Enter){\n\t\t\t\t\t\tdoFill();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tresolve();\n\t\t});\n\t}\n}\n","import {ACAsync} from \"./ACAsync.js\";\nimport {ACDialog} from \"./ACDialog.js\";\nimport {ACConfirm} from \"./ACConfirm.js\";\nimport {ACTip} from \"./ACTip.js\";\nimport {ACCopy} from \"./ACCopy.js\";\nimport {ACToast} from \"./ACToast.js\";\nimport {objectPushByPath} from \"../Lang/Array.js\";\nimport {ACPreview} from \"./ACPreview.js\";\nimport {ACSelect} from \"./ACSelect.js\";\nimport {ACHighlight} from \"./ACHighlight.js\";\nimport {ACSelectAll} from \"./ACSelectAll.js\";\nimport {ACMultiSelectRelate} from \"./ACMultiSelectRelate.js\";\nimport {ACUploader} from \"./ACUploader.js\";\nimport {ACTextCounter} from \"./ACTextCounter.js\";\nimport {findAll} from \"../Lang/Dom.js\";\nimport {ACBatchFiller} from \"./ACBatchFiller.js\";\n\nconst DEFAULT_ATTR_COM_FLAG = 'data-component'; //data-component=\"com1,com2\"\nconst COMPONENT_BIND_FLAG_KEY = 'component-init-bind';\n\n/**\n * 组件映射配置\n * @type {Object}\n */\nlet AC_COMPONENT_NAME_MAPPING = {\n\tasync: ACAsync,\n\tcopy: ACCopy,\n\tdialog: ACDialog,\n\tconfirm: ACConfirm,\n\tpreview: ACPreview,\n\tselect: ACSelect,\n\thl: ACHighlight,\n\thighlight: ACHighlight,\n\tselectall: ACSelectAll,\n\tselectrelate: ACMultiSelectRelate,\n\ttip: ACTip,\n\ttoast: ACToast,\n\ttextcounter: ACTextCounter,\n\tuploader: ACUploader,\n\tbatchfiller: ACBatchFiller,\n};\n\n/**\n * 从属性中解析出组件列表\n * @param {String} attr\n * @return {String[]}\n */\nconst parseComponents = function(attr){\n\tlet tmp = attr.split(',');\n\tlet cs = [];\n\ttmp.forEach(v => {\n\t\tv = v.trim();\n\t\tif(v){\n\t\t\tcs.push(v);\n\t\t}\n\t});\n\treturn cs;\n};\n\n/**\n * 从节点中解析出使用 data-key- 为前缀的属性\n * @param {Node} node\n * @param {String} ComAlias\n * @return {{}} 需要传递给组件方法的参数值（注意，由于属性名称仅支持小写（HTML中大写会转换成小写），返回参数值对象中不会出现大写情况。\n */\nconst resolveDataParam = (node, ComAlias) => {\n\tlet param = {};\n\tArray.from(node.attributes).forEach(attr => {\n\t\tif(attr.name.indexOf('data-' + ComAlias.toLowerCase() + '-') >= 0){\n\t\t\tlet objKeyPath = attr.name.substring(('data-' + ComAlias.toLowerCase()).length + 1);\n\t\t\tobjectPushByPath(objKeyPath, attr.value, param);\n\t\t}\n\t})\n\treturn param;\n}\n\n/**\n * 绑定节点\n * @param {Node} container\n * @param attr_flag\n */\nconst bindNode = function(container = document, attr_flag = DEFAULT_ATTR_COM_FLAG){\n\tfindAll(`:not([${COMPONENT_BIND_FLAG_KEY}])[${attr_flag}]`, container).forEach(node => {\n\t\tlet cs = parseComponents(node.getAttribute(attr_flag));\n\t\tlet activeStacks = [];\n\t\tlet init_count = 0;\n\t\tcs.forEach(componentAlias => {\n\t\t\tlet C = AC_COMPONENT_NAME_MAPPING[componentAlias];\n\t\t\tif(!C){\n\t\t\t\tconsole.warn('component no found', componentAlias);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tinit_count++;\n\t\t\tlet data = resolveDataParam(node, componentAlias);\n\t\t\tif(C.init){\n\t\t\t\tC.init(node, data);\n\t\t\t}\n\t\t\tif(C.active){\n\t\t\t\tactiveStacks.push((event) => {\n\t\t\t\t\treturn C.active(node, resolveDataParam(node, componentAlias), event); //点击时实时解析参数\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\t\t//只有在有成功初始化情况才忽略下次初始化\n\t\tif(init_count !== 0){\n\t\t\tnode.setAttribute(COMPONENT_BIND_FLAG_KEY, \"1\");\n\t\t}\n\t\tif(activeStacks.length){\n\t\t\tbindActiveChain(node, activeStacks);\n\t\t}\n\t});\n};\n\n/**\n * 可以转换成文本类型的输入类型\n * @type {string[]}\n */\nconst TEXT_TYPES = ['text', 'number', 'password', 'search', 'address', 'date', 'datetime', 'time', 'checkbox', 'radio'];\n\n/**\n * 是否为可输入元素\n * @param {HTMLFormElement} node\n * @return {boolean}\n */\nconst isInputAble = (node) => {\n\tif(node.disabled || node.readonly){\n\t\treturn false;\n\t}\n\treturn node.tagName === 'TEXTAREA' ||\n\t\t(node.tagName === 'INPUT' && (!node.type || TEXT_TYPES.includes(node.type.toLowerCase())));\n}\n\n/**\n * 绑定节点触发事件，不同节点触发行为定义不同\n * @param {HTMLElement} node\n * @param {Function[]} activeStacks 链式调用列表\n */\nconst bindActiveChain = (node, activeStacks) => {\n\tlet eventName;\n\tif(isInputAble(node)){\n\t\teventName = 'keyup';\n\t}else if(node.tagName === 'FORM'){\n\t\teventName = 'submit';\n\t}else{\n\t\teventName = 'click';\n\t}\n\tnode.addEventListener(eventName, event => {\n\t\tlet func = activeStacks[0];\n\t\tlet pro = func(event);\n\t\tfor(let i = 1; i < activeStacks.length; i++){\n\t\t\tpro = pro.then(() => {\n\t\t\t\treturn activeStacks[i](event);\n\t\t\t}, () => {\n\t\t\t});\n\t\t}\n\t\tevent.preventDefault();\n\t\treturn false;\n\t});\n}\n\nexport const ACComponent = {\n\t/**\n\t * 监听组件\n\t * @param {Node} container\n\t * @param {String} attr_flag 绑定属性格式，缺省为 data-component形式\n\t */\n\twatch: (container = document, attr_flag = DEFAULT_ATTR_COM_FLAG) => {\n\t\tlet m_tm = null;\n\t\tlet observer = new MutationObserver(() => {\n\t\t\tclearTimeout(m_tm);\n\t\t\tm_tm = setTimeout(function(){\n\t\t\t\tbindNode(container, attr_flag);\n\t\t\t}, 0);\n\t\t});\n\t\tobserver.observe(container, {childList: true, subtree: true});\n\t\tbindNode(container, attr_flag);\n\t},\n\n\t/**\n\t * 注册组件\n\t * @param {String} ComponentName\n\t * @param {Object} define\n\t * @param {Function} define.init 节点初始化函数\n\t * @param {Function} define.active 节点交互函数（交互行为包括：表单提交、链接点击、按钮点击、输入框回车提交等）\n\t */\n\tregister: (ComponentName, define) => {\n\t\tAC_COMPONENT_NAME_MAPPING[ComponentName] = define;\n\t},\n\n\t/**\n\t * 取消注册组件\n\t * @param {String} componentName\n\t */\n\tunRegister: (componentName) => {\n\t\tdelete (AC_COMPONENT_NAME_MAPPING[componentName]);\n\t}\n}\n","/**\r\n  * Add integers, wrapping at 2^32. This uses 16-bit operations internally\r\n  * to work around bugs in some JS interpreters.\r\n  */\r\nconst safeAdd = (x, y) => {\r\n\tlet lsw = (x & 0xffff) + (y & 0xffff);\r\n\tlet msw = (x >> 16) + (y >> 16) + (lsw >> 16);\r\n\treturn (msw << 16) | (lsw & 0xffff)\r\n}\r\n\r\n/**\r\n* Bitwise rotate a 32-bit number to the left.\r\n*/\r\nconst bitRotateLeft = (num, cnt) => {\r\n\treturn (num << cnt) | (num >>> (32 - cnt))\r\n}\r\n\r\n/**\r\n* These functions implement the four basic operations the algorithm uses.\r\n*/\r\nconst md5cmn = (q, a, b, x, s, t) => {\r\n\treturn safeAdd(bitRotateLeft(safeAdd(safeAdd(a, q), safeAdd(x, t)), s), b)\r\n}\r\n\r\nconst md5ff = (a, b, c, d, x, s, t) => {\r\n\treturn md5cmn((b & c) | (~b & d), a, b, x, s, t)\r\n}\r\n\r\nconst md5gg = (a, b, c, d, x, s, t) => {\r\n\treturn md5cmn((b & d) | (c & ~d), a, b, x, s, t)\r\n}\r\n\r\nconst md5hh = (a, b, c, d, x, s, t) => {\r\n\treturn md5cmn(b ^ c ^ d, a, b, x, s, t)\r\n}\r\n\r\nconst md5ii = (a, b, c, d, x, s, t) => {\r\n\treturn md5cmn(c ^ (b | ~d), a, b, x, s, t)\r\n}\r\n\r\n/**\r\n* Calculate the MD5 of an array of little-endian words, and a bit length.\r\n*/\r\nconst binlMD5 = (x, len) => {\r\n\t/* append padding */\r\n\tx[len >> 5] |= 0x80 << (len % 32);\r\n\tx[((len + 64) >>> 9 << 4) + 14] = len;\r\n\r\n\tlet i;\r\n\tlet olda;\r\n\tlet oldb;\r\n\tlet oldc;\r\n\tlet oldd;\r\n\tlet a = 1732584193;\r\n\tlet b = -271733879;\r\n\tlet c = -1732584194;\r\n\tlet d = 271733878;\r\n\r\n\tfor(i = 0; i < x.length; i += 16){\r\n\t\tolda = a;\r\n\t\toldb = b;\r\n\t\toldc = c;\r\n\t\toldd = d;\r\n\r\n\t\ta = md5ff(a, b, c, d, x[i], 7, -680876936);\r\n\t\td = md5ff(d, a, b, c, x[i + 1], 12, -389564586);\r\n\t\tc = md5ff(c, d, a, b, x[i + 2], 17, 606105819);\r\n\t\tb = md5ff(b, c, d, a, x[i + 3], 22, -1044525330);\r\n\t\ta = md5ff(a, b, c, d, x[i + 4], 7, -176418897);\r\n\t\td = md5ff(d, a, b, c, x[i + 5], 12, 1200080426);\r\n\t\tc = md5ff(c, d, a, b, x[i + 6], 17, -1473231341);\r\n\t\tb = md5ff(b, c, d, a, x[i + 7], 22, -45705983);\r\n\t\ta = md5ff(a, b, c, d, x[i + 8], 7, 1770035416);\r\n\t\td = md5ff(d, a, b, c, x[i + 9], 12, -1958414417);\r\n\t\tc = md5ff(c, d, a, b, x[i + 10], 17, -42063);\r\n\t\tb = md5ff(b, c, d, a, x[i + 11], 22, -1990404162);\r\n\t\ta = md5ff(a, b, c, d, x[i + 12], 7, 1804603682);\r\n\t\td = md5ff(d, a, b, c, x[i + 13], 12, -40341101);\r\n\t\tc = md5ff(c, d, a, b, x[i + 14], 17, -1502002290);\r\n\t\tb = md5ff(b, c, d, a, x[i + 15], 22, 1236535329);\r\n\r\n\t\ta = md5gg(a, b, c, d, x[i + 1], 5, -165796510);\r\n\t\td = md5gg(d, a, b, c, x[i + 6], 9, -1069501632);\r\n\t\tc = md5gg(c, d, a, b, x[i + 11], 14, 643717713);\r\n\t\tb = md5gg(b, c, d, a, x[i], 20, -373897302);\r\n\t\ta = md5gg(a, b, c, d, x[i + 5], 5, -701558691);\r\n\t\td = md5gg(d, a, b, c, x[i + 10], 9, 38016083);\r\n\t\tc = md5gg(c, d, a, b, x[i + 15], 14, -660478335);\r\n\t\tb = md5gg(b, c, d, a, x[i + 4], 20, -405537848);\r\n\t\ta = md5gg(a, b, c, d, x[i + 9], 5, 568446438);\r\n\t\td = md5gg(d, a, b, c, x[i + 14], 9, -1019803690);\r\n\t\tc = md5gg(c, d, a, b, x[i + 3], 14, -187363961);\r\n\t\tb = md5gg(b, c, d, a, x[i + 8], 20, 1163531501);\r\n\t\ta = md5gg(a, b, c, d, x[i + 13], 5, -1444681467);\r\n\t\td = md5gg(d, a, b, c, x[i + 2], 9, -51403784);\r\n\t\tc = md5gg(c, d, a, b, x[i + 7], 14, 1735328473);\r\n\t\tb = md5gg(b, c, d, a, x[i + 12], 20, -1926607734);\r\n\r\n\t\ta = md5hh(a, b, c, d, x[i + 5], 4, -378558);\r\n\t\td = md5hh(d, a, b, c, x[i + 8], 11, -2022574463);\r\n\t\tc = md5hh(c, d, a, b, x[i + 11], 16, 1839030562);\r\n\t\tb = md5hh(b, c, d, a, x[i + 14], 23, -35309556);\r\n\t\ta = md5hh(a, b, c, d, x[i + 1], 4, -1530992060);\r\n\t\td = md5hh(d, a, b, c, x[i + 4], 11, 1272893353);\r\n\t\tc = md5hh(c, d, a, b, x[i + 7], 16, -155497632);\r\n\t\tb = md5hh(b, c, d, a, x[i + 10], 23, -1094730640);\r\n\t\ta = md5hh(a, b, c, d, x[i + 13], 4, 681279174);\r\n\t\td = md5hh(d, a, b, c, x[i], 11, -358537222);\r\n\t\tc = md5hh(c, d, a, b, x[i + 3], 16, -722521979);\r\n\t\tb = md5hh(b, c, d, a, x[i + 6], 23, 76029189);\r\n\t\ta = md5hh(a, b, c, d, x[i + 9], 4, -640364487);\r\n\t\td = md5hh(d, a, b, c, x[i + 12], 11, -421815835);\r\n\t\tc = md5hh(c, d, a, b, x[i + 15], 16, 530742520);\r\n\t\tb = md5hh(b, c, d, a, x[i + 2], 23, -995338651);\r\n\r\n\t\ta = md5ii(a, b, c, d, x[i], 6, -198630844);\r\n\t\td = md5ii(d, a, b, c, x[i + 7], 10, 1126891415);\r\n\t\tc = md5ii(c, d, a, b, x[i + 14], 15, -1416354905);\r\n\t\tb = md5ii(b, c, d, a, x[i + 5], 21, -57434055);\r\n\t\ta = md5ii(a, b, c, d, x[i + 12], 6, 1700485571);\r\n\t\td = md5ii(d, a, b, c, x[i + 3], 10, -1894986606);\r\n\t\tc = md5ii(c, d, a, b, x[i + 10], 15, -1051523);\r\n\t\tb = md5ii(b, c, d, a, x[i + 1], 21, -2054922799);\r\n\t\ta = md5ii(a, b, c, d, x[i + 8], 6, 1873313359);\r\n\t\td = md5ii(d, a, b, c, x[i + 15], 10, -30611744);\r\n\t\tc = md5ii(c, d, a, b, x[i + 6], 15, -1560198380);\r\n\t\tb = md5ii(b, c, d, a, x[i + 13], 21, 1309151649);\r\n\t\ta = md5ii(a, b, c, d, x[i + 4], 6, -145523070);\r\n\t\td = md5ii(d, a, b, c, x[i + 11], 10, -1120210379);\r\n\t\tc = md5ii(c, d, a, b, x[i + 2], 15, 718787259);\r\n\t\tb = md5ii(b, c, d, a, x[i + 9], 21, -343485551);\r\n\r\n\t\ta = safeAdd(a, olda)\r\n\t\tb = safeAdd(b, oldb)\r\n\t\tc = safeAdd(c, oldc)\r\n\t\td = safeAdd(d, oldd)\r\n\t}\r\n\treturn [a, b, c, d]\r\n}\r\n\r\n/**\r\n* Convert an array of little-endian words to a string\r\n*/\r\nconst binl2rstr = (input) => {\r\n\tlet i;\r\n\tlet output = '';\r\n\tlet length32 = input.length * 32;\r\n\tfor(i = 0; i < length32; i += 8){\r\n\t\toutput += String.fromCharCode((input[i >> 5] >>> (i % 32)) & 0xff)\r\n\t}\r\n\treturn output\r\n}\r\n\r\n/**\r\n* Convert a raw string to an array of little-endian words\r\n* Characters >255 have their high-byte silently ignored.\r\n*/\r\nconst rstr2binl = (input) => {\r\n\tlet i;\r\n\tlet output = [];\r\n\toutput[(input.length >> 2) - 1] = undefined;\r\n\tfor(i = 0; i < output.length; i += 1){\r\n\t\toutput[i] = 0\r\n\t}\r\n\tlet length8 = input.length * 8;\r\n\tfor(i = 0; i < length8; i += 8){\r\n\t\toutput[i >> 5] |= (input.charCodeAt(i / 8) & 0xff) << (i % 32)\r\n\t}\r\n\treturn output\r\n}\r\n\r\n/**\r\n* Calculate the MD5 of a raw string\r\n*/\r\nconst rstrMD5 = (s) => {\r\n\treturn binl2rstr(binlMD5(rstr2binl(s), s.length * 8))\r\n}\r\n\r\n/**\r\n* Calculate the HMAC-MD5, of a key and some data (raw strings)\r\n*/\r\nconst rstrHMACMD5 = (key, data) => {\r\n\tlet i;\r\n\tlet bkey = rstr2binl(key);\r\n\tlet ipad = [];\r\n\tlet opad = [];\r\n\tlet hash;\r\n\tipad[15] = opad[15] = undefined;\r\n\tif(bkey.length > 16){\r\n\t\tbkey = binlMD5(bkey, key.length * 8)\r\n\t}\r\n\tfor(i = 0; i < 16; i += 1){\r\n\t\tipad[i] = bkey[i] ^ 0x36363636;\r\n\t\topad[i] = bkey[i] ^ 0x5c5c5c5c\r\n\t}\r\n\thash = binlMD5(ipad.concat(rstr2binl(data)), 512 + data.length * 8);\r\n\treturn binl2rstr(binlMD5(opad.concat(hash), 512 + 128))\r\n}\r\n\r\n/**\r\n* Convert a raw string to a hex string\r\n*/\r\nconst rstr2hex = (input) => {\r\n\tlet hexTab = '0123456789abcdef';\r\n\tlet output = '';\r\n\tlet x;\r\n\tlet i;\r\n\tfor(i = 0; i < input.length; i += 1){\r\n\t\tx = input.charCodeAt(i);\r\n\t\toutput += hexTab.charAt((x >>> 4) & 0x0f) + hexTab.charAt(x & 0x0f)\r\n\t}\r\n\treturn output\r\n}\r\n\r\n/**\r\n* Encode a string as utf-8\r\n*/\r\nconst str2rstrUTF8 = (input) => {\r\n\treturn unescape(encodeURIComponent(input))\r\n}\r\n\r\n/**\r\n* Take string arguments and return either raw or hex encoded strings\r\n*/\r\nconst rawMD5 = (s) => {\r\n\treturn rstrMD5(str2rstrUTF8(s))\r\n}\r\n\r\nconst hexMD5 = (s) => {\r\n\treturn rstr2hex(rawMD5(s))\r\n}\r\n\r\nconst rawHMACMD5 = (k, d) => {\r\n\treturn rstrHMACMD5(str2rstrUTF8(k), str2rstrUTF8(d))\r\n}\r\n\r\nconst hexHMACMD5 = (k, d) => {\r\n\treturn rstr2hex(rawHMACMD5(k, d))\r\n}\r\n\r\nexport const MD5 = (string, key, raw) => {\r\n\tif(!key){\r\n\t\tif(!raw){\r\n\t\t\treturn hexMD5(string)\r\n\t\t}\r\n\t\treturn rawMD5(string)\r\n\t}\r\n\tif(!raw){\r\n\t\treturn hexHMACMD5(key, string)\r\n\t}\r\n\treturn rawHMACMD5(key, string)\r\n};\r\n","import {BizEvent} from \"./Event.js\";\n\nlet hook_flag = false;\nconst RptEv = new BizEvent();\nconst doHook = () => {\n\tlet observer = new ReportingObserver((reports) => {\n\t\tonReportApi.fire(reports);\n\t}, {\n\t\ttypes: ['deprecation'],\n\t\tbuffered: true\n\t});\n\tobserver.observe();\n};\n\nexport const onReportApi = {\n\tlisten(payload){\n\t\t!hook_flag && doHook();\n\t\thook_flag = true;\n\t\tRptEv.listen(payload);\n\t},\n\tremove(payload){\n\t\treturn RptEv.remove(payload);\n\t},\n\tfire(...args){\n\t\treturn RptEv.fire(...args);\n\t}\n};\n","import {getHash, QueryString} from \"./Net.js\";\n\nlet payloads = [];\nlet popstate_bind = false;\n\n/**\n * 压栈状态\n * @param {Object} param\n * @param {String} title\n */\nexport const pushState = (param, title = '') => {\n\tlet url = location.href.replace(/#.*$/g, '') + '#' + QueryString.stringify(param);\n\twindow.history.pushState(param, title, url);\n\texePayloads(param);\n}\n\n/**\n * 监听 window onpopstate 事件\n * @param {Function} payload\n */\nexport const onStateChange = (payload) => {\n\tif(!popstate_bind){\n\t\tpopstate_bind = true;\n\t\twindow.addEventListener('popstate', e=>{\n\t\t\tlet state = e.state ?? {};\n\t\t\tlet hashObj = QueryString.parse(getHash());\n\t\t\texePayloads({...state, ...hashObj});\n\t\t})\n\t}\n\tpayloads.push(payload);\n}\n\nconst exePayloads = (param) => {\n\tpayloads.forEach(payload => {\n\t\tpayload(param);\n\t});\n}","export const ONE_MINUTE = 60000;\nexport const ONE_HOUR = 3600000;\nexport const ONE_DAY = 86400000;\nexport const ONE_WEEK = 604800000;\nexport const ONE_MONTH_30 = 2592000000;\nexport const ONE_MONTH_31 = 2678400000;\nexport const ONE_YEAR_365 = 31536000000;\n\n/**\n * 限制函数执行频率\n * @param {Function} payload\n * @param interval\n * @param executeOnFistTime\n */\nexport function frequencyControl(payload, interval, executeOnFistTime = false){\n\tif(payload._frq_tm){\n\t\tclearTimeout(payload._frq_tm);\n\t}\n\tpayload._frq_tm = setTimeout(() => {\n\t\tfrequencyControl(payload, interval, executeOnFistTime);\n\t}, interval);\n}\n\n/**\n * 获取指定月份天数\n * @param {Number} year\n * @param {Number} month 月份，从1开始\n * @returns {number}\n */\nexport const getMonthLastDay = (year, month) => {\n\tconst date1 = new Date(year, month, 0)\n\treturn date1.getDate()\n}\n\n/**\n * 获取指定上一个月份\n * @param {Number} year\n * @param {Number} month 当前月份，从1开始\n * @returns {Array}\n */\nexport const getLastMonth = (year, month) => {\n\treturn month === 1 ? [year - 1, 12] : [year, month - 1];\n}\n\n/**\n * 获取指定下一个月份\n * @param {Number} year\n * @param {Number} month 当前月份，从1开始\n * @returns {Array}\n */\nexport const getNextMonth = (year, month) => {\n\treturn month === 12 ? [year + 1, 1] : [year, month + 1];\n}\n\n/**\n * 格式化时间长度\n * @param {Number} micSec 毫秒\n * @param {String} delimiter 单位之间的间隔文本\n * @return {string}\n */\nexport const prettyTime = (micSec, delimiter = '') => {\n\tlet d = 0, h = 0, m = 0, s = 0;\n\tif(micSec > ONE_DAY){\n\t\td = Math.floor(micSec / ONE_DAY);\n\t\tmicSec -= d * ONE_DAY;\n\t}\n\tif(micSec > ONE_HOUR){\n\t\th = Math.floor(micSec / ONE_HOUR);\n\t\tmicSec -= h * ONE_HOUR;\n\t}\n\tif(micSec > ONE_MINUTE){\n\t\tm = Math.floor(micSec / ONE_MINUTE);\n\t\tmicSec -= m * ONE_MINUTE;\n\t}\n\tif(micSec > 1000){\n\t\ts = Math.floor(micSec / 1000);\n\t\tmicSec -= s * 1000;\n\t}\n\tlet txt = '';\n\ttxt += d ? `${d}天` : '';\n\ttxt += (txt || h) ? `${delimiter}${h}小时` : '';\n\ttxt += (txt || m) ? `${delimiter}${m}分` : '';\n\ttxt += (txt || s) ? `${delimiter}${s}秒` : '';\n\treturn txt.trim();\n}\n\n/**\n * 指定偏移月数计算\n * @param {Number} monthNum\n * @param {Date|Null} start_date\n * @return {{month: number, year: number}} 返回年、月（以1开始）\n */\nexport const monthsOffsetCalc = (monthNum, start_date = new Date())=>{\n\tlet year = start_date.getFullYear();\n\tlet month = start_date.getMonth()+1;\n\tmonth = month + monthNum;\n\tif(month > 12){\n\t\tlet yearNum = Math.floor((month - 1) / 12);\n\t\tmonth = month % 12 === 0 ? 12 : month % 12;\n\t\tyear += yearNum;\n\t}else if(month <= 0){\n\t\tmonth = Math.abs(month);\n\t\tlet yearNum = Math.floor((month + 12) / 12);\n\t\tlet n = month % 12;\n\t\tif(n === 0){\n\t\t\tyear -= yearNum;\n\t\t\tmonth = 12\n\t\t}else{\n\t\t\tyear -= yearNum;\n\t\t\tmonth = Math.abs(12 - n)\n\t\t}\n\t}\n\treturn {year, month}\n}\n","import {createDomByHtml, findAll, insertStyleSheet} from \"../Lang/Dom.js\";\nimport {getAvailableElements} from \"../Lang/Form.js\";\nimport {randomInt} from \"../Lang/Math.js\";\nimport {randomSentence} from \"../Lang/String.js\";\nimport {triggerDomEvent} from \"../Lang/Event.js\";\nimport {Theme} from \"./Theme.js\";\n\nconst DEFAULT_MAXLENGTH = 40;\nconst DEFAULT_MAX = 100;\nlet button_init = false;\n\n/**\n * 初始化表单填充按钮\n * @param {String} scopeSelector 自动填充范围，缺省为全局\n */\nexport const initAutofillButton = (scopeSelector = 'body') => {\n\tif(button_init){\n\t\tthrow \"autofill button already initialized\";\n\t}\n\tbutton_init = true;\n\tinsertStyleSheet(`\n\t#auto-fill-form-btn {position: absolute; left:calc(100vw - 200px); top:50px;z-index:99999;user-select:none;opacity:0.4;transition:all 0.1s linear; border-color:#ddd; border:1px solid #aaa; --size:2em; border-radius:5px; width:var(--size); height:var(--size); line-height:var(--size); text-align:center; cursor:pointer; background-color:#fff;}\n\t#auto-fill-form-btn:hover {opacity:1}\n\t#auto-fill-form-btn:before {content:\"\\\\e75d\"; font-family:${Theme.IconFont}}\n`);\n\tlet button = createDomByHtml('<span id=\"auto-fill-form-btn\" title=\"自动填充\"></span>', document.body);\n\tbutton.addEventListener('click', e => {\n\t\tfindAll(`${scopeSelector} form`).forEach(fillForm);\n\t});\n\ttryPositionInFirstForm(`${scopeSelector}`, button);\n}\n\n/**\n * 尝试定位在第一个有效的表单旁边\n * @param {String} scope\n * @param {Node} button\n */\nconst tryPositionInFirstForm = (scope, button) => {\n\tlet firstAvailableForm = findAll(`${scope} form`).find(form => {\n\t\treturn !!getAvailableElements(form).length;\n\t});\n\tif(firstAvailableForm){\n\t\tbutton.style.left = firstAvailableForm.offsetLeft + firstAvailableForm.offsetWidth - button.offsetWidth + 'px';\n\t\tbutton.style.top = firstAvailableForm.offsetTop + 'px';\n\t}\n}\n\n/**\n * 填充表单数据\n * @param {HTMLFormElement|Node} formOrContainer\n * @return {boolean}\n */\nexport const fillForm = (formOrContainer) => {\n\tlet inputElements = getAvailableElements(formOrContainer);\n\tif(!inputElements.length){\n\t\treturn false;\n\t}\n\tlet radio_filled = {};\n\tinputElements.forEach(element => {\n\t\tif(element.type === 'hidden'){\n\t\t\treturn;\n\t\t}\n\t\tlet required = element.required ? true : randomInt(0, 5) > 2;\n\t\tlet maxlength = parseInt(element.getAttribute('maxlength') || 0) || DEFAULT_MAXLENGTH;\n\t\tlet name = element.name;\n\n\t\tswitch(element.type){\n\t\t\tcase 'text':\n\t\t\tcase 'password':\n\t\t\tcase 'search':\n\t\t\tcase 'address':\n\t\t\t\trequired && (element.value = randomSentence(maxlength));\n\t\t\t\tbreak;\n\n\t\t\tcase 'checkbox':\n\t\t\t\telement.checked = Math.random() > 0.5;\n\t\t\t\tbreak;\n\n\t\t\tcase 'radio':\n\t\t\t\tif(name.length && radio_filled[name]){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tradio_filled[name] = true;\n\t\t\t\trequired = true;\n\t\t\t\tlet all_radios = Array.from(formOrContainer.querySelectorAll(`input[name=${name}]`));\n\t\t\t\tlet matched_radio = all_radios[randomInt(0, all_radios.length - 1)];\n\t\t\t\tmatched_radio.setAttribute('checked', 'checked');\n\t\t\t\ttriggerDomEvent(element, 'change');\n\t\t\t\treturn;\n\n\t\t\tcase 'number':\n\t\t\t\tlet min = element.min ? parseFloat(element.min) : 0;\n\t\t\t\tlet max = element.max ? parseFloat(element.max) : DEFAULT_MAX;\n\t\t\t\trequired && (element.value = randomInt(min, max));\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tif(element.tagName === 'SELECT'){\n\t\t\t\t\trequired && (element.selectedIndex = randomInt(0, element.querySelectorAll('option').length - 1));\n\t\t\t\t}else if(element.tagName === 'TEXTAREA'){\n\t\t\t\t\trequired && (element.value = randomSentence(maxlength, true));\n\t\t\t\t}else{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t\trequired && triggerDomEvent(element, 'change');\n\t});\n}","import {createDomByHtml, insertStyleSheet} from \"../Lang/Dom.js\";\nimport {Theme} from \"./Theme.js\";\n\nlet default_masker = null;\nlet CSS_CLASS = Theme.Namespace + '-masker';\n\nconst showMasker = (masker) => {\n\tif(!masker){\n\t\tmasker = createDomByHtml(`<div class=\"${CSS_CLASS}\"></div>`, document.body);\n\t}\n\tmasker.style.display = '';\n\treturn masker;\n};\n\nconst hideMasker = (masker) => {\n\tmasker && (masker.style.display = 'none');\n};\n\nconst Masker = {\n\tzIndex: Theme.MaskIndex,\n\tshow: () => {\n\t\tdefault_masker = showMasker(default_masker);\n\t},\n\thide: () => {\n\t\thideMasker(default_masker);\n\t},\n\tinstance: () => {\n\t\tlet new_masker;\n\t\treturn {\n\t\t\tshow: () => {\n\t\t\t\tnew_masker = showMasker(new_masker)\n\t\t\t},\n\t\t\thide: () => {\n\t\t\t\thideMasker(new_masker)\n\t\t\t}\n\t\t}\n\t}\n}\n\ninsertStyleSheet(`\n.${CSS_CLASS} {\n\tposition:fixed;\n\ttop:0;left:0;\n\tright:0;\n\tbottom:0;\n\tbackground:var(${Theme.CssVar.FULL_SCREEN_BACKGROUND_COLOR});\n\tbackdrop-filter:var(${Theme.CssVar.FULL_SCREEN_BACKDROP_FILTER});\n\tz-index:${Masker.zIndex}}\n`, Theme.Namespace + 'masker-style');\nexport {Masker};\n\n","import {Theme} from \"./Theme.js\";\nimport {createDomByHtml, getDomDimension, insertStyleSheet, remove} from \"../Lang/Dom.js\";\nimport {KEYS} from \"../Lang/Event.js\";\nimport {dimension2Style} from \"../Lang/Html.js\";\nimport {guid} from \"../Lang/Util.js\";\n\nlet CTX_CLASS_PREFIX = Theme.Namespace + 'context-menu';\nlet CTX_Z_INDEX = Theme.ContextIndex;\n\ninsertStyleSheet(`\n\t.${CTX_CLASS_PREFIX} {z-index:${CTX_Z_INDEX}; position:fixed;}\n\t.${CTX_CLASS_PREFIX},\n\t.${CTX_CLASS_PREFIX} ul {position:absolute; padding: 0.5em 0; list-style:none; backdrop-filter:var(${Theme.CssVar.FULL_SCREEN_BACKDROP_FILTER}); box-shadow:var(${Theme.CssVar.PANEL_SHADOW});border-radius:var(${Theme.CssVar.PANEL_RADIUS});background:var(${Theme.CssVar.BACKGROUND_COLOR});min-width:12em; display:none;}\n\t.${CTX_CLASS_PREFIX} ul {left:100%; top:0;}\n\t.${CTX_CLASS_PREFIX} li:not([disabled]):hover>ul {display:block;}\n\t.${CTX_CLASS_PREFIX} li[role=menuitem] {padding:0 1em; line-height:1; position:relative; min-height:2em; display:flex; align-items:center; background: transparent;user-select:none;opacity: 0.5; cursor:default;}\n\t.${CTX_CLASS_PREFIX} li[role=menuitem]>* {flex:1; line-height:1}\n\t.${CTX_CLASS_PREFIX} li[role=menuitem]:not([disabled]) {cursor:pointer; opacity:1;}\n\t.${CTX_CLASS_PREFIX} li[role=menuitem]:not([disabled]):hover {background-color: #eeeeee9c;text-shadow: 1px 1px 1px white;opacity: 1;}\n\t.${CTX_CLASS_PREFIX} li[data-has-child]:after {content:\"\\\\e73b\"; font-family:${Theme.IconFont}; zoom:0.7; position:absolute; right:0.5em; color:var(${Theme.CssVar.DISABLE_COLOR});}\n\t.${CTX_CLASS_PREFIX} li[data-has-child]:not([disabled]):hover:after {color:var(${Theme.CssVar.COLOR})}\n\t.${CTX_CLASS_PREFIX} .sep {margin:0.25em 0.5em;border-bottom:1px solid #eee;}\n\t.${CTX_CLASS_PREFIX} .caption {padding-left: 1em;opacity: 0.7;user-select: none;display:flex;align-items: center;}\n\t.${CTX_CLASS_PREFIX} .caption:after {content:\"\";flex:1;border-bottom: 1px solid #ccc;margin: 0 0.5em;padding-top: 3px;}\n\t.${CTX_CLASS_PREFIX} li i {--size:1.2em; display:block; width:var(--size); height:var(--size); max-width:var(--size); margin-right:0.5em;} /** icon **/\n\t.${CTX_CLASS_PREFIX} li i:before {font-size:var(--size)}\n`);\n\n/**\n * 创建菜单\n * @param {Array} commands [{title, payload, disabled=false}, {title, [submenus], disabled], '-',...]\n * @param {Function|Null} onExecute 菜单执行回调函数\n * @return {HTMLElement}\n */\nexport const createMenu = (commands, onExecute = null) => {\n\tlet html = `<ul class=\"${CTX_CLASS_PREFIX}\">`;\n\tlet payload_map = {};\n\n\tlet buildMenuItemHtml = (item) => {\n\t\tlet html = '';\n\t\tif(item === '-'){\n\t\t\thtml += '<li class=\"sep\"></li>';\n\t\t\treturn html;\n\t\t}\n\t\tlet [title, cmdOrChildren, disabled] = item;\n\t\tlet has_child = Array.isArray(cmdOrChildren);\n\t\tlet mnu_item_id = guid();\n\t\tlet sub_menu_html = '';\n\t\tif(has_child){\n\t\t\tsub_menu_html = '<ul>';\n\t\t\tcmdOrChildren.forEach(subItem => {\n\t\t\t\tsub_menu_html += buildMenuItemHtml(subItem);\n\t\t\t});\n\t\t\tsub_menu_html += '</ul>';\n\t\t}else{\n\t\t\tpayload_map[mnu_item_id] = cmdOrChildren;\n\t\t}\n\t\thtml += `<li role=\"menuitem\" data-id=\"${mnu_item_id}\" ${has_child ? ' data-has-child ' : ''} ${disabled ? 'disabled=\"disabled\"' : 'tabindex=\"0\"'}>${title}${sub_menu_html}</li>`;\n\t\treturn html;\n\t};\n\n\tfor(let i = 0; i < commands.length; i++){\n\t\tlet item = commands[i];\n\t\thtml += buildMenuItemHtml(item);\n\t}\n\thtml += '</ul>';\n\tlet menu = createDomByHtml(html, document.body);\n\n\t//绑定menu命令\n\tlet items = menu.querySelectorAll('[role=menuitem]:not([disabled])');\n\titems.forEach(function(item){\n\t\tlet id = item.getAttribute('data-id');\n\t\tlet payload = payload_map[id];\n\t\tif(payload){\n\t\t\titem.addEventListener('click', () => {\n\t\t\t\tpayload();\n\t\t\t\tonExecute && onExecute(item);\n\t\t\t});\n\t\t}\n\t});\n\n\t//处理子菜单弹出事件\n\tlet sub_menus = menu.querySelectorAll('ul');\n\tsub_menus.forEach(function(sub_menu){\n\t\tlet parent_item = sub_menu.parentNode;\n\t\tparent_item.addEventListener('mouseover', e => {\n\t\t\tlet pos = alignSubMenuByNode(sub_menu, parent_item);\n\t\t\tsub_menu.style.left = dimension2Style(pos.left);\n\t\t\tsub_menu.style.top = dimension2Style(pos.top);\n\t\t});\n\t})\n\n\t//阻止菜单上右键交互\n\tmenu.addEventListener('contextmenu', e => {\n\t\t// e.preventDefault();\n\t\t// e.stopPropagation();\n\t\t// return false;\n\t});\n\treturn menu;\n}\n\nlet LAST_MENU;\n\nconst hideLastMenu = ()=>{\n\tremove(LAST_MENU);\n\tLAST_MENU = null;\n}\n\nexport const bindTargetContextMenu = (target, commands, option = {}) => {\n\toption.triggerType = 'contextmenu';\n\treturn bindTargetMenu(target, commands, option);\n}\n\nexport const bindTargetDropdownMenu = (target, commands, option = {}) => {\n\toption.triggerType = 'click';\n\treturn bindTargetMenu(target, commands, option);\n}\n\n/**\n * 在指定位置显示右键菜单\n * @param {Array} commands\n * @param {Object} position\n */\nexport const showContextMenu = (commands,position)=>{\n\thideLastMenu();\n\tlet menuEl = createMenu(commands);\n\tLAST_MENU = menuEl;\n\tlet pos = calcMenuByPosition(menuEl, {left: position.left, top: position.top});\n\tmenuEl.style.left = dimension2Style(pos.left);\n\tmenuEl.style.top = dimension2Style(pos.top);\n\tmenuEl.style.display = 'block';\n}\n\n/**\n * @param {HTMLElement} target\n * @param {Array} commands\n * @param {Object} option 触发事件类型，如 click, contextmenu等。如果是contextmenu，菜单位置按照鼠标点击位置计算\n */\nconst bindTargetMenu = (target, commands, option = null) => {\n\tlet triggerType = option?.triggerType || 'click';\n\ttarget.addEventListener(triggerType, e => {\n\t\thideLastMenu();\n\t\tlet menuEl = createMenu(commands);\n\t\tLAST_MENU = menuEl;\n\t\tlet pos;\n\t\tif(triggerType === 'contextmenu'){\n\t\t\tpos = calcMenuByPosition(menuEl, {left: e.clientX, top: e.clientY});\n\t\t}else{\n\t\t\tpos = alignMenuByNode(menuEl, target);\n\t\t}\n\t\tmenuEl.style.left = dimension2Style(pos.left);\n\t\tmenuEl.style.top = dimension2Style(pos.top);\n\t\tmenuEl.style.display = 'block';\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\treturn false;\n\t})\n}\n\n/**\n * 菜单关联一个坐标方式摆放，菜单摆放方式主要是光标下方或上方。\n * @param {HTMLElement} menuEl\n * @param {Object} point\n * @returns {{top: number, left: number}}\n **/\nconst calcMenuByPosition = (menuEl, point) => {\n\tlet menu_dim = getDomDimension(menuEl);\n\tlet con_dim = {width: window.innerWidth, height: window.innerHeight};\n\tlet top, left = point.left;\n\n\tlet right_available = menu_dim.width + point.left <= con_dim.width;\n\tlet bottom_available = menu_dim.height + point.top <= con_dim.height;\n\tlet top_available = point.top - menu_dim.height > 0;\n\n\tif(right_available && bottom_available){\n\t\tleft = point.left;\n\t\ttop = point.top;\n\t}else if(right_available && !bottom_available){\n\t\tleft = point.left;\n\t\ttop = Math.max(con_dim.height - menu_dim.height, 0);\n\t}else if(!right_available && bottom_available){\n\t\tleft = Math.max(con_dim.width - menu_dim.width, 0);\n\t\ttop = point.top;\n\t}else if(!right_available && !bottom_available){\n\t\t//上方摆得下\n\t\tif(top_available){\n\t\t\tleft = Math.max(con_dim.width - menu_dim.width, 0);\n\t\t\ttop = point.top - menu_dim.height;\n\t\t}else{\n\t\t\tleft = Math.max(con_dim.width - menu_dim.width, 0);\n\t\t\ttop = point.top;\n\t\t}\n\t}\n\treturn {top, left};\n}\n\n/**\n * 菜单关联一个节点方式摆放，按照1、2、3、4种情况依次优先考虑\n * 摆放方式 1：\n * [-按钮-]\n * [ -- 菜单 -- ]\n * 摆放方式 2：\n *       [-按钮-]\n * [ -- 菜单 -- ]\n * 摆放方式 3：\n * [ -- 菜单 -- ]\n * [-按钮-]\n * 摆放方式 4：\n * [ -- 菜单 -- ]\n *       [-按钮-]\n * @param {HTMLElement} menuEl\n * @param {HTMLElement} relateNode\n * @returns {{top: number, left: number}}\n */\nconst alignMenuByNode = (menuEl, relateNode) => {\n\tlet top, left;\n\tlet menu_dim = getDomDimension(menuEl);\n\tlet relate_node_offset = relateNode.getBoundingClientRect();\n\tlet con_dim = {width: window.innerWidth, height: window.innerHeight};\n\n\t//上面放得下，且下面放不下情况，才放上面\n\tif((con_dim.height - relate_node_offset.top) > menu_dim.height && (con_dim.height - relate_node_offset.top - relate_node_offset.height) < menu_dim.height){\n\t\ttop = relate_node_offset.top - menu_dim.height;\n\t}else{\n\t\ttop = relate_node_offset.top + relate_node_offset.height;\n\t}\n\n\t//左边放得下，且右边放不下情况，才放左边\n\tif((relate_node_offset.left + relate_node_offset.width) > menu_dim.width && (con_dim.width - relate_node_offset.left) < menu_dim.width){\n\t\tleft = relate_node_offset.left + relate_node_offset.width - menu_dim.width;\n\t}else{\n\t\tleft = relate_node_offset.left;\n\t}\n\treturn {top, left};\n}\n\n/**\n *\n * 子菜单摆放方式计算（子菜单特点：只摆在菜单项两侧）\n * 子菜单父级为 relative，子菜单为 absolute\n * 摆放方式 1：\n * [-按钮-][ -- 菜单 -- ]\n *        [ -- 菜单 -- ]\n *\n * 摆放方式 2：\n *        [ -- 菜单 -- ]\n * [-按钮-][ -- 菜单 -- ]\n *        [ -- 菜单 -- ]\n *\n * 摆放方式 3：\n * [ -- 菜单 -- ][-按钮-]\n * [ -- 菜单 -- ]\n * [ -- 菜单 -- ]\n * 摆放方式 4：\n * [ -- 菜单 -- ]\n * [ -- 菜单 -- ][-按钮-]\n * [ -- 菜单 -- ]\n * @param subMenuEl\n * @param triggerMenuItem\n * @returns {{top: number, left: number}}\n */\nconst alignSubMenuByNode = (subMenuEl, triggerMenuItem) => {\n\tlet menu_dim = getDomDimension(subMenuEl);\n\tlet relate_node_offset = triggerMenuItem.getBoundingClientRect();\n\tlet con_dim = {width: window.innerWidth, height: window.innerHeight};\n\n\t//由于上级菜单采用absolute布局，子菜单仅需根据上级菜单做相对定位\n\tlet top;\n\tlet left;\n\n\t//下面放不下，且上面还有空间，否则还是放下面\n\tif((relate_node_offset.top + menu_dim.height > con_dim.height) && con_dim.height >= menu_dim.height){\n\t\ttop = con_dim.height - (relate_node_offset.top + menu_dim.height);\n\t} else {\n\t\ttop = 0;\n\t}\n\n\t//右边放不下，且左边有空间\n\n\t//左边放得下，且右边放不下情况，才放左边\n\tif(relate_node_offset.left > menu_dim.width && (relate_node_offset.left + relate_node_offset.width + menu_dim.width > con_dim.width)){\n\t\tleft = 0 - menu_dim.width;\n\t}else{\n\t\tleft = relate_node_offset.width;\n\t}\n\treturn {top, left};\n}\n\ndocument.addEventListener('click', e => {\n\thideLastMenu();\n});\n\ndocument.addEventListener('keyup', e => {\n\tif(e.keyCode === KEYS.Esc){\n\t\thideLastMenu();\n\t}\n});","import {Theme} from \"./Theme.js\";\nimport {createDomByHtml, getDomOffset, hide, insertStyleSheet, show} from \"../Lang/Dom.js\";\nimport {Tip} from \"./Tip.js\";\nimport {dimension2Style} from \"../Lang/Html.js\";\n\nconst COM_ID = Theme.Namespace + 'novice-guide';\nconst CLASS_PREFIX = COM_ID;\nconst PADDING_SIZE = '5px';\n\ninsertStyleSheet(`\n\t.${CLASS_PREFIX}-highlight {\n\t\tposition:absolute; \n\t\tz-index:10000;\n\t\t--novice-guide-highlight-padding:${PADDING_SIZE}; \n\t\tbox-shadow:0 0 10px 2000px #00000057; \n\t\tborder-radius:var(${Theme.CssVar.PANEL_RADIUS}); \n\t\tpadding:var(--novice-guide-highlight-padding); \n\t\tmargin:calc(var(--novice-guide-highlight-padding) * -1) 0 0 calc(var(--novice-guide-highlight-padding) * -1); \n\t}\n\t.${CLASS_PREFIX}-btn {user-select:none; cursor:pointer;}\n\t.${CLASS_PREFIX}-masker {width:100%; height:100%; position:absolute; left:0; top:0; z-index:10000}\n\t.${CLASS_PREFIX}-counter {float:left; color:${Theme.CssVar.COLOR}; opacity:0.7} \n\t.${CLASS_PREFIX}-next-wrap {text-align:right; margin-top:10px;}\n`, COM_ID);\n\nlet highlightHelperEl, //开窗效果\n\tmaskerEl; //阻隔层，防止点击到下部页面\nconst show_highlight_zone = (highlightNode) => {\n\thide_highlight_zone();\n\tif(!highlightHelperEl){\n\t\thighlightHelperEl = createDomByHtml(`<div class=\"${CLASS_PREFIX}-highlight\"></div>`, document.body);\n\t\tmaskerEl = createDomByHtml(`<div class=\"${CLASS_PREFIX}-masker\"></div>`, document.body)\n\t}\n\tshow(maskerEl);\n\tshow(highlightHelperEl);\n\tif(highlightNode){\n\t\tlet hlnOffset = getDomOffset(highlightNode);\n\t\thighlightHelperEl.style.left = dimension2Style(hlnOffset.left);\n\t\thighlightHelperEl.style.top = dimension2Style(hlnOffset.top);\n\t\thighlightHelperEl.style.width = dimension2Style(highlightNode.offsetWidth);\n\t\thighlightHelperEl.style.height = dimension2Style(highlightNode.offsetHeight);\n\t\treturn;\n\t}\n\thighlightHelperEl.style.left = dimension2Style(document.body.offsetWidth/2);\n\thighlightHelperEl.style.top = dimension2Style(300);\n\thighlightHelperEl.style.width = dimension2Style(1);\n\thighlightHelperEl.style.height = dimension2Style(1);\n\treturn highlightHelperEl;\n};\n\nconst hide_highlight_zone = () => {\n\tmaskerEl && hide(maskerEl);\n\thighlightHelperEl && hide(highlightHelperEl);\n};\n\n/**\n * @param {Object[]} steps 步骤内容\n * @param {String} steps.content 步骤内容\n * @param {HTMLElement} steps.relateNode 步骤内容\n * @param config\n */\nconst showNoviceGuide = (steps, config = {}) => {\n\tconfig = Object.assign({\n\t\tnext_button_text: '下一步',\n\t\tprev_button_text: '上一步',\n\t\tfinish_button_text: '完成',\n\t\ttop_close: false,  //是否显示顶部关闭按钮\n\t\tcover_included: false, //提供的步骤里面是否包含封面步骤\n\t\tshow_counter: false, //是否显示计数器\n\t\ton_finish: function(){\n\t\t} //完成显示后的回调(包含顶部关闭操作)\n\t}, config);\n\n\tlet step_size = steps.length;\n\tlet show_one = function(){\n\t\tif(!steps.length){\n\t\t\thide_highlight_zone();\n\t\t\tconfig.on_finish();\n\t\t\treturn;\n\t\t}\n\n\t\tlet step = steps[0];\n\t\tsteps.shift();\n\n\t\tlet showing_cover = config.cover_included && step_size === (steps.length + 1);\n\t\tlet highlightHelperEl;\n\n\t\t//masker\n\t\tif(showing_cover){\n\t\t\thighlightHelperEl = show_highlight_zone(null, {\n\t\t\t\tleft: document.body.offsetWidth / 2,\n\t\t\t\ttop: 300,\n\t\t\t\twidth: 1,\n\t\t\t\theight: 1\n\t\t\t})\n\t\t}else{\n\t\t\thighlightHelperEl = show_highlight_zone(step.relateNode);\n\t\t}\n\n\t\tlet next_html = `<div class=\"${CLASS_PREFIX}-next-wrap\">`;\n\n\t\tif((steps.length + 2) <= step_size.length){\n\t\t\tnext_html += `<span class=\"${CLASS_PREFIX}-btn ${CLASS_PREFIX}-prev-btn \">${config.prev_button_text}</span> `;\n\t\t}\n\t\tif(steps.length && config.next_button_text){\n\t\t\tnext_html += `<span class=\"${CLASS_PREFIX}-btn ${CLASS_PREFIX}-next-btn\">${config.next_button_text}</span>`;\n\t\t}\n\t\tif(!steps.length && config.finish_button_text){\n\t\t\tnext_html += `<span class=\"${CLASS_PREFIX}-btn ${CLASS_PREFIX}-finish-btn\">${config.finish_button_text}</span>`;\n\t\t}\n\t\tif(config.show_counter){\n\t\t\tnext_html += `<span class=\"${CLASS_PREFIX}-counter\">${step_size.length - steps.length}/${step_size.length}</span>`;\n\t\t}\n\t\tnext_html += `</div>`;\n\n\t\tlet tp = new Tip(`<div class=\"${CLASS_PREFIX}-content\">${step.content}</div>${next_html}`, showing_cover ? highlightHelperEl : step.relateNode, {\n\t\t\tshowCloseButton: config.top_close,\n\t\t\tdir: showing_cover ? 6 : 'auto'\n\t\t});\n\t\ttp.onHide.listen(function(){\n\t\t\ttp.destroy();\n\t\t\thide_highlight_zone();\n\t\t\tconfig.on_finish();\n\t\t});\n\t\ttp.onShow.listen(function(){\n\t\t\ttp.dom.style.zIndex = \"10001\";\n\t\t\ttp.dom.querySelector(`.${CLASS_PREFIX}-next-btn,.${CLASS_PREFIX}-finish-btn`).addEventListener('click', function(){\n\t\t\t\ttp.destroy();\n\t\t\t\tshow_one();\n\t\t\t});\n\t\t\tlet prevBtn = tp.dom.querySelector(`.${CLASS_PREFIX}-prev-btn`);\n\t\t\tif(prevBtn){\n\t\t\t\tprevBtn.addEventListener('click', function(){\n\t\t\t\t\ttp.destroy();\n\t\t\t\t\tlet len = steps.length;\n\t\t\t\t\tsteps.unshift(step_size[step_size.length - len - 1]);\n\t\t\t\t\tsteps.unshift(step_size[step_size.length - len - 2]);\n\t\t\t\t\tshow_one();\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\ttp.show();\n\t};\n\tshow_one();\n}\nexport {showNoviceGuide};","import {Theme} from \"./Theme.js\";\nimport {onDomTreeChange} from \"../Lang/Dom.js\";\n\nconst CLS_ON_DRAG = Theme.Namespace + '-on-drag';\nconst CLS_DRAG_PROXY = Theme.Namespace + '-drag-proxy';\n\n/**\n * 匹配事件对象到指定父容器子节点列表中\n * @param {Node} container\n * @param {Node} eventTarget\n * @return {Node}\n */\nconst matchChildren = (container, eventTarget) => {\n\tlet children = Array.from(container.children);\n\tlet p = eventTarget;\n\twhile(p){\n\t\tif(children.includes(p)){\n\t\t\treturn p;\n\t\t}\n\t\tp = p.parentNode;\n\t}\n\tthrow \"event target no in container\";\n}\n\n/**\n * 节点排序\n * @param {Node} listNode 列表父容器（函数自动监听容器子节点变化，重新绑定）\n * @param {Object|Null} option 选项\n * @param {String} option.ClassOnDrag 占位对象类名\n * @param {String} option.ClassProxy 拖动过程代理对象类名\n * @param {Function} onChange\n */\nexport const sortable = (listNode, option = null, onChange = () => {\n}) => {\n\tlet currentNode = null;\n\tlet currentParent = null; //当前父级，避免多个拖动组件使用出现混淆\n\toption = option || {};\n\tlet ClassOnDrag = option.ClassOnDrag || CLS_ON_DRAG;\n\tlet ClassProxy = option.ClassProxy || CLS_DRAG_PROXY;\n\n\tlet set = () => {\n\t\tArray.from(listNode.children).forEach(child => child.setAttribute('draggable', 'true'));\n\t};\n\n\tonDomTreeChange(listNode, set, false);\n\tset();\n\n\tlistNode.addEventListener('dragover', e=>{\n\t\te.preventDefault();\n\t});\n\n\tlistNode.addEventListener('dragstart', e => {\n\t\tif(e.target === listNode){\n\t\t\treturn;\n\t\t}\n\t\tlet tag = matchChildren(listNode, e.target);\n\t\tcurrentNode = tag;\n\t\tcurrentParent = listNode;\n\t\tcurrentNode.classList.add(ClassProxy);\n\t\tsetTimeout(() => {\n\t\t\ttag.classList.remove(ClassProxy);\n\t\t\ttag.classList.add(ClassOnDrag);\n\t\t}, 0);\n\t\treturn false;\n\t});\n\tlistNode.addEventListener('dragenter', e => {\n\t\tif(e.target === listNode){\n\t\t\treturn;\n\t\t}\n\t\tlet tag = matchChildren(listNode, e.target);\n\t\tif(!currentNode || currentParent !== listNode || tag === listNode || tag === currentNode){\n\t\t\treturn;\n\t\t}\n\t\tlet children = Array.from(listNode.children); //实时从拖动之后的children中拿\n\t\tlet currentIndex = children.indexOf(currentNode);\n\t\tlet targetIndex = children.indexOf(tag);\n\t\tif(currentIndex > targetIndex){\n\t\t\tlistNode.insertBefore(currentNode, tag.previousSibling);\n\t\t}else{\n\t\t\tlistNode.insertBefore(currentNode, tag.nextSibling);\n\t\t}\n\t\tonChange(currentIndex, targetIndex);\n\t});\n\tlistNode.addEventListener('dragend', e => {\n\t\tif(e.target === listNode){\n\t\t\treturn;\n\t\t}\n\t\tlet tag = matchChildren(listNode, e.target);\n\t\tcurrentNode = null;\n\t\tcurrentParent = null;\n\t\ttag.classList.remove(ClassOnDrag);\n\t});\n}","import {guid} from \"../Lang/Util.js\";\r\nimport {createDomByHtml, insertStyleSheet} from \"../Lang/Dom.js\";\r\nimport {Theme} from \"./Theme.js\";\r\nimport {escapeHtml} from \"../Lang/Html.js\";\r\nimport {eventDelegate} from \"../Lang/Event.js\";\r\n\r\nlet CLASS_PREFIX = Theme.Namespace + 'toc';\r\n\r\ninsertStyleSheet(`\r\n\t.${CLASS_PREFIX}-wrap {}\r\n\t.${CLASS_PREFIX}-wrap ul {list-style:none; padding:0; margin:0}\r\n\t.${CLASS_PREFIX}-wrap li {padding-left:calc((var(--toc-item-level) - 1) * 10px)}\r\n\t.${CLASS_PREFIX}-collapse>ul {display:none;}\r\n\t.${CLASS_PREFIX}-title {display:block; margin:0.1em 0 0; cursor:pointer; user-select:none; padding:0.5em 1em 0.5em 2em;}\r\n\t.${CLASS_PREFIX}-title:hover {border-radius:var(${Theme.CssVar.PANEL_RADIUS})}\r\n\t.${CLASS_PREFIX}-toggle {position:absolute; vertical-align:middle; width:0; height:0; border:0.4em solid transparent; margin:1em 0 0 0.5em; border-top-color:var(${Theme.CssVar.COLOR}); opacity:0; cursor:pointer;}\r\n\t.${CLASS_PREFIX}-collapse>.${CLASS_PREFIX}-toggle {border-top-color:transparent; border-left-color:var(${Theme.CssVar.COLOR}); margin:.75em 0 0 0.5em;}\r\n\tli:hover>.${CLASS_PREFIX}-toggle {opacity:.4}\r\n\t.${CLASS_PREFIX}-wrap .${CLASS_PREFIX}-toggle:hover {opacity:0.8}\r\n`, Theme.Namespace + 'toc-style');\r\n\r\nconst renderEntriesListHtml = (entries, config) => {\r\n\tconsole.log(config);\r\n\tlet html = '<ul>';\r\n\tentries.forEach(entry => {\r\n\t\thtml += `<li data-id=\"${entry.id}\" data-level=\"${entry.level}\" style=\"--toc-item-level:${entry.level}\">\r\n\t\t\t\t\t${config.collapseAble && entry.children.length ? `<span class=\"${CLASS_PREFIX}-toggle\"></span>` : ''}\r\n\t\t\t\t\t<span class=\"${CLASS_PREFIX}-title\">${escapeHtml(entry.title)}</span>`;\r\n\t\tif(entry.children.length){\r\n\t\t\thtml += renderEntriesListHtml(entry.children, config);\r\n\t\t}\r\n\t});\r\n\thtml += '</ul>';\r\n\treturn html;\r\n}\r\n\r\nconst searchNodeById = (id, entries) => {\r\n\tfor(let i = 0; i < entries.length; i++){\r\n\t\tif(entries[i].id === id){\r\n\t\t\treturn entries[i].relateNode;\r\n\t\t}\r\n\t\tif(entries[i].children.length){\r\n\t\t\tlet m = searchNodeById(id, entries[i].children);\r\n\t\t\tif(m){\r\n\t\t\t\treturn m;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tconsole.warn('no matched', id, entries);\r\n\treturn null;\r\n}\r\n\r\nclass Toc {\r\n\tdom = null; //toc 面板 DOM\r\n\tconfig = {\r\n\t\tcontainer: null, //toc 挂载的容器\r\n\t\tcollapseAble: true, //是否支持折叠\r\n\t};\r\n\r\n\tconstructor(entries, config = {}){\r\n\t\tthis.config = Object.assign(this.config, {container:document.body}, config);\r\n\t\tthis.dom = createDomByHtml(`<div class=\"${CLASS_PREFIX}-wrap\">\r\n\t\t\t\t${renderEntriesListHtml(entries, this.config)}\r\n\t\t\t</div>`, this.config.container);\r\n\t\tthis.dom.querySelectorAll(`li>span.${CLASS_PREFIX}-title`).forEach(span => {\r\n\t\t\tlet id = span.parentNode.getAttribute('data-id');\r\n\t\t\tspan.addEventListener('click', e => {\r\n\t\t\t\tlet n = searchNodeById(id, entries);\r\n\t\t\t\tn.focus();\r\n\t\t\t\tn.scrollIntoView({behavior: 'smooth'});\r\n\t\t\t});\r\n\t\t});\r\n\t\teventDelegate(this.dom, `.${CLASS_PREFIX}-toggle`, 'click', (e, target)=>{\r\n\t\t\tlet li = target.closest('li');\r\n\t\t\tli.classList.toggle(CLASS_PREFIX+'-collapse');\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * 从指定 DOM 容器中解析标题节点并创建 TOC\r\n\t * @param {HTMLElement} container\r\n\t * @param {Object} config\r\n\t */\r\n\tstatic createFromHeading(container = null, config = {}){\r\n\t\tcontainer = container || document;\r\n\t\tlet entries = Toc.resolveHeading(container);\r\n\t\treturn new Toc(entries, config);\r\n\t}\r\n\r\n\t/**\r\n\t * 从指定 DOM 节点中解析出标题节点列表\r\n\t * @param {HTMLElement} container\r\n\t */\r\n\tstatic resolveHeading(container){\r\n\t\tlet levelMaps = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6'];\r\n\t\tlet allHeadings = Array.from(container.querySelectorAll(levelMaps.join(','))) || [];\r\n\t\tlet entries = [\r\n\t\t\t//{id, title, level, relateNode, [\r\n\t\t\t// \t\t{id, title, level, relateNode, children}\r\n\t\t\t// \t\t{id, title, level, relateNode, children}\r\n\t\t\t// \t\t{id, title, level, relateNode, children}\r\n\t\t\t// ]}\r\n\t\t\t//{id, title, level, relateNode, children}\r\n\t\t\t//{id, title, level, relateNode, children}\r\n\t\t];\r\n\t\tconst addResult = (title, level, relateNode, list) => {\r\n\t\t\tif(!list.length){\r\n\t\t\t\treturn list.push({id: guid('toc-'), title, level, relateNode, children: []});\r\n\t\t\t}\r\n\t\t\tif(list[list.length - 1].level < level){\r\n\t\t\t\taddResult(title, level, relateNode, list[list.length - 1].children);\r\n\t\t\t}else if(list[list.length - 1].level === level){\r\n\t\t\t\treturn list.push({id: guid('toc-'), title, level, relateNode, children: []});\r\n\t\t\t}else{\r\n\t\t\t\taddResult(title, level, relateNode, list[list.length - 1].children);\r\n\t\t\t}\r\n\t\t}\r\n\t\tallHeadings.forEach(relateNode => {\r\n\t\t\tlet level = parseInt(relateNode.tagName.replace(/\\D+/g, ''), 10);\r\n\t\t\tlet title = relateNode.innerText;\r\n\t\t\taddResult(title, level, relateNode, entries);\r\n\t\t});\r\n\t\tconsole.log(entries);\r\n\t\treturn entries;\r\n\t}\r\n}\r\n\r\nexport {Toc};"],"names":["GOLDEN_RATIO","Math","sqrt","between","val","min","max","includeEqual","randomInt","floor","random","round","num","precision","multiple","pow","extract","es_template","params","names","Object","keys","values","Function","toHtmlEntities","str","replace","s","match","charCodeAt","explodeBy","separator","items","split","map","item","trim","filter","length","fromHtmlEntities","String","fromCharCode","stripSlashes","n1","formatSize","isNaN","i","abs","units","cutString","len","eclipse_text","undefined","r","substr","regQuote","utf8Decode","srcStr","t","n","c2","c3","isValidUrl","urlString","Boolean","URL","e","isJSON","json","is_json","JSON","parse","error","utf8Encode","getUTF8StrLen","realLength","charCode","randomString","sourceStr","codes","rnd","substring","randomWords","count","letterMax","words","possible","possibleVowels","word","push","randomSentence","maxLength","multipleLine","wordCount","ceil","sep","text","forEach","join","strToPascalCase","capitalize_first","idx","capitalize","charAt","toUpperCase","slice","isNum","TRIM_BOTH","TRIM_LEFT","TRIM_RIGHT","chars","dir","regLeft","RegExp","regRight","trimStart","trimEnd","BLOCK_TAGS","REMOVABLE_TAGS","html2Text","html","tag","ms","tail","includes","toLowerCase","matchReg","replacement","dec","dimension2Style","h","cssSelectorEscape","window","CSS","escape","entityToString","entity","entities","pop","parseInt","_helper_div","decodeHTMLEntities","document","createElement","innerHTML","textContent","escapeHtml","unescapeHtml","escapeAttr","preserveCR","stringToEntity","radix","arr","toString","highlightText","kw","replaceTpl","_guid","guid","prefix","getCurrentScript","source","Error","currentStackFrameRegex","name","lastStackFrameRegex","exec","stack","throttle","fn","intervalMiSec","context","args","previous","now","Date","this","arguments","apply","debounce","timeout","clearTimeout","setTimeout","CURRENT_FILE","getLibEntryScript","script","indexOf","getLibModule","async","import","getLibModuleTop","top","WEBCOM_GET_LIB_MODULE","normalizeVersion","version","partsLength","value","piece","pieces","parts","versionCompare","version1","version2","index","stringLength","v1","v2","size","doOnce","markKey","dataFetcher","storageType","MARKUP_STR_VAL","markUp","key","setCookie","localStorage","setItem","sessionStorage","Promise","onHit","noHit","getCookie","getItem","getMarkState","then","ParallelPromise","parallel_limit","current_running_count","task_stack","constructor","parallelLimit","loop","promiseFn","resolve","reject","shift","finally","addPromiseFn","console","log","isObject","Array","isArray","mergeDeep","target","sources","assign","isPromise","obj","PROMISE_STATE_PENDING","PROMISE_STATE_FULFILLED","PROMISE_STATE_REJECTED","getPromiseState","promise","race","v","catch","WEBCOM_GET_SCRIPT_ENTRY","getViewWidth","innerWidth","getViewHeight","innerHeight","hide","dom","style","display","remove","parentNode","removeChild","show","toggle","toShow","findOne","selector","parent","querySelector","findAll","from","querySelectorAll","getDomOffset","rect","getBoundingClientRect","width","height","bottom","left","right","x","y","fireEvent","el","event","evo","createEvent","initEvent","dispatchEvent","isButton","tagName","getAttribute","matchParent","closest","domContained","contains","child","compareDocumentPosition","getFocusableElements","isNodeHidden","node","offsetParent","onDomTreeChange","callback","includeElementChanged","tm","PRO_KEY","payload","watchEls","els","setAttribute","addEventListener","MutationObserver","observe","attributes","subtree","childList","domChangedWatch","container","matchedSelector","notification","executionFirst","keepRectCenter","containerDimension","keepDomInContainer","body","keepRectInContainer","clientWidth","clientHeight","objDim","ctnDim","ret","getDomDimension","org_visibility","visibility","org_display","rectAssoc","rect1","rect2","isElement","HTMLElement","nodeType","ownerDocument","_c","loadCss","file","forceReload","link","rel","href","onload","onerror","head","append","loadScript","src","insertStyleSheet","styleSheetStr","id","doc","appendChild","getRegion","win","info","screenLeft","screenX","screenTop","screenY","visibleWidth","visibleHeight","horizenScroll","pageXOffset","verticalScroll","pageYOffset","tmp","documentElement","scrollLeft","scrollTop","scrollWidth","documentWidth","documentHeight","scrollHeight","rectInLayout","layout","setStyle","nodeHighlight","pattern","hlClass","skip","pos","data","search","spanNode","className","middleBit","splitText","middleClone","cloneNode","replaceChild","childNodes","test","tabConnect","tabs","contents","option","contentActiveClass","tabActiveClass","triggerEvent","tab","ctn","classList","add","createDomByHtml","tpl","nodes","content","repaint","element","delay","hidden","offsetHeight","_","enterFullScreen","requestFullscreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullScreen","exitFullScreen","exitFullscreen","toggleFullScreen","isInFullScreen","fullscreenElement","CURRENT_WINDOW","setContextWindow","getContextDocument","getContextWindow","err","warn","days","path","expires","date","setTime","getTime","toUTCString","cookie","nameEQ","ca","c","deleteCookie","NS","VAR_PREFIX","ICON_FONT","CSS_VAR_COLOR","CSS_VAR_COLOR_LIGHTEN","CSS_VAR_DISABLE_COLOR","CSS_VAR_BACKGROUND_COLOR","CSS_VAR_PANEL_SHADOW","CSS_VAR_PANEL_BORDER","CSS_VAR_PANEL_BORDER_COLOR","CSS_VAR_PANEL_RADIUS","CSS_VAR_FULL_SCREEN_BACKDROP_FILTER","CSS_VAR_FULL_SCREEN_BACKGROUND_COLOR","Theme","Namespace","CssVarPrefix","CssVar","COLOR","CSS_LIGHTEN","DISABLE_COLOR","BACKGROUND_COLOR","PANEL_SHADOW","PANEL_BORDER","PANEL_BORDER_COLOR","PANEL_RADIUS","FULL_SCREEN_BACKDROP_FILTER","FULL_SCREEN_BACKGROUND_COLOR","IconFont","TipIndex","MaskIndex","DialogIndex","FullScreenModeIndex","ContextIndex","ToastIndex","COM_ID","TOAST_CLS_MAIN","rotate_animate","fadeIn_animate","fadeOut_animate","toastWrap","getWrapper","Toast","static","TYPE_INFO","TYPE_SUCCESS","TYPE_WARNING","TYPE_ERROR","TYPE_LOADING","message","type","DEFAULT_TIME_MAP","timeoutCallback","toast","showToast","delayMicroseconds","time","onTimeoutClose","wrapper","showPopover","fadeOut","hidePopover","ToastClass","resolveFileExtension","fileName","segList","resolveFileName","readFileInLine","linePayload","onFinish","onError","reader","FileReader","offset","line_buff","seek","readAsArrayBuffer","evt","TextDecoder","decode","Uint8Array","result","break_down","lines","find","line","BizEvent","events","breakOnFalseReturn","listen","ev","clean","fire","breakFlag","onHover","hoverIn","hoverOut","bindNodeActive","cancelBubble","triggerAtOnce","keyCode","KEYS","Space","Enter","call","onDocReady","readyState","triggerDomEvent","bindNodeEvents","eventDelegate","eventName","matches","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","BackSpace","Esc","RightArrow","Tab","DownArrow","Clear","PageUp","Insert","PageDown","Delete","Shift","End","NumLock","Control","Home","Alt","LeftArrow","CapsLock","UpArrow","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","NumPad0","NumPad1","NumPad2","NumPad3","NumPad4","NumPad5","NumPad6","NumPad7","NumPad8","NumPad9","NumPadMultiple","NumPadPlus","NumPadDash","NumPadDot","NumPadSlash","NumPadEnter","HTTP_METHOD","GET","POST","PUT","DELETE","OPTIONS","HEAD","CONNECT","TRACE","REQUEST_FORMAT","FORM","REQUEST_CONTENT_TYPE_MAP","REQUEST_DATA_HANDLE_MAP","method","FormData","k","stringify","QueryString","RESPONSE_FORMAT","XML","HTML","TEXT","RESPONSE_ACCEPT_TYPE_MAP","mergerUriParam","uri","setHash","location","getHash","hash","requestJSON","url","Net","getJSON","postJSON","uploadFile","fileMap","callbacks","extParam","onSuccess","onProgress","onAbort","showError","formData","total","xhr","XMLHttpRequest","withCredentials","upload","loaded","status","responseText","statusText","open","setRequestHeader","send","cgi","requestFormat","responseFormat","headers","onResponse","onStateChange","lengthComputable","onreadystatechange","abort","get","request","post","req","downloadFile","save_name","download","click","retObj","q","decodeURIComponent","query","param","hasOwnProperty","encodeURI","openLinkWithoutReferer","instance","write","close","arrayColumn","col_name","arrayIndex","isEquals","obj1","obj2","keys1","keys2","every","arrayDistinct","tmpMap","Map","has","set","arrayGroup","by_key","limit","tmp_rst","rst","sortByKey","sort","reduce","chunk","list","res","integer","rest","splice","objectPushByPath","srcObj","glue","segment","segments","cursor","objectGetByPath","ps","arrayFilterTree","parent_id","all_list","level","group_by_parents","pn_k","return_as_tree","level_key","id_key","parent_id_key","children_key","lv_k","id_k","as_tree","c_k","subTrees","concat","inputAble","HTMLFormElement","disabled","readOnly","getElementValue","checked","vs","formSync","getter","setter","getAvailableElements","current_val","checkValidity","reportValidity","ignore_empty_name","formValidate","name_validate","pass","formSerializeString","validate","data_list","getFormDataAvailable","data_string_list","encodeURIComponent","serializePhpFormToJSON","json_obj","index_tmp","name_path","fixGetFormAction","form","ipt","action","searchParams","bindFormSubmitAsJSON","onSubmitting","submitting","formSerializeJSON","preventDefault","name_counts","convertFormDataToObject","formDataMap","formatSchema","mustExistsInSchema","define","_form_data_cache_init","_form_data_cache_new","_form_us_msg","_form_us_sid_attr_key","bindFormUnSavedUnloadAlert","alertMsg","us_sid","msg","validateFormChanged","returnValue","resetFormChangedState","convertObjectToFormData","objectMap","boolMapping","buildHtmlHidden","maps","SUBMITTING_FLAG","ACAsync","rsp","next","forward_url","reload","active","onsuccess","COMMON_SUCCESS_RESPONSE_HANDLE","submitter","formAction","fixFormAction","loader","showLoadingLater","code","removeAttribute","DLG_CLS_PREF","DLG_CLS_TI","DLG_CLS_CTN","DLG_CLS_OP","DLG_CLS_TOP_CLOSE","DLG_CLS_BTN","DLG_CLS_WEAK_BTN","IFRAME_ID_ATTR_FLAG","STATE_ACTIVE","STATE_DISABLED","STATE_HIDDEN","DIALOG_TYPE_ATTR_KEY","TYPE_PROMPT","TYPE_CONFIRM","DLG_CTN_TYPE_IFRAME","DLG_CTN_TYPE_HTML","current","DialogManager","getFrontDialog","config","showTopCloseButton","stopImmediatePropagation","DIALOG_COLLECTION","sortZIndex","dialog1","dialog2","zIndex","getModalDialogs","excludedDialog","d","state","modal","getNoModalDialogs","getAllAvailableDialogs","modalDialogs","setState","dlg","toState","setZIndex","setType","register","noModalDialogs","Dialog","DIALOG_INIT_Z_INDEX","onShow","destroy","onClose","dialogs","trySetFront","otherNoModalDialogs","closeAll","findById","resolveContentType","domConstruct","transparent","title","CONTENT_MIN_HEIGHT","renderContent","buttons","button","default","iframe","obs","upd","bdy","contentWindow","disconnect","autoResizeIframeHeight","CUSTOM_EVENT_BUCKS","DEFAULT_WIDTH","cb","bind","close_btn","eventBind","fireCustomEvent","listenCustomEvent","p","confirm","opt","alert","iframeSrc","prompt","initValue","input_id","input","focus","getCurrentFrameDialog","frameElement","CONTEXT_WINDOW","DialogClass","DialogManagerClass","ACDialog","innerText","ACConfirm","GUID_BIND_KEY","TRY_DIR_MAP","TIP_COLLECTION","calcTipPositionByDir","tipWidth","tipHeight","relateNodeHeight","relateNodeWidth","updatePosition","tipObj","direction","offsetWidth","relateNodePos","relateNode","rh","rw","relateNodeOffset","viewRegion","offsetLeft","offsetTop","layout_rect","calDir","Tip","showCloseButton","onHide","onDestroy","tip","setContent","hideAll","bindNode","triggerType","bindAsync","loading","rspHtml","ACTip","init","triggertype","trans","domain","copy","silent","txtNode","cssText","scrollTo","select","succeeded","execCommand","showSuccess","copyFormatted","activeSheets","prototype","styleSheets","sheet","getSelection","removeAllRanges","range","createRange","selectNode","addRange","ACCopy","ACToast","BASE64_KEY_STR","base64Decode","o","u","a","f","base64UrlSafeEncode","Base64Encode","convertBlobToBase64","blob","blobToBase64","readAsDataURL","loadImgBySrc","img","Image","onabort","getHighestResFromSrcSet","srcset_str","acc","getBase64BySrc","responseType","response","base64","getBase64ByImg","canvas","getContext","drawImage","toDataURL","scaleFixCenter","contentWidth","contentHeight","containerWidth","containerHeight","spacing","zoomIn","ratioX","ratioY","ratio","getAverageRGB","imgEl","defaultRGB","g","b","rgb","naturalHeight","naturalWidth","getImageData","blockSize","json_decode","handler_callbacks","newVal","oldVal","ls_listen_flag","LocalStorageSetting","namespace","settingKeys","defaultSetting","removeItem","onUpdated","newValue","oldValue","each","removeAll","getAll","DOM_CLASS","ATTR_W_BIND_KEY","ATTR_H_BIND_KEY","DISABLED_ATTR_KEY","BASE_INDEX","OP_INDEX","OPTION_DLG_INDEX","IMG_PREVIEW_MODE_SINGLE","IMG_PREVIEW_MODE_MULTIPLE","IMG_PREVIEW_MS_SCROLL_TYPE_NONE","IMG_PREVIEW_MS_SCROLL_TYPE_SCALE","IMG_PREVIEW_MS_SCROLL_TYPE_NAV","PREVIEW_DOM","CURRENT_MODE","CMD_CLOSE","CMD_NAV_TO","navTo","CMD_SWITCH_TO","switchTo","CMD_THUMB_SCROLL_PREV","thumbScroll","CMD_THUMB_SCROLL_NEXT","CMD_ZOOM_OUT","zoom","CMD_ZOOM_IN","CMD_ZOOM_ORG","CMD_ROTATE_LEFT","rotate","CMD_ROTATE_RIGHT","CMD_VIEW_ORG","viewOriginal","CMD_DOWNLOAD","srcSetResolve","IMG_SRC_LIST","IMG_CURRENT_INDEX","original","CMD_OPTION","showOptionDialog","DEFAULT_SETTING","mouse_scroll_type","allow_move","show_thumb_list","show_toolbar","LocalSetting","srcSet","thumb","normal","removeEventListener","onWinResize","bindKeyDown","updateNavState","prev","thumbScrollIntoView","showImgSrc","img_index","imgItem","img_ctn","moving","lastOffset","clientX","clientY","marginLeft","marginTop","bindImgMove","stopPropagation","resize_tm","resetView","toPrev","thumb_wrap","max_scroll_left","scroll_left","scrollIntoView","ratioOffset","origin_width","origin_height","degreeOffset","newRotate","transform","lsSetterTip","ALL_COMMANDS","TOOLBAR_OPTIONS","getCmdViaID","_id","mode","srcList","startIndex","showContextMenu","showToolbar","showThumbList","preloadSrcList","nav_thumb_list_html","preStr","option_html","lastVal","cmdInfo","handler","cmd","wheelDelta","showModal","constructDom","showImgPreview","imgSrc","showImgListPreview","imgSrcList","bindImgPreviewViaSelector","nodeSelector","srcFetcher","showImgPreviewFn","showImgListPreviewFn","resolveSrc","dataset","srcset","ACPreview","watchSelector","watch","clickNode","CLASS_PREFIX","renderItemChecker","selected","tabNav","liList","currentIndex","li","activeElement","Option","options","Select","required","placeholder","displaySearchInput","hideNoMatchItems","panelEl","searchEl","onChange","list_html","childOption","createPanel","chk","liElList","hidePanel","isShown","liEls","firstMatchedItem","blur","behavior","selectByIndex","selectedIndexList","selectByValues","getValues","getSelectedIndexes","selectedIndexes","showPanel","bindSelect","selectEl","sel","opt_group","label","resolveSelectOptions","showSelect","minWidth","selectedOptions","bindTextInput","inputEl","listTagId","datalistEl","getElementById","hasAttribute","resolveListOption","sh","ACSelect","ACHighlight","keyword","cssClass","SELECT_ALL_TEXT","UNSELECT_ALL_TEXT","ACSelectAll","checks","updBtn","checkedCount","__bind_select_all","toCheck","containerInit","ACMultiSelectRelate","coll","UPLOADER_IMAGE_DEFAULT_CLASS","UPLOADER_FILE_DEFAULT_CLASS","UPLOAD_STATE_EMPTY","UPLOAD_STATE_PENDING","UPLOAD_STATE_ERROR","UPLOAD_STATE_NORMAL","FILE_TYPE_STATIC_IMAGE","FILE_TYPE_IMAGE","FILE_TYPE_VIDEO","FILE_TYPE_AUDIO","FILE_TYPE_DOCUMENT","FILE_TYPE_SHEET","FILE_TYPE_ZIP","DEFAULT_REQUEST_HANDLE","rspJson","rspObj","abortUpload","up","updateState","fileEl","contentCtn","onClean","onUploading","Uploader","uploadUrl","uploadFileFieldName","allowFileTypes","fileSizeLimit","requestHandle","bindFileInput","initData","accepts","accept","virtualDom","insertBefore","nextSibling","mergeNoNull","globalUploadUrl","globalRequestHandle","acceptStr","files","objKeys","responseFormatValidate","percent","progressEl","progressPnt","getValue","getValueAsync","success_handle","error_handle","ACUploader","UI_STATE_ACTIVE","UI_STATE_INACTIVE","STATE_NORMAL","STATE_OVERLOAD","MAIN_CLASS","ACTextCounter","maxlength","trigger","updState","SUPPORT_INPUT_TYPES","DEFAULT_ATTR_COM_FLAG","COMPONENT_BIND_FLAG_KEY","AC_COMPONENT_NAME_MAPPING","dialog","preview","hl","highlight","selectall","selectrelate","textcounter","uploader","batchfiller","relative_elements","showInfo","shadow_el_html","required_attr","pattern_attr","placeholder_attr","title_attr","max_attr","min_attr","step_attr","step","id_attr","cloneElementAsHtml","label_html","doFill","indexes","selectedIndex","resolveDataParam","ComAlias","attr","objKeyPath","attr_flag","cs","parseComponents","activeStacks","init_count","componentAlias","bindActiveChain","TEXT_TYPES","readonly","isInputAble","pro","func","ACComponent","m_tm","ComponentName","unRegister","componentName","safeAdd","lsw","md5cmn","cnt","md5ff","md5gg","md5hh","md5ii","binlMD5","olda","oldb","oldc","oldd","binl2rstr","output","length32","rstr2binl","length8","rstr2hex","hexTab","str2rstrUTF8","unescape","rawMD5","rstrMD5","rawHMACMD5","bkey","ipad","opad","rstrHMACMD5","MD5","string","raw","hook_flag","RptEv","onReportApi","ReportingObserver","reports","types","buffered","payloads","popstate_bind","pushState","history","exePayloads","hashObj","ONE_MINUTE","ONE_HOUR","ONE_DAY","ONE_WEEK","ONE_MONTH_30","ONE_MONTH_31","ONE_YEAR_365","frequencyControl","interval","executeOnFistTime","_frq_tm","getMonthLastDay","year","month","getDate","getLastMonth","getNextMonth","prettyTime","micSec","delimiter","m","txt","monthsOffsetCalc","monthNum","start_date","getFullYear","getMonth","yearNum","button_init","initAutofillButton","scopeSelector","fillForm","tryPositionInFirstForm","scope","firstAvailableForm","formOrContainer","inputElements","radio_filled","all_radios","parseFloat","default_masker","CSS_CLASS","showMasker","masker","hideMasker","Masker","new_masker","CTX_CLASS_PREFIX","createMenu","commands","onExecute","payload_map","buildMenuItemHtml","cmdOrChildren","has_child","mnu_item_id","sub_menu_html","subItem","menu","sub_menu","parent_item","alignSubMenuByNode","LAST_MENU","hideLastMenu","bindTargetContextMenu","bindTargetMenu","bindTargetDropdownMenu","position","menuEl","calcMenuByPosition","alignMenuByNode","point","menu_dim","con_dim","right_available","bottom_available","top_available","relate_node_offset","subMenuEl","triggerMenuItem","highlightHelperEl","maskerEl","show_highlight_zone","highlightNode","hide_highlight_zone","hlnOffset","showNoviceGuide","steps","next_button_text","prev_button_text","finish_button_text","top_close","cover_included","show_counter","on_finish","step_size","show_one","showing_cover","next_html","tp","prevBtn","unshift","CLS_ON_DRAG","CLS_DRAG_PROXY","matchChildren","eventTarget","children","sortable","listNode","currentNode","currentParent","ClassOnDrag","ClassProxy","targetIndex","previousSibling","renderEntriesListHtml","entries","entry","collapseAble","searchNodeById","Toc","span","createFromHeading","resolveHeading","allHeadings","addResult"],"mappings":"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"}